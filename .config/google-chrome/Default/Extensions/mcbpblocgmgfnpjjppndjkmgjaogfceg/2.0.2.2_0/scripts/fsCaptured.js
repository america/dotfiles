/**
* @license FireShot - Webpage Screenshots and Annotations
* Copyright (C) 2007-2024 Evgeny Vokilsus (contacts@getfireshot.com)
*/

!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},n=(new Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="00fd3e4f-3b12-5703-b025-8eb70d3d9521")}catch(e){}}();
(()=>{function Si(){return new Proxy({},{get:(e,t)=>(...i)=>{let o=null;return typeof i[i.length-1]=="function"&&(o=i.pop()),new Promise(s=>{chrome.runtime.sendMessage({message:"callExtensionMethodMsg",method:t,params:i,async:o!==null},c=>{chrome.runtime.lastError,o&&typeof c<"u"&&o(c),s(c)})})}})}function re(e,t){return bt.getOption(e,t)}function we(e,t){bt.setOption(e,t+"")}var bt={storage:{},onChanged:{listeners:[],addListener(e){this.listeners.indexOf(e)===-1&&this.listeners.push(e)},removeListener(e){this.listeners=this.listeners.filter(t=>t!==e)},notifyListeners(e){this.listeners.forEach(t=>{try{t(e)}catch{}})}},initPromise:null,inited:!1,onInit:null,assignOptions:function(e){this.storage={...this.storage,...e},chrome.storage.local.set(e)},ensureLoaded:function(){return this.initPromise=this.initPromise||new Promise(e=>{chrome.storage.onChanged.addListener((i,o)=>{if(o==="local"){let s=Object.keys(i);for(let c of s)this.storage[c]=i[c].newValue;this.inited&&this.onChanged.notifyListeners(i)}});let t=i=>{this.inited=!0,i&&(this.storage=i),this.onInit?this.onInit().then(()=>this.onInit=null).finally(e):e()};chrome.storage.local.get(null,i=>{chrome.runtime.lastError&&console.error(chrome.runtime.lastError),i?t(i):(console.log("chrome.storage.local.get failed to obtain preferences"),setTimeout(()=>chrome.storage.local.get(null,s=>{!s&&console.log("chrome.storage.local.get failed to obtain preferences for the second time"),t(s)}),500))})}),this.initPromise},setOption:function(e,t){if(!this.inited)console.error(`Preferences were not initialized yet! (setOption(${e}))`);else{var i={};i[e]=t,chrome.storage.local.set(i),this.storage[e]=t}},getOption:function(e,t){if(!this.inited)console.error(`Preferences were not initialized yet! (getOption(${e}))`);else return typeof this.storage[e]>"u"?t:this.storage[e]}};var H={k:0,f:1,q:2,J:3,X:4,Q:5,Z:7,ve:8,t:10,ee:11,S:12,be:13,_e:100,we:101,P:0,C:1,A:2,te:3,p:4,D:268435456,R:8192,O:"lastAction",F:"lastMode",ne:"enableAPI",M:"fsDebug",re:"errorReporting",ie:"notifyOnUpdates",Ee:!1,oe:"disableWASMWorker",Se:"allTabsCaptureOnlyVisiblePart",e:"pluginProMode",I:"registeredMode",Ie:"curVersion",Te:"curVersion1",o:"filenameTemplate",i:"filenameNumber",m:"filenameNumberPadCheck",g:"filenameNumberPadValue",v:"filenameMaxLen",se:"contextMenuIntegration",xe:"pageScrollSpeedValue",ke:"allowInfiniteScrolling",Pe:"sendUsageDataToGA",ae:"newTabIsNextToSource",Ce:"screenshotDelay",ce:"defaultFolderLite",ue:"FireShot",le:"openFolderAfterSavingLite",fe:"noFilenamePrompt",N:"closeTabAfterSavingLite",Ae:"batchModePrefs",De:"historyRetainPeriod",Re:"notifyOnUpdates",de:"nativeFetchErrorCntr-",Oe:"uCheck",Fe:"uEmit",Me:"https://ssl.getfireshot.com/images/api/utm.gif?dummy:",L:"canBeCapturedBetterNextShow",B:"errorFilter",he:"https://ssl.getfireshot.com/sentry-filter-%VERSION%.csv",j:"onlyLite",Ne:"nativeInstall",b:"userLikedFireShot",U:"userRatedFireShot",T:"resultPageShown",Le:"WASMErrorReported",K:"nextAdShownTime",$e:"firstSaveDuringSession",_:"guid",Be:1296e6,je:2592e5,Ue:432e5,Ke:1e4,pe:"png",me:"queuedBadgeURL.1",He:"showSelectionHint.1",We:"advancedFeaturesAvailable",ze:"showAdvertising",H:"betaPreviewWarningExpanded",W:"betaPreviewCompactMode",z:"PDFOptionsEverDisplayed",V:"regUser",c:"regKey",Ve:"taskProgressValue",Ge:"https://ssl.getfireshot.com/images/api/chromefeatures.gif?dummy:",G:"FireShot Capture %n - %t - %e",Ye:"https://getfireshot.com/downloads/%VERSION%/fireshot-chrome-plugin.exe",ge:"https://screenshot-program.com/fireshot/crash_report.php",E:"captureState",u:"nativeHostReady",ye:"resumeMenuEnabled",Y:0,qe:1,Je:2,Xe:4,Qe:8,Ze:16};var ds=function(e){let t=Object.prototype.toString;function i(n){switch(t.call(n)){case"[object Error]":case"[object Exception]":case"[object DOMException]":return!0;default:return S(n,Error)}}function o(n,r){return t.call(n)===`[object ${r}]`}function s(n){return o(n,"ErrorEvent")}function c(n){return o(n,"DOMError")}function l(n){return o(n,"DOMException")}function h(n){return o(n,"String")}function p(n){return typeof n=="object"&&n!==null&&"__sentry_template_string__"in n&&"__sentry_template_values__"in n}function m(n){return n===null||p(n)||typeof n!="object"&&typeof n!="function"}function v(n){return o(n,"Object")}function y(n){return typeof Event<"u"&&S(n,Event)}function E(n){return typeof Element<"u"&&S(n,Element)}function A(n){return o(n,"RegExp")}function _(n){return!!(n&&n.then&&typeof n.then=="function")}function w(n){return v(n)&&"nativeEvent"in n&&"preventDefault"in n&&"stopPropagation"in n}function S(n,r){try{return n instanceof r}catch{return!1}}function I(n){return!!(typeof n=="object"&&n!==null&&(n.__isVue||n._isVue))}function T(n,r=0){return typeof n!="string"||r===0||n.length<=r?n:`${n.slice(0,r)}...`}function P(n,r){if(!Array.isArray(n))return"";let a=[];for(let u=0;u<n.length;u++){let f=n[u];try{I(f)?a.push("[VueViewModel]"):a.push(String(f))}catch{a.push("[value cannot be serialized]")}}return a.join(r)}function C(n,r,a=!1){return h(n)?A(r)?r.test(n):h(r)?a?n===r:n.includes(r):!1:!1}function k(n,r=[],a=!1){return r.some(u=>C(n,u,a))}function D(n,r,a=250,u,f,d,g){if(!d.exception||!d.exception.values||!g||!S(g.originalException,Error))return;let b=d.exception.values.length>0?d.exception.values[d.exception.values.length-1]:void 0;b&&(d.exception.values=L(M(n,r,f,g.originalException,u,d.exception.values,b,0),a))}function M(n,r,a,u,f,d,g,b){if(d.length>=a+1)return d;let x=[...d];if(S(u[f],Error)){N(g,b);let R=n(r,u[f]),W=x.length;z(R,f,W,b),x=M(n,r,a,u[f],f,[R,...x],R,W)}return Array.isArray(u.errors)&&u.errors.forEach((R,W)=>{if(S(R,Error)){N(g,b);let U=n(r,R),ae=x.length;z(U,`errors[${W}]`,ae,b),x=M(n,r,a,R,f,[U,...x],U,ae)}}),x}function N(n,r){n.mechanism=n.mechanism||{type:"generic",handled:!0},n.mechanism={...n.mechanism,...n.type==="AggregateError"&&{is_exception_group:!0},exception_id:r}}function z(n,r,a,u){n.mechanism=n.mechanism||{type:"generic",handled:!0},n.mechanism={...n.mechanism,type:"chained",source:r,exception_id:a,parent_id:u}}function L(n,r){return n.map(a=>(a.value&&(a.value=T(a.value,r)),a))}let V="8.18.0",B=globalThis;function Q(n,r,a){let u=a||B,f=u.__SENTRY__=u.__SENTRY__||{},d=f[V]=f[V]||{};return d[n]||(d[n]=r())}let ie=B,J=80;function he(n,r={}){if(!n)return"<unknown>";try{let a=n,u=5,f=[],d=0,g=0,b=" > ",x=b.length,R,W=Array.isArray(r)?r:r.keyAttrs,U=!Array.isArray(r)&&r.maxStringLength||J;for(;a&&d++<u&&(R=ke(a,W),!(R==="html"||d>1&&g+f.length*x+R.length>=U));)f.push(R),g+=R.length,a=a.parentNode;return f.reverse().join(b)}catch{return"<unknown>"}}function ke(n,r){let a=n,u=[];if(!a||!a.tagName)return"";if(ie.HTMLElement&&a instanceof HTMLElement&&a.dataset){if(a.dataset.sentryComponent)return a.dataset.sentryComponent;if(a.dataset.sentryElement)return a.dataset.sentryElement}u.push(a.tagName.toLowerCase());let f=r&&r.length?r.filter(g=>a.getAttribute(g)).map(g=>[g,a.getAttribute(g)]):null;if(f&&f.length)f.forEach(g=>{u.push(`[${g[0]}="${g[1]}"]`)});else{a.id&&u.push(`#${a.id}`);let g=a.className;if(g&&h(g)){let b=g.split(/\s+/);for(let x of b)u.push(`.${x}`)}}let d=["aria-label","type","name","title","alt"];for(let g of d){let b=a.getAttribute(g);b&&u.push(`[${g}="${b}"]`)}return u.join("")}function je(){try{return ie.document.location.href}catch{return""}}function Oe(n){if(!ie.HTMLElement)return null;let r=n,a=5;for(let u=0;u<a;u++){if(!r)return null;if(r instanceof HTMLElement){if(r.dataset.sentryComponent)return r.dataset.sentryComponent;if(r.dataset.sentryElement)return r.dataset.sentryElement}r=r.parentNode}return null}let be="Sentry Logger ",Ue=["debug","info","warn","error","log","assert","trace"],O={};function G(n){if(!("console"in B))return n();let r=B.console,a={},u=Object.keys(O);u.forEach(f=>{let d=O[f];a[f]=r[f],r[f]=d});try{return n()}finally{u.forEach(f=>{r[f]=a[f]})}}function ee(){let n=!1,r={enable:()=>{n=!0},disable:()=>{n=!1},isEnabled:()=>n};return Ue.forEach(a=>{r[a]=(...u)=>{n&&G(()=>{B.console[a](`${be}[${a}]:`,...u)})}}),r}let F=ee(),K=/^(?:(\w+):)\/\/(?:(\w+)(?::(\w+)?)?@)([\w.-]+)(?::(\d+))?\/(.+)/;function q(n){return n==="http"||n==="https"}function Y(n,r=!1){let{host:a,path:u,pass:f,port:d,projectId:g,protocol:b,publicKey:x}=n;return`${b}://${x}${r&&f?`:${f}`:""}@${a}${d?`:${d}`:""}/${u&&`${u}/`}${g}`}function le(n){let r=K.exec(n);if(!r){G(()=>{console.error(`Invalid Sentry Dsn: ${n}`)});return}let[a,u,f="",d="",g="",b=""]=r.slice(1),x="",R=b,W=R.split("/");if(W.length>1&&(x=W.slice(0,-1).join("/"),R=W.pop()),R){let U=R.match(/^\d+/);U&&(R=U[0])}return Ee({host:d,pass:f,path:x,projectId:R,port:g,protocol:a,publicKey:u})}function Ee(n){return{protocol:n.protocol,publicKey:n.publicKey||"",pass:n.pass||"",host:n.host,port:n.port||"",path:n.path||"",projectId:n.projectId}}function me(n){let{port:r,projectId:a,protocol:u}=n;return["protocol","publicKey","host","projectId"].find(g=>n[g]?!1:(F.error(`Invalid Sentry Dsn: ${g} missing`),!0))?!1:a.match(/^\d+$/)?q(u)?r&&isNaN(parseInt(r,10))?(F.error(`Invalid Sentry Dsn: Invalid port ${r}`),!1):!0:(F.error(`Invalid Sentry Dsn: Invalid protocol ${u}`),!1):(F.error(`Invalid Sentry Dsn: Invalid projectId ${a}`),!1)}function Ze(n){let r=typeof n=="string"?le(n):Ee(n);if(!(!r||!me(r)))return r}class Se extends Error{constructor(r,a="warn"){super(r),this.message=r,this.name=new.target.prototype.constructor.name,Object.setPrototypeOf(this,new.target.prototype),this.logLevel=a}}function ye(n,r,a){if(!(r in n))return;let u=n[r],f=a(u);typeof f=="function"&&qt(f,u),n[r]=f}function We(n,r,a){try{Object.defineProperty(n,r,{value:a,writable:!0,configurable:!0})}catch{F.log(`Failed to add non-enumerable property "${r}" to object`,n)}}function qt(n,r){try{let a=r.prototype||{};n.prototype=r.prototype=a,We(n,"__sentry_original__",r)}catch{}}function _n(n){return n.__sentry_original__}function Ne(n){return Object.keys(n).map(r=>`${encodeURIComponent(r)}=${encodeURIComponent(n[r])}`).join("&")}function Dt(n){if(i(n))return{message:n.message,name:n.name,stack:n.stack,...Rt(n)};if(y(n)){let r={type:n.type,target:Zn(n.target),currentTarget:Zn(n.currentTarget),...Rt(n)};return typeof CustomEvent<"u"&&S(n,CustomEvent)&&(r.detail=n.detail),r}else return n}function Zn(n){try{return E(n)?he(n):Object.prototype.toString.call(n)}catch{return"<unknown>"}}function Rt(n){if(typeof n=="object"&&n!==null){let r={};for(let a in n)Object.prototype.hasOwnProperty.call(n,a)&&(r[a]=n[a]);return r}else return{}}function ot(n,r=40){let a=Object.keys(Dt(n));a.sort();let u=a[0];if(!u)return"[object has no keys]";if(u.length>=r)return T(u,r);for(let f=a.length;f>0;f--){let d=a.slice(0,f).join(", ");if(!(d.length>r))return f===a.length?d:T(d,r)}return""}function Le(n){return at(n,new Map)}function at(n,r){if(Xt(n)){let a=r.get(n);if(a!==void 0)return a;let u={};r.set(n,u);for(let f of Object.keys(n))typeof n[f]<"u"&&(u[f]=at(n[f],r));return u}if(Array.isArray(n)){let a=r.get(n);if(a!==void 0)return a;let u=[];return r.set(n,u),n.forEach(f=>{u.push(at(f,r))}),u}return n}function Xt(n){if(!v(n))return!1;try{let r=Object.getPrototypeOf(n).constructor.name;return!r||r==="Object"}catch{return!0}}let er=50,et="?",Do=/\(error: (.*)\)/,Ro=/captureMessage|captureException/;function Oo(...n){let r=n.sort((a,u)=>a[0]-u[0]).map(a=>a[1]);return(a,u=0,f=0)=>{let d=[],g=a.split(`
`);for(let b=u;b<g.length;b++){let x=g[b];if(x.length>1024)continue;let R=Do.test(x)?x.replace(Do,"$1"):x;if(!R.match(/\S*Error: /)){for(let W of r){let U=W(R);if(U){d.push(U);break}}if(d.length>=er+f)break}}return Fc(d.slice(f))}}function Oc(n){return Array.isArray(n)?Oo(...n):n}function Fc(n){if(!n.length)return[];let r=Array.from(n);return/sentryWrapped/.test(tr(r).function||"")&&r.pop(),r.reverse(),Ro.test(tr(r).function||"")&&(r.pop(),Ro.test(tr(r).function||"")&&r.pop()),r.slice(0,er).map(a=>({...a,filename:a.filename||tr(r).filename,function:a.function||et}))}function tr(n){return n[n.length-1]||{}}let ti="<anonymous>";function yt(n){try{return!n||typeof n!="function"?ti:n.name||ti}catch{return ti}}function Fo(n){let r=n.exception;if(r){let a=[];try{return r.values.forEach(u=>{u.stacktrace.frames&&a.push(...u.stacktrace.frames)}),a}catch{return}}}let nr={},Mo={};function Ot(n,r){nr[n]=nr[n]||[],nr[n].push(r)}function Ft(n,r){Mo[n]||(r(),Mo[n]=!0)}function Je(n,r){let a=n&&nr[n];if(a)for(let u of a)try{u(r)}catch(f){F.error(`Error while triggering instrumentation handler.
Type: ${n}
Name: ${yt(u)}
Error:`,f)}}function Mc(n){let r="console";Ot(r,n),Ft(r,Nc)}function Nc(){"console"in B&&Ue.forEach(function(n){n in B.console&&ye(B.console,n,function(r){return O[n]=r,function(...a){Je("console",{args:a,level:n});let f=O[n];f&&f.apply(B.console,a)}})})}let ni=B;function No(){if(!("fetch"in ni))return!1;try{return new Headers,new Request("http://www.example.com"),new Response,!0}catch{return!1}}function ri(n){return n&&/^function\s+\w+\(\)\s+\{\s+\[native code\]\s+\}$/.test(n.toString())}function Lc(){if(typeof EdgeRuntime=="string")return!0;if(!No())return!1;if(ri(ni.fetch))return!0;let n=!1,r=ni.document;if(r&&typeof r.createElement=="function")try{let a=r.createElement("iframe");a.hidden=!0,r.head.appendChild(a),a.contentWindow&&a.contentWindow.fetch&&(n=ri(a.contentWindow.fetch)),r.head.removeChild(a)}catch(a){F.warn("Could not create sandbox iframe for pure fetch check, bailing to window.fetch: ",a)}return n}let Lo=1e3;function bn(){return Date.now()/Lo}function $c(){let{performance:n}=B;if(!n||!n.now)return bn;let r=Date.now()-n.now(),a=n.timeOrigin==null?r:n.timeOrigin;return()=>(a+n.now())/Lo}let st=$c();(()=>{let{performance:n}=B;if(!n||!n.now)return;let r=3600*1e3,a=n.now(),u=Date.now(),f=n.timeOrigin?Math.abs(n.timeOrigin+a-u):r,d=f<r,g=n.timing&&n.timing.navigationStart,x=typeof g=="number"?Math.abs(g+a-u):r,R=x<r;return d||R?f<=x?n.timeOrigin:g:u})();function Bc(n){let r="fetch";Ot(r,n),Ft(r,jc)}function jc(){Lc()&&ye(B,"fetch",function(n){return function(...r){let{method:a,url:u}=Uc(r),f={args:r,fetchData:{method:a,url:u},startTimestamp:st()*1e3};Je("fetch",{...f});let d=new Error().stack;return n.apply(B,r).then(g=>{let b={...f,endTimestamp:st()*1e3,response:g};return Je("fetch",b),g},g=>{let b={...f,endTimestamp:st()*1e3,error:g};throw Je("fetch",b),i(g)&&g.stack===void 0&&(g.stack=d,We(g,"framesToPop",1)),g})}})}function ii(n,r){return!!n&&typeof n=="object"&&!!n[r]}function $o(n){return typeof n=="string"?n:n?ii(n,"url")?n.url:n.toString?n.toString():"":""}function Uc(n){if(n.length===0)return{method:"GET",url:""};if(n.length===2){let[a,u]=n;return{url:$o(a),method:ii(u,"method")?String(u.method).toUpperCase():"GET"}}let r=n[0];return{url:$o(r),method:ii(r,"method")?String(r.method).toUpperCase():"GET"}}let rr=null;function Kc(n){let r="error";Ot(r,n),Ft(r,Hc)}function Hc(){rr=B.onerror,B.onerror=function(n,r,a,u,f){return Je("error",{column:u,error:f,line:a,msg:n,url:r}),rr&&!rr.__SENTRY_LOADER__?rr.apply(this,arguments):!1},B.onerror.__SENTRY_INSTRUMENTED__=!0}let ir=null;function Wc(n){let r="unhandledrejection";Ot(r,n),Ft(r,zc)}function zc(){ir=B.onunhandledrejection,B.onunhandledrejection=function(n){return Je("unhandledrejection",n),ir&&!ir.__SENTRY_LOADER__?ir.apply(this,arguments):!0},B.onunhandledrejection.__SENTRY_INSTRUMENTED__=!0}function Vc(){return"npm"}function Gc(){let n=typeof WeakSet=="function",r=n?new WeakSet:[];function a(f){if(n)return r.has(f)?!0:(r.add(f),!1);for(let d=0;d<r.length;d++)if(r[d]===f)return!0;return r.push(f),!1}function u(f){if(n)r.delete(f);else for(let d=0;d<r.length;d++)if(r[d]===f){r.splice(d,1);break}}return[a,u]}function Ie(){let n=B,r=n.crypto||n.msCrypto,a=()=>Math.random()*16;try{if(r&&r.randomUUID)return r.randomUUID().replace(/-/g,"");r&&r.getRandomValues&&(a=()=>{let u=new Uint8Array(1);return r.getRandomValues(u),u[0]})}catch{}return("10000000100040008000"+1e11).replace(/[018]/g,u=>(u^(a()&15)>>u/4).toString(16))}function Bo(n){return n.exception&&n.exception.values?n.exception.values[0]:void 0}function vt(n){let{message:r,event_id:a}=n;if(r)return r;let u=Bo(n);return u?u.type&&u.value?`${u.type}: ${u.value}`:u.type||u.value||a||"<unknown>":a||"<unknown>"}function oi(n,r,a){let u=n.exception=n.exception||{},f=u.values=u.values||[],d=f[0]=f[0]||{};d.value||(d.value=r||""),d.type||(d.type=a||"Error")}function wn(n,r){let a=Bo(n);if(!a)return;let u={type:"generic",handled:!0},f=a.mechanism;if(a.mechanism={...u,...f,...r},r&&"data"in r){let d={...f&&f.data,...r.data};a.mechanism.data=d}}function jo(n){if(n&&n.__sentry_captured__)return!0;try{We(n,"__sentry_captured__",!0)}catch{}return!1}function Uo(n){return Array.isArray(n)?n:[n]}function _t(n,r=100,a=1/0){try{return ai("",n,r,a)}catch(u){return{ERROR:`**non-serializable** (${u})`}}}function Ko(n,r=3,a=102400){let u=_t(n,r);return Jc(u)>a?Ko(n,r-1,a):u}function ai(n,r,a=1/0,u=1/0,f=Gc()){let[d,g]=f;if(r==null||["number","boolean","string"].includes(typeof r)&&!Number.isNaN(r))return r;let b=Yc(n,r);if(!b.startsWith("[object "))return b;if(r.__sentry_skip_normalization__)return r;let x=typeof r.__sentry_override_normalization_depth__=="number"?r.__sentry_override_normalization_depth__:a;if(x===0)return b.replace("object ","");if(d(r))return"[Circular ~]";let R=r;if(R&&typeof R.toJSON=="function")try{let ue=R.toJSON();return ai("",ue,x-1,u,f)}catch{}let W=Array.isArray(r)?[]:{},U=0,ae=Dt(r);for(let ue in ae){if(!Object.prototype.hasOwnProperty.call(ae,ue))continue;if(U>=u){W[ue]="[MaxProperties ~]";break}let ce=ae[ue];W[ue]=ai(ue,ce,x-1,u,f),U++}return g(r),W}function Yc(n,r){try{if(n==="domain"&&r&&typeof r=="object"&&r._events)return"[Domain]";if(n==="domainEmitter")return"[DomainEmitter]";if(typeof global<"u"&&r===global)return"[Global]";if(typeof window<"u"&&r===window)return"[Window]";if(typeof document<"u"&&r===document)return"[Document]";if(I(r))return"[VueViewModel]";if(w(r))return"[SyntheticEvent]";if(typeof r=="number"&&r!==r)return"[NaN]";if(typeof r=="function")return`[Function: ${yt(r)}]`;if(typeof r=="symbol")return`[${String(r)}]`;if(typeof r=="bigint")return`[BigInt: ${String(r)}]`;let a=qc(r);return/^HTML(\w*)Element$/.test(a)?`[HTMLElement: ${a}]`:`[object ${a}]`}catch(a){return`**non-serializable** (${a})`}}function qc(n){let r=Object.getPrototypeOf(n);return r?r.constructor.name:"null prototype"}function Xc(n){return~-encodeURI(n).split(/%..|./).length}function Jc(n){return Xc(JSON.stringify(n))}var ct;(function(n){n[n.PENDING=0]="PENDING";let a=1;n[n.RESOLVED=a]="RESOLVED";let u=2;n[n.REJECTED=u]="REJECTED"})(ct||(ct={}));function Mt(n){return new qe(r=>{r(n)})}function or(n){return new qe((r,a)=>{a(n)})}class qe{constructor(r){qe.prototype.__init.call(this),qe.prototype.__init2.call(this),qe.prototype.__init3.call(this),qe.prototype.__init4.call(this),this._state=ct.PENDING,this._handlers=[];try{r(this._resolve,this._reject)}catch(a){this._reject(a)}}then(r,a){return new qe((u,f)=>{this._handlers.push([!1,d=>{if(!r)u(d);else try{u(r(d))}catch(g){f(g)}},d=>{if(!a)f(d);else try{u(a(d))}catch(g){f(g)}}]),this._executeHandlers()})}catch(r){return this.then(a=>a,r)}finally(r){return new qe((a,u)=>{let f,d;return this.then(g=>{d=!1,f=g,r&&r()},g=>{d=!0,f=g,r&&r()}).then(()=>{if(d){u(f);return}a(f)})})}__init(){this._resolve=r=>{this._setResult(ct.RESOLVED,r)}}__init2(){this._reject=r=>{this._setResult(ct.REJECTED,r)}}__init3(){this._setResult=(r,a)=>{if(this._state===ct.PENDING){if(_(a)){a.then(this._resolve,this._reject);return}this._state=r,this._value=a,this._executeHandlers()}}}__init4(){this._executeHandlers=()=>{if(this._state===ct.PENDING)return;let r=this._handlers.slice();this._handlers=[],r.forEach(a=>{a[0]||(this._state===ct.RESOLVED&&a[1](this._value),this._state===ct.REJECTED&&a[2](this._value),a[0]=!0)})}}}function Qc(n){let r=[];function a(){return n===void 0||r.length<n}function u(g){return r.splice(r.indexOf(g),1)[0]||Promise.resolve(void 0)}function f(g){if(!a())return or(new Se("Not adding Promise because buffer limit was reached."));let b=g();return r.indexOf(b)===-1&&r.push(b),b.then(()=>u(b)).then(null,()=>u(b).then(null,()=>{})),b}function d(g){return new qe((b,x)=>{let R=r.length;if(!R)return b(!0);let W=setTimeout(()=>{g&&g>0&&b(!1)},g);r.forEach(U=>{Mt(U).then(()=>{--R||(clearTimeout(W),b(!0))},x)})})}return{$:r,add:f,drain:d}}function si(n){if(!n)return{};let r=n.match(/^(([^:/?#]+):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?$/);if(!r)return{};let a=r[6]||"",u=r[8]||"";return{host:r[4],path:r[5],protocol:r[2],search:a,hash:u,relative:r[5]+a+u}}let Zc=["fatal","error","warning","log","info","debug"];function eu(n){return n==="warn"?"warning":Zc.includes(n)?n:"log"}let Ho="sentry-",tu=/^sentry-/,nu=8192;function Wo(n){let r=iu(n);if(!r)return;let a=Object.entries(r).reduce((u,[f,d])=>{if(f.match(tu)){let g=f.slice(Ho.length);u[g]=d}return u},{});if(Object.keys(a).length>0)return a}function ru(n){if(!n)return;let r=Object.entries(n).reduce((a,[u,f])=>(f&&(a[`${Ho}${u}`]=f),a),{});return ou(r)}function iu(n){if(!(!n||!h(n)&&!Array.isArray(n)))return Array.isArray(n)?n.reduce((r,a)=>{let u=zo(a);return Object.entries(u).forEach(([f,d])=>{r[f]=d}),r},{}):zo(n)}function zo(n){return n.split(",").map(r=>r.split("=").map(a=>decodeURIComponent(a.trim()))).reduce((r,[a,u])=>(a&&u&&(r[a]=u),r),{})}function ou(n){if(Object.keys(n).length!==0)return Object.entries(n).reduce((r,[a,u],f)=>{let d=`${encodeURIComponent(a)}=${encodeURIComponent(u)}`,g=f===0?d:`${r},${d}`;return g.length>nu?(F.warn(`Not adding key: ${a} with val: ${u} to baggage header due to exceeding baggage size limits.`),r):g},"")}let au=new RegExp("^[ \\t]*([0-9a-f]{32})?-?([0-9a-f]{16})?-?([01])?[ \\t]*$");function su(n){if(!n)return;let r=n.match(au);if(!r)return;let a;return r[3]==="1"?a=!0:r[3]==="0"&&(a=!1),{traceId:r[1],parentSampled:a,parentSpanId:r[2]}}function cu(n,r){let a=su(n),u=Wo(r),{traceId:f,parentSpanId:d,parentSampled:g}=a||{};return a?{traceId:f||Ie(),parentSpanId:d||Ie().substring(16),spanId:Ie().substring(16),sampled:g,dsc:u||{}}:{traceId:f||Ie(),spanId:Ie().substring(16)}}function uu(n=Ie(),r=Ie().substring(16),a){let u="";return a!==void 0&&(u=a?"-1":"-0"),`${n}-${r}${u}`}function En(n,r=[]){return[n,r]}function lu(n,r){let[a,u]=n;return[a,[...u,r]]}function Vo(n,r){let a=n[1];for(let u of a){let f=u[0].type;if(r(u,f))return!0}return!1}function ci(n){return B.__SENTRY__&&B.__SENTRY__.encodePolyfill?B.__SENTRY__.encodePolyfill(n):new TextEncoder().encode(n)}function fu(n){let[r,a]=n,u=JSON.stringify(r);function f(d){typeof u=="string"?u=typeof d=="string"?u+d:[ci(u),d]:u.push(typeof d=="string"?ci(d):d)}for(let d of a){let[g,b]=d;if(f(`
${JSON.stringify(g)}
`),typeof b=="string"||b instanceof Uint8Array)f(b);else{let x;try{x=JSON.stringify(b)}catch{x=JSON.stringify(_t(b))}f(x)}}return typeof u=="string"?u:du(u)}function du(n){let r=n.reduce((f,d)=>f+d.length,0),a=new Uint8Array(r),u=0;for(let f of n)a.set(f,u),u+=f.length;return a}function hu(n){let r=typeof n.data=="string"?ci(n.data):n.data;return[Le({type:"attachment",length:r.length,filename:n.filename,content_type:n.contentType,attachment_type:n.attachmentType}),r]}let pu={session:"session",sessions:"session",attachment:"attachment",transaction:"transaction",event:"error",client_report:"internal",user_report:"default",profile:"profile",profile_chunk:"profile",replay_event:"replay",replay_recording:"replay",check_in:"monitor",feedback:"feedback",span:"span",statsd:"metric_bucket"};function Go(n){return pu[n]}function Yo(n){if(!n||!n.sdk)return;let{name:r,version:a}=n.sdk;return{name:r,version:a}}function mu(n,r,a,u){let f=n.sdkProcessingMetadata&&n.sdkProcessingMetadata.dynamicSamplingContext;return{event_id:n.event_id,sent_at:new Date().toISOString(),...r&&{sdk:r},...!!a&&u&&{dsn:Y(u)},...f&&{trace:Le({...f})}}}function gu(n,r,a){let u=[{type:"client_report"},{timestamp:a||bn(),discarded_events:n}];return En(r?{dsn:r}:{},[u])}let yu=60*1e3;function vu(n,r=Date.now()){let a=parseInt(`${n}`,10);if(!isNaN(a))return a*1e3;let u=Date.parse(`${n}`);return isNaN(u)?yu:u-r}function _u(n,r){return n[r]||n.all||0}function bu(n,r,a=Date.now()){return _u(n,r)>a}function wu(n,{statusCode:r,headers:a},u=Date.now()){let f={...n},d=a&&a["x-sentry-rate-limits"],g=a&&a["retry-after"];if(d)for(let b of d.trim().split(",")){let[x,R,,,W]=b.split(":",5),U=parseInt(x,10),ae=(isNaN(U)?60:U)*1e3;if(!R)f.all=u+ae;else for(let ue of R.split(";"))ue==="metric_bucket"?(!W||W.split(";").includes("custom"))&&(f[ue]=u+ae):f[ue]=u+ae}else g?f.all=u+vu(g,u):r===429&&(f.all=u+6e4);return f}function qo(){return{traceId:Ie(),spanId:Ie().substring(16)}}let ar=B;function Eu(){let n=ar.chrome,r=n&&n.app&&n.app.runtime,a="history"in ar&&!!ar.history.pushState&&!!ar.history.replaceState;return!r&&a}let Xo=()=>{},Su=["attachTo","createWidget","remove"];function Jo(n){return G(()=>{console.warn("You are using feedbackIntegration() even though this bundle does not include feedback.")}),{name:"Feedback",...Su.reduce((r,a)=>(r[a]=Xo,r),{})}}let Iu=["start","stop","flush"];function ku(n){return G(()=>{console.warn("You are using replayIntegration() even though this bundle does not include replay.")}),{name:"Replay",...Iu.reduce((r,a)=>(r[a]=Xo,r),{})}}function Sn(){return ui(B),B}function ui(n){let r=n.__SENTRY__=n.__SENTRY__||{};return r.version=r.version||V,r[V]=r[V]||{}}function Tu(n){let r=st(),a={sid:Ie(),init:!0,timestamp:r,started:r,duration:0,status:"ok",errors:0,ignoreDuration:!1,toJSON:()=>Pu(a)};return n&&Jt(a,n),a}function Jt(n,r={}){if(r.user&&(!n.ipAddress&&r.user.ip_address&&(n.ipAddress=r.user.ip_address),!n.did&&!r.did&&(n.did=r.user.id||r.user.email||r.user.username)),n.timestamp=r.timestamp||st(),r.abnormal_mechanism&&(n.abnormal_mechanism=r.abnormal_mechanism),r.ignoreDuration&&(n.ignoreDuration=r.ignoreDuration),r.sid&&(n.sid=r.sid.length===32?r.sid:Ie()),r.init!==void 0&&(n.init=r.init),!n.did&&r.did&&(n.did=`${r.did}`),typeof r.started=="number"&&(n.started=r.started),n.ignoreDuration)n.duration=void 0;else if(typeof r.duration=="number")n.duration=r.duration;else{let a=n.timestamp-n.started;n.duration=a>=0?a:0}r.release&&(n.release=r.release),r.environment&&(n.environment=r.environment),!n.ipAddress&&r.ipAddress&&(n.ipAddress=r.ipAddress),!n.userAgent&&r.userAgent&&(n.userAgent=r.userAgent),typeof r.errors=="number"&&(n.errors=r.errors),r.status&&(n.status=r.status)}function xu(n,r){let a={};r?a={status:r}:n.status==="ok"&&(a={status:"exited"}),Jt(n,a)}function Pu(n){return Le({sid:`${n.sid}`,init:n.init,started:new Date(n.started*1e3).toISOString(),timestamp:new Date(n.timestamp*1e3).toISOString(),status:n.status,errors:n.errors,did:typeof n.did=="number"||typeof n.did=="string"?`${n.did}`:void 0,duration:n.duration,abnormal_mechanism:n.abnormal_mechanism,attrs:{release:n.release,environment:n.environment,ip_address:n.ipAddress,user_agent:n.userAgent}})}let li="_sentrySpan";function Qo(n,r){r?We(n,li,r):delete n[li]}function Zo(n){return n[li]}let Cu=100;class fi{constructor(){this._notifyingListeners=!1,this._scopeListeners=[],this._eventProcessors=[],this._breadcrumbs=[],this._attachments=[],this._user={},this._tags={},this._extra={},this._contexts={},this._sdkProcessingMetadata={},this._propagationContext=qo()}clone(){let r=new fi;return r._breadcrumbs=[...this._breadcrumbs],r._tags={...this._tags},r._extra={...this._extra},r._contexts={...this._contexts},r._user=this._user,r._level=this._level,r._session=this._session,r._transactionName=this._transactionName,r._fingerprint=this._fingerprint,r._eventProcessors=[...this._eventProcessors],r._requestSession=this._requestSession,r._attachments=[...this._attachments],r._sdkProcessingMetadata={...this._sdkProcessingMetadata},r._propagationContext={...this._propagationContext},r._client=this._client,r._lastEventId=this._lastEventId,Qo(r,Zo(this)),r}setClient(r){this._client=r}setLastEventId(r){this._lastEventId=r}getClient(){return this._client}lastEventId(){return this._lastEventId}addScopeListener(r){this._scopeListeners.push(r)}addEventProcessor(r){return this._eventProcessors.push(r),this}setUser(r){return this._user=r||{email:void 0,id:void 0,ip_address:void 0,username:void 0},this._session&&Jt(this._session,{user:r}),this._notifyScopeListeners(),this}getUser(){return this._user}getRequestSession(){return this._requestSession}setRequestSession(r){return this._requestSession=r,this}setTags(r){return this._tags={...this._tags,...r},this._notifyScopeListeners(),this}setTag(r,a){return this._tags={...this._tags,[r]:a},this._notifyScopeListeners(),this}setExtras(r){return this._extra={...this._extra,...r},this._notifyScopeListeners(),this}setExtra(r,a){return this._extra={...this._extra,[r]:a},this._notifyScopeListeners(),this}setFingerprint(r){return this._fingerprint=r,this._notifyScopeListeners(),this}setLevel(r){return this._level=r,this._notifyScopeListeners(),this}setTransactionName(r){return this._transactionName=r,this._notifyScopeListeners(),this}setContext(r,a){return a===null?delete this._contexts[r]:this._contexts[r]=a,this._notifyScopeListeners(),this}setSession(r){return r?this._session=r:delete this._session,this._notifyScopeListeners(),this}getSession(){return this._session}update(r){if(!r)return this;let a=typeof r=="function"?r(this):r,[u,f]=a instanceof ut?[a.getScopeData(),a.getRequestSession()]:v(a)?[r,r.requestSession]:[],{tags:d,extra:g,user:b,contexts:x,level:R,fingerprint:W=[],propagationContext:U}=u||{};return this._tags={...this._tags,...d},this._extra={...this._extra,...g},this._contexts={...this._contexts,...x},b&&Object.keys(b).length&&(this._user=b),R&&(this._level=R),W.length&&(this._fingerprint=W),U&&(this._propagationContext=U),f&&(this._requestSession=f),this}clear(){return this._breadcrumbs=[],this._tags={},this._extra={},this._user={},this._contexts={},this._level=void 0,this._transactionName=void 0,this._fingerprint=void 0,this._requestSession=void 0,this._session=void 0,Qo(this,void 0),this._attachments=[],this._propagationContext=qo(),this._notifyScopeListeners(),this}addBreadcrumb(r,a){let u=typeof a=="number"?a:Cu;if(u<=0)return this;let f={timestamp:bn(),...r},d=this._breadcrumbs;return d.push(f),this._breadcrumbs=d.length>u?d.slice(-u):d,this._notifyScopeListeners(),this}getLastBreadcrumb(){return this._breadcrumbs[this._breadcrumbs.length-1]}clearBreadcrumbs(){return this._breadcrumbs=[],this._notifyScopeListeners(),this}addAttachment(r){return this._attachments.push(r),this}clearAttachments(){return this._attachments=[],this}getScopeData(){return{breadcrumbs:this._breadcrumbs,attachments:this._attachments,contexts:this._contexts,tags:this._tags,extra:this._extra,user:this._user,level:this._level,fingerprint:this._fingerprint||[],eventProcessors:this._eventProcessors,propagationContext:this._propagationContext,sdkProcessingMetadata:this._sdkProcessingMetadata,transactionName:this._transactionName,span:Zo(this)}}setSDKProcessingMetadata(r){return this._sdkProcessingMetadata={...this._sdkProcessingMetadata,...r},this}setPropagationContext(r){return this._propagationContext=r,this}getPropagationContext(){return this._propagationContext}captureException(r,a){let u=a&&a.event_id?a.event_id:Ie();if(!this._client)return F.warn("No client configured on scope - will not capture exception!"),u;let f=new Error("Sentry syntheticException");return this._client.captureException(r,{originalException:r,syntheticException:f,...a,event_id:u},this),u}captureMessage(r,a,u){let f=u&&u.event_id?u.event_id:Ie();if(!this._client)return F.warn("No client configured on scope - will not capture message!"),f;let d=new Error(r);return this._client.captureMessage(r,a,{originalException:r,syntheticException:d,...u,event_id:f},this),f}captureEvent(r,a){let u=a&&a.event_id?a.event_id:Ie();return this._client?(this._client.captureEvent(r,{...a,event_id:u},this),u):(F.warn("No client configured on scope - will not capture event!"),u)}_notifyScopeListeners(){this._notifyingListeners||(this._notifyingListeners=!0,this._scopeListeners.forEach(r=>{r(this)}),this._notifyingListeners=!1)}}let ut=fi;function Au(){return Q("defaultCurrentScope",()=>new ut)}function Du(){return Q("defaultIsolationScope",()=>new ut)}class Ru{constructor(r,a){let u;r?u=r:u=new ut;let f;a?f=a:f=new ut,this._stack=[{scope:u}],this._isolationScope=f}withScope(r){let a=this._pushScope(),u;try{u=r(a)}catch(f){throw this._popScope(),f}return _(u)?u.then(f=>(this._popScope(),f),f=>{throw this._popScope(),f}):(this._popScope(),u)}getClient(){return this.getStackTop().client}getScope(){return this.getStackTop().scope}getIsolationScope(){return this._isolationScope}getStackTop(){return this._stack[this._stack.length-1]}_pushScope(){let r=this.getScope().clone();return this._stack.push({client:this.getClient(),scope:r}),r}_popScope(){return this._stack.length<=1?!1:!!this._stack.pop()}}function Qt(){let n=Sn(),r=ui(n);return r.stack=r.stack||new Ru(Au(),Du())}function Ou(n){return Qt().withScope(n)}function Fu(n,r){let a=Qt();return a.withScope(()=>(a.getStackTop().scope=n,r(n)))}function ea(n){return Qt().withScope(()=>n(Qt().getIsolationScope()))}function Mu(){return{withIsolationScope:ea,withScope:Ou,withSetScope:Fu,withSetIsolationScope:(n,r)=>ea(r),getCurrentScope:()=>Qt().getScope(),getIsolationScope:()=>Qt().getIsolationScope()}}function sr(n){let r=ui(n);return r.acs?r.acs:Mu()}function Fe(){let n=Sn();return sr(n).getCurrentScope()}function $e(){let n=Sn();return sr(n).getIsolationScope()}function ta(){return Q("globalScope",()=>new ut)}function cr(...n){let r=Sn(),a=sr(r);if(n.length===2){let[u,f]=n;return u?a.withSetScope(u,f):a.withScope(f)}return a.withScope(n[0])}function Nu(...n){let r=Sn(),a=sr(r);if(n.length===2){let[u,f]=n;return u?a.withSetIsolationScope(u,f):a.withIsolationScope(f)}return a.withIsolationScope(n[0])}function pe(){return Fe().getClient()}let Lu="_sentryMetrics";function $u(n){let r=n[Lu];if(!r)return;let a={};for(let[,[u,f]]of r)(a[u]||(a[u]=[])).push(Le(f));return a}let na="sentry.source",ra="sentry.sample_rate",ia="sentry.op",oa="sentry.origin",Bu=0,ju=1,Uu=1;function Ku(n){let{spanId:r,traceId:a}=n.spanContext(),{parent_span_id:u}=In(n);return Le({parent_span_id:u,span_id:r,trace_id:a})}function Hu(n){let{traceId:r,spanId:a}=n.spanContext(),u=ca(n);return uu(r,a,u)}function aa(n){return typeof n=="number"?sa(n):Array.isArray(n)?n[0]+n[1]/1e9:n instanceof Date?sa(n.getTime()):st()}function sa(n){return n>9999999999?n/1e3:n}function In(n){if(zu(n))return n.getSpanJSON();try{let{spanId:r,traceId:a}=n.spanContext();if(Wu(n)){let{attributes:u,startTime:f,name:d,endTime:g,parentSpanId:b,status:x}=n;return Le({span_id:r,trace_id:a,data:u,description:d,parent_span_id:b,start_timestamp:aa(f),timestamp:aa(g)||void 0,status:Vu(x),op:u[ia],origin:u[oa],_metrics_summary:$u(n)})}return{span_id:r,trace_id:a}}catch{return{}}}function Wu(n){let r=n;return!!r.attributes&&!!r.startTime&&!!r.name&&!!r.endTime&&!!r.status}function zu(n){return typeof n.getSpanJSON=="function"}function ca(n){let{traceFlags:r}=n.spanContext();return r===Uu}function Vu(n){if(!(!n||n.code===Bu))return n.code===ju?"ok":n.message||"unknown_error"}let Gu="_sentryRootSpan";function ua(n){return n[Gu]||n}let di="production",Yu="_frozenDsc";function la(n,r){let a=r.getOptions(),{publicKey:u}=r.getDsn()||{},f=Le({environment:a.environment||di,release:a.release,public_key:u,trace_id:n});return r.emit("createDsc",f),f}function fa(n){let r=pe();if(!r)return{};let a=la(In(n).trace_id||"",r),u=ua(n),f=u[Yu];if(f)return f;let d=u.spanContext().traceState,g=d&&d.get("sentry.dsc"),b=g&&Wo(g);if(b)return b;let x=In(u),R=x.data||{},W=R[ra];W!=null&&(a.sample_rate=`${W}`);let U=R[na],ae=x.description;return U!=="url"&&ae&&(a.transaction=ae),a.sampled=String(ca(u)),r.emit("createDsc",a,u),a}function qu(n){let r=fa(n);return ru(r)}function Xu(n){if(typeof n=="boolean")return Number(n);let r=typeof n=="string"?parseFloat(n):n;if(typeof r!="number"||isNaN(r)||r<0||r>1){F.warn(`[Tracing] Given sample rate is invalid. Sample rate must be a boolean or a number between 0 and 1. Got ${JSON.stringify(n)} of type ${JSON.stringify(typeof n)}.`);return}return r}function Ju(n,r){return r&&(n.sdk=n.sdk||{},n.sdk.name=n.sdk.name||r.name,n.sdk.version=n.sdk.version||r.version,n.sdk.integrations=[...n.sdk.integrations||[],...r.integrations||[]],n.sdk.packages=[...n.sdk.packages||[],...r.packages||[]]),n}function Qu(n,r,a,u){let f=Yo(a),d={sent_at:new Date().toISOString(),...f&&{sdk:f},...!!u&&r&&{dsn:Y(r)}},g="aggregates"in n?[{type:"sessions"},n]:[{type:"session"},n.toJSON()];return En(d,[g])}function Zu(n,r,a,u){let f=Yo(a),d=n.type&&n.type!=="replay_event"?n.type:"event";Ju(n,a&&a.sdk);let g=mu(n,f,u,r);return delete n.sdkProcessingMetadata,En(g,[[{type:d},n]])}let el=({sentryTrace:n,baggage:r},a)=>cr(u=>{let f=cu(n,r);return u.setPropagationContext(f),a()});function hi(n,r,a,u=0){return new qe((f,d)=>{let g=n[u];if(r===null||typeof g!="function")f(r);else{let b=g({...r},a);g.id&&b===null&&F.log(`Event processor "${g.id}" dropped event`),_(b)?b.then(x=>hi(n,x,a,u+1).then(f)).then(null,d):hi(n,b,a,u+1).then(f).then(null,d)}})}function tl(n,r){let{fingerprint:a,span:u,breadcrumbs:f,sdkProcessingMetadata:d}=r;nl(n,r),u&&ol(n,u),al(n,a),rl(n,f),il(n,d)}function da(n,r){let{extra:a,tags:u,user:f,contexts:d,level:g,sdkProcessingMetadata:b,breadcrumbs:x,fingerprint:R,eventProcessors:W,attachments:U,propagationContext:ae,transactionName:ue,span:ce}=r;kn(n,"extra",a),kn(n,"tags",u),kn(n,"user",f),kn(n,"contexts",d),kn(n,"sdkProcessingMetadata",b),g&&(n.level=g),ue&&(n.transactionName=ue),ce&&(n.span=ce),x.length&&(n.breadcrumbs=[...n.breadcrumbs,...x]),R.length&&(n.fingerprint=[...n.fingerprint,...R]),W.length&&(n.eventProcessors=[...n.eventProcessors,...W]),U.length&&(n.attachments=[...n.attachments,...U]),n.propagationContext={...n.propagationContext,...ae}}function kn(n,r,a){if(a&&Object.keys(a).length){n[r]={...n[r]};for(let u in a)Object.prototype.hasOwnProperty.call(a,u)&&(n[r][u]=a[u])}}function nl(n,r){let{extra:a,tags:u,user:f,contexts:d,level:g,transactionName:b}=r,x=Le(a);x&&Object.keys(x).length&&(n.extra={...x,...n.extra});let R=Le(u);R&&Object.keys(R).length&&(n.tags={...R,...n.tags});let W=Le(f);W&&Object.keys(W).length&&(n.user={...W,...n.user});let U=Le(d);U&&Object.keys(U).length&&(n.contexts={...U,...n.contexts}),g&&(n.level=g),b&&n.type!=="transaction"&&(n.transaction=b)}function rl(n,r){let a=[...n.breadcrumbs||[],...r];n.breadcrumbs=a.length?a:void 0}function il(n,r){n.sdkProcessingMetadata={...n.sdkProcessingMetadata,...r}}function ol(n,r){n.contexts={trace:Ku(r),...n.contexts},n.sdkProcessingMetadata={dynamicSamplingContext:fa(r),...n.sdkProcessingMetadata};let a=ua(r),u=In(a).description;u&&!n.transaction&&n.type==="transaction"&&(n.transaction=u)}function al(n,r){n.fingerprint=n.fingerprint?Uo(n.fingerprint):[],r&&(n.fingerprint=n.fingerprint.concat(r)),n.fingerprint&&!n.fingerprint.length&&delete n.fingerprint}function sl(n,r,a,u,f,d){let{normalizeDepth:g=3,normalizeMaxBreadth:b=1e3}=n,x={...r,event_id:r.event_id||a.event_id||Ie(),timestamp:r.timestamp||bn()},R=a.integrations||n.integrations.map(Be=>Be.name);cl(x,n),fl(x,R),f&&f.emit("applyFrameMetadata",r),r.type===void 0&&ul(x,n.stackParser);let W=hl(u,a.captureContext);a.mechanism&&wn(x,a.mechanism);let U=f?f.getEventProcessors():[],ae=ta().getScopeData();if(d){let Be=d.getScopeData();da(ae,Be)}if(W){let Be=W.getScopeData();da(ae,Be)}let ue=[...a.attachments||[],...ae.attachments];ue.length&&(a.attachments=ue),tl(x,ae);let ce=[...U,...ae.eventProcessors];return hi(ce,x,a).then(Be=>(Be&&ll(Be),typeof g=="number"&&g>0?dl(Be,g,b):Be))}function cl(n,r){let{environment:a,release:u,dist:f,maxValueLength:d=250}=r;"environment"in n||(n.environment="environment"in r?a:di),n.release===void 0&&u!==void 0&&(n.release=u),n.dist===void 0&&f!==void 0&&(n.dist=f),n.message&&(n.message=T(n.message,d));let g=n.exception&&n.exception.values&&n.exception.values[0];g&&g.value&&(g.value=T(g.value,d));let b=n.request;b&&b.url&&(b.url=T(b.url,d))}let ha=new WeakMap;function ul(n,r){let a=B._sentryDebugIds;if(!a)return;let u,f=ha.get(r);f?u=f:(u=new Map,ha.set(r,u));let d=Object.entries(a).reduce((g,[b,x])=>{let R,W=u.get(b);W?R=W:(R=r(b),u.set(b,R));for(let U=R.length-1;U>=0;U--){let ae=R[U];if(ae.filename){g[ae.filename]=x;break}}return g},{});try{n.exception.values.forEach(g=>{g.stacktrace.frames.forEach(b=>{b.filename&&(b.debug_id=d[b.filename])})})}catch{}}function ll(n){let r={};try{n.exception.values.forEach(u=>{u.stacktrace.frames.forEach(f=>{f.debug_id&&(f.abs_path?r[f.abs_path]=f.debug_id:f.filename&&(r[f.filename]=f.debug_id),delete f.debug_id)})})}catch{}if(Object.keys(r).length===0)return;n.debug_meta=n.debug_meta||{},n.debug_meta.images=n.debug_meta.images||[];let a=n.debug_meta.images;Object.entries(r).forEach(([u,f])=>{a.push({type:"sourcemap",code_file:u,debug_id:f})})}function fl(n,r){r.length>0&&(n.sdk=n.sdk||{},n.sdk.integrations=[...n.sdk.integrations||[],...r])}function dl(n,r,a){if(!n)return null;let u={...n,...n.breadcrumbs&&{breadcrumbs:n.breadcrumbs.map(f=>({...f,...f.data&&{data:_t(f.data,r,a)}}))},...n.user&&{user:_t(n.user,r,a)},...n.contexts&&{contexts:_t(n.contexts,r,a)},...n.extra&&{extra:_t(n.extra,r,a)}};return n.contexts&&n.contexts.trace&&u.contexts&&(u.contexts.trace=n.contexts.trace,n.contexts.trace.data&&(u.contexts.trace.data=_t(n.contexts.trace.data,r,a))),n.spans&&(u.spans=n.spans.map(f=>({...f,...f.data&&{data:_t(f.data,r,a)}}))),u}function hl(n,r){if(!r)return n;let a=n?n.clone():new ut;return a.update(r),a}function pl(n){if(n)return ml(n)?{captureContext:n}:yl(n)?{captureContext:n}:n}function ml(n){return n instanceof ut||typeof n=="function"}let gl=["user","level","extra","contexts","tags","fingerprint","requestSession","propagationContext"];function yl(n){return Object.keys(n).some(r=>gl.includes(r))}function pa(n,r){return Fe().captureException(n,pl(r))}function vl(n,r){let a=typeof r=="string"?r:void 0,u=typeof r!="string"?{captureContext:r}:void 0;return Fe().captureMessage(n,a,u)}function ur(n,r){return Fe().captureEvent(n,r)}function ma(n,r){$e().setContext(n,r)}function ga(n){$e().setExtras(n)}function ya(n,r){$e().setExtra(n,r)}function va(n){$e().setTags(n)}function _a(n,r){$e().setTag(n,r)}function ba(n){$e().setUser(n)}function wa(){return $e().lastEventId()}async function _l(n){let r=pe();return r?r.flush(n):(F.warn("Cannot flush events. No client defined."),Promise.resolve(!1))}async function bl(n){let r=pe();return r?r.close(n):(F.warn("Cannot flush events and disable SDK. No client defined."),Promise.resolve(!1))}function wl(){return!!pe()}function El(n){$e().addEventProcessor(n)}function lr(n){let r=pe(),a=$e(),u=Fe(),{release:f,environment:d=di}=r&&r.getOptions()||{},{userAgent:g}=B.navigator||{},b=Tu({release:f,environment:d,user:u.getUser()||a.getUser(),...g&&{userAgent:g},...n}),x=a.getSession();return x&&x.status==="ok"&&Jt(x,{status:"exited"}),Tn(),a.setSession(b),u.setSession(b),b}function Tn(){let n=$e(),r=Fe(),a=r.getSession()||n.getSession();a&&xu(a),Ea(),n.setSession(),r.setSession()}function Ea(){let n=$e(),r=Fe(),a=pe(),u=r.getSession()||n.getSession();u&&a&&a.captureSession(u)}function pi(n=!1){if(n){Tn();return}Ea()}let Sl="7";function Sa(n){let r=n.protocol?`${n.protocol}:`:"",a=n.port?`:${n.port}`:"";return`${r}//${n.host}${a}${n.path?`/${n.path}`:""}/api/`}function Il(n){return`${Sa(n)}${n.projectId}/envelope/`}function kl(n,r){return Ne({sentry_key:n.publicKey,sentry_version:Sl,...r&&{sentry_client:`${r.name}/${r.version}`}})}function Tl(n,r,a){return r||`${Il(n)}?${kl(n,a)}`}function xl(n,r){let a=Ze(n);if(!a)return"";let u=`${Sa(a)}embed/error-page/`,f=`dsn=${Y(a)}`;for(let d in r)if(d!=="dsn"&&d!=="onClose")if(d==="user"){let g=r.user;if(!g)continue;g.name&&(f+=`&name=${encodeURIComponent(g.name)}`),g.email&&(f+=`&email=${encodeURIComponent(g.email)}`)}else f+=`&${encodeURIComponent(d)}=${encodeURIComponent(r[d])}`;return`${u}?${f}`}let Ia=[];function Pl(n){let r={};return n.forEach(a=>{let{name:u}=a,f=r[u];f&&!f.isDefaultInstance&&a.isDefaultInstance||(r[u]=a)}),Object.values(r)}function Cl(n){let r=n.defaultIntegrations||[],a=n.integrations;r.forEach(g=>{g.isDefaultInstance=!0});let u;Array.isArray(a)?u=[...r,...a]:typeof a=="function"?u=Uo(a(r)):u=r;let f=Pl(u),d=f.findIndex(g=>g.name==="Debug");if(d>-1){let[g]=f.splice(d,1);f.push(g)}return f}function Al(n,r){let a={};return r.forEach(u=>{u&&Ta(n,u,a)}),a}function ka(n,r){for(let a of r)a&&a.afterAllSetup&&a.afterAllSetup(n)}function Ta(n,r,a){if(a[r.name]){F.log(`Integration skipped because it was already installed: ${r.name}`);return}if(a[r.name]=r,Ia.indexOf(r.name)===-1&&typeof r.setupOnce=="function"&&(r.setupOnce(),Ia.push(r.name)),r.setup&&typeof r.setup=="function"&&r.setup(n),typeof r.preprocessEvent=="function"){let u=r.preprocessEvent.bind(r);n.on("preprocessEvent",(f,d)=>u(f,d,n))}if(typeof r.processEvent=="function"){let u=r.processEvent.bind(r),f=Object.assign((d,g)=>u(d,g,n),{id:r.name});n.addEventProcessor(f)}F.log(`Integration installed: ${r.name}`)}function Dl(n){let r=pe();if(!r){F.warn(`Cannot add integration "${n.name}" because no SDK Client is available.`);return}r.addIntegration(n)}function bp(n){return n}let xa="Not capturing exception because it's already been captured.";class Rl{constructor(r){if(this._options=r,this._integrations={},this._numProcessing=0,this._outcomes={},this._hooks={},this._eventProcessors=[],r.dsn?this._dsn=Ze(r.dsn):F.warn("No DSN provided, client will not send events."),this._dsn){let a=Tl(this._dsn,r.tunnel,r._metadata?r._metadata.sdk:void 0);this._transport=r.transport({tunnel:this._options.tunnel,recordDroppedEvent:this.recordDroppedEvent.bind(this),...r.transportOptions,url:a})}}captureException(r,a,u){let f=Ie();if(jo(r))return F.log(xa),f;let d={event_id:f,...a};return this._process(this.eventFromException(r,d).then(g=>this._captureEvent(g,d,u))),d.event_id}captureMessage(r,a,u,f){let d={event_id:Ie(),...u},g=p(r)?r:String(r),b=m(r)?this.eventFromMessage(g,a,d):this.eventFromException(r,d);return this._process(b.then(x=>this._captureEvent(x,d,f))),d.event_id}captureEvent(r,a,u){let f=Ie();if(a&&a.originalException&&jo(a.originalException))return F.log(xa),f;let d={event_id:f,...a},b=(r.sdkProcessingMetadata||{}).capturedSpanScope;return this._process(this._captureEvent(r,d,b||u)),d.event_id}captureSession(r){typeof r.release!="string"?F.warn("Discarded session because of missing or non-string release"):(this.sendSession(r),Jt(r,{init:!1}))}getDsn(){return this._dsn}getOptions(){return this._options}getSdkMetadata(){return this._options._metadata}getTransport(){return this._transport}flush(r){let a=this._transport;return a?(this.emit("flush"),this._isClientDoneProcessing(r).then(u=>a.flush(r).then(f=>u&&f))):Mt(!0)}close(r){return this.flush(r).then(a=>(this.getOptions().enabled=!1,this.emit("close"),a))}getEventProcessors(){return this._eventProcessors}addEventProcessor(r){this._eventProcessors.push(r)}init(){this._isEnabled()&&this._setupIntegrations()}getIntegrationByName(r){return this._integrations[r]}addIntegration(r){let a=this._integrations[r.name];Ta(this,r,this._integrations),a||ka(this,[r])}sendEvent(r,a={}){this.emit("beforeSendEvent",r,a);let u=Zu(r,this._dsn,this._options._metadata,this._options.tunnel);for(let d of a.attachments||[])u=lu(u,hu(d));let f=this.sendEnvelope(u);f&&f.then(d=>this.emit("afterSendEvent",r,d),null)}sendSession(r){let a=Qu(r,this._dsn,this._options._metadata,this._options.tunnel);this.sendEnvelope(a)}recordDroppedEvent(r,a,u){if(this._options.sendClientReports){let f=`${r}:${a}`;F.log(`Adding outcome: "${f}"`),this._outcomes[f]=(this._outcomes[f]||0)+1}}on(r,a){let u=this._hooks[r]=this._hooks[r]||[];return u.push(a),()=>{let f=u.indexOf(a);f>-1&&u.splice(f,1)}}emit(r,...a){let u=this._hooks[r];u&&u.forEach(f=>f(...a))}sendEnvelope(r){return this.emit("beforeEnvelope",r),this._isEnabled()&&this._transport?this._transport.send(r).then(null,a=>(F.error("Error while sending event:",a),a)):(F.error("Transport disabled"),Mt({}))}_setupIntegrations(){let{integrations:r}=this._options;this._integrations=Al(this,r),ka(this,r)}_updateSessionFromEvent(r,a){let u=!1,f=!1,d=a.exception&&a.exception.values;if(d){f=!0;for(let x of d){let R=x.mechanism;if(R&&R.handled===!1){u=!0;break}}}let g=r.status==="ok";(g&&r.errors===0||g&&u)&&(Jt(r,{...u&&{status:"crashed"},errors:r.errors||Number(f||u)}),this.captureSession(r))}_isClientDoneProcessing(r){return new qe(a=>{let u=0,f=1,d=setInterval(()=>{this._numProcessing==0?(clearInterval(d),a(!0)):(u+=f,r&&u>=r&&(clearInterval(d),a(!1)))},f)})}_isEnabled(){return this.getOptions().enabled!==!1&&this._transport!==void 0}_prepareEvent(r,a,u,f=$e()){let d=this.getOptions(),g=Object.keys(this._integrations);return!a.integrations&&g.length>0&&(a.integrations=g),this.emit("preprocessEvent",r,a),r.type||f.setLastEventId(r.event_id||a.event_id),sl(d,r,a,u,this,f).then(b=>{if(b===null)return b;let x={...f.getPropagationContext(),...u?u.getPropagationContext():void 0};if(!(b.contexts&&b.contexts.trace)&&x){let{traceId:W,spanId:U,parentSpanId:ae,dsc:ue}=x;b.contexts={trace:Le({trace_id:W,span_id:U,parent_span_id:ae}),...b.contexts};let ce=ue||la(W,this);b.sdkProcessingMetadata={dynamicSamplingContext:ce,...b.sdkProcessingMetadata}}return b})}_captureEvent(r,a={},u){return this._processEvent(r,a,u).then(f=>f.event_id,f=>{{let d=f;d.logLevel==="log"?F.log(d.message):F.warn(d)}})}_processEvent(r,a,u){let f=this.getOptions(),{sampleRate:d}=f,g=mi(r),b=Pa(r),x=r.type||"error",R=`before send for type \`${x}\``,W=typeof d>"u"?void 0:Xu(d);if(b&&typeof W=="number"&&Math.random()>W)return this.recordDroppedEvent("sample_rate","error",r),or(new Se(`Discarding event because it's not included in the random sample (sampling rate = ${d})`,"log"));let U=x==="replay_event"?"replay":x,ue=(r.sdkProcessingMetadata||{}).capturedSpanIsolationScope;return this._prepareEvent(r,a,u,ue).then(ce=>{if(ce===null)throw this.recordDroppedEvent("event_processor",U,r),new Se("An event processor returned `null`, will not send event.","log");if(a.data&&a.data.__sentry__===!0)return ce;let Be=Fl(this,f,ce,a);return Ol(Be,R)}).then(ce=>{if(ce===null){if(this.recordDroppedEvent("before_send",U,r),mi(r)){let kd=1+(r.spans||[]).length;this._outcomes.span=(this._outcomes.span||0)+kd}throw new Se(`${R} returned \`null\`, will not send event.`,"log")}let gr=u&&u.getSession();!g&&gr&&this._updateSessionFromEvent(gr,ce);let Be=ce.transaction_info;if(g&&Be&&ce.transaction!==r.transaction){let fs="custom";ce.transaction_info={...Be,source:fs}}return this.sendEvent(ce,a),ce}).then(null,ce=>{throw ce instanceof Se?ce:(this.captureException(ce,{data:{__sentry__:!0},originalException:ce}),new Se(`Event processing pipeline threw an error, original event will not be sent. Details have been sent as a new event.
Reason: ${ce}`))})}_process(r){this._numProcessing++,r.then(a=>(this._numProcessing--,a),a=>(this._numProcessing--,a))}_clearOutcomes(){let r=this._outcomes;return this._outcomes={},Object.entries(r).map(([a,u])=>{let[f,d]=a.split(":");return{reason:f,category:d,quantity:u}})}}function Ol(n,r){let a=`${r} must return \`null\` or a valid event.`;if(_(n))return n.then(u=>{if(!v(u)&&u!==null)throw new Se(a);return u},u=>{throw new Se(`${r} rejected with ${u}`)});if(!v(n)&&n!==null)throw new Se(a);return n}function Fl(n,r,a,u){let{beforeSend:f,beforeSendTransaction:d,beforeSendSpan:g}=r;if(Pa(a)&&f)return f(a,u);if(mi(a)){if(a.spans&&g){let b=[];for(let x of a.spans){let R=g(x);R?b.push(R):n.recordDroppedEvent("before_send","span")}a.spans=b}if(d)return d(a,u)}return a}function Pa(n){return n.type===void 0}function mi(n){return n.type==="transaction"}function Ml(n,r){r.debug===!0&&F.enable(),Fe().update(r.initialScope);let u=new n(r);return Ca(u),u.init(),u}function Ca(n){Fe().setClient(n)}let Nl=64;function Aa(n,r,a=Qc(n.bufferSize||Nl)){let u={},f=g=>a.drain(g);function d(g){let b=[];if(Vo(g,(U,ae)=>{let ue=Go(ae);if(bu(u,ue)){let ce=Da(U,ae);n.recordDroppedEvent("ratelimit_backoff",ue,ce)}else b.push(U)}),b.length===0)return Mt({});let x=En(g[0],b),R=U=>{Vo(x,(ae,ue)=>{let ce=Da(ae,ue);n.recordDroppedEvent(U,Go(ue),ce)})},W=()=>r({body:fu(x)}).then(U=>(U.statusCode!==void 0&&(U.statusCode<200||U.statusCode>=300)&&F.warn(`Sentry responded with status code ${U.statusCode} to sent event.`),u=wu(u,U),U),U=>{throw R("network_error"),U});return a.add(W).then(U=>U,U=>{if(U instanceof Se)return F.error("Skipped sending event because buffer is full."),R("queue_overflow"),Mt({});throw U})}return{send:d,flush:f}}function Da(n,r){if(!(r!=="event"&&r!=="transaction"))return Array.isArray(n)?n[1]:void 0}function Ll(n,...r){let a=new String(String.raw(n,...r));return a.__sentry_template_string__=n.join("\0").replace(/%/g,"%%").replace(/\0/g,"%s"),a.__sentry_template_values__=r,a}function $l(n,r,a=[r],u="npm"){let f=n._metadata||{};f.sdk||(f.sdk={name:`sentry.javascript.${r}`,packages:a.map(d=>({name:`${u}:@sentry/${d}`,version:V})),version:V}),n._metadata=f}let Bl=100;function lt(n,r){let a=pe(),u=$e();if(!a)return;let{beforeBreadcrumb:f=null,maxBreadcrumbs:d=Bl}=a.getOptions();if(d<=0)return;let b={timestamp:bn(),...n},x=f?G(()=>f(b,r)):b;x!==null&&(a.emit&&a.emit("beforeAddBreadcrumb",x,r),u.addBreadcrumb(x,d))}let Ra,jl="FunctionToString",Oa=new WeakMap,Fa=()=>({name:jl,setupOnce(){Ra=Function.prototype.toString;try{Function.prototype.toString=function(...n){let r=_n(this),a=Oa.has(pe())&&r!==void 0?r:this;return Ra.apply(a,n)}}catch{}},setup(n){Oa.set(n,!0)}}),Ul=[/^Script error\.?$/,/^Javascript error: Script error\.? on line 0$/,/^ResizeObserver loop completed with undelivered notifications.$/,/^Cannot redefine property: googletag$/,"undefined is not an object (evaluating 'a.L')",`can't redefine non-configurable property "solana"`,"vv().getRestrictions is not a function. (In 'vv().getRestrictions(1,a)', 'vv().getRestrictions' is undefined)","Can't find variable: _AutofillCallbackHandler"],Kl="InboundFilters",Ma=(n={})=>({name:Kl,processEvent(r,a,u){let f=u.getOptions(),d=Hl(n,f);return Wl(r,d)?null:r}});function Hl(n={},r={}){return{allowUrls:[...n.allowUrls||[],...r.allowUrls||[]],denyUrls:[...n.denyUrls||[],...r.denyUrls||[]],ignoreErrors:[...n.ignoreErrors||[],...r.ignoreErrors||[],...n.disableErrorDefaults?[]:Ul],ignoreTransactions:[...n.ignoreTransactions||[],...r.ignoreTransactions||[]],ignoreInternal:n.ignoreInternal!==void 0?n.ignoreInternal:!0}}function Wl(n,r){return r.ignoreInternal&&Xl(n)?(F.warn(`Event dropped due to being internal Sentry Error.
Event: ${vt(n)}`),!0):zl(n,r.ignoreErrors)?(F.warn(`Event dropped due to being matched by \`ignoreErrors\` option.
Event: ${vt(n)}`),!0):Ql(n)?(F.warn(`Event dropped due to not having an error message, error type or stacktrace.
Event: ${vt(n)}`),!0):Vl(n,r.ignoreTransactions)?(F.warn(`Event dropped due to being matched by \`ignoreTransactions\` option.
Event: ${vt(n)}`),!0):Gl(n,r.denyUrls)?(F.warn(`Event dropped due to being matched by \`denyUrls\` option.
Event: ${vt(n)}.
Url: ${fr(n)}`),!0):Yl(n,r.allowUrls)?!1:(F.warn(`Event dropped due to not being matched by \`allowUrls\` option.
Event: ${vt(n)}.
Url: ${fr(n)}`),!0)}function zl(n,r){return n.type||!r||!r.length?!1:ql(n).some(a=>k(a,r))}function Vl(n,r){if(n.type!=="transaction"||!r||!r.length)return!1;let a=n.transaction;return a?k(a,r):!1}function Gl(n,r){if(!r||!r.length)return!1;let a=fr(n);return a?k(a,r):!1}function Yl(n,r){if(!r||!r.length)return!0;let a=fr(n);return a?k(a,r):!0}function ql(n){let r=[];n.message&&r.push(n.message);let a;try{a=n.exception.values[n.exception.values.length-1]}catch{}return a&&a.value&&(r.push(a.value),a.type&&r.push(`${a.type}: ${a.value}`)),r}function Xl(n){try{return n.exception.values[0].type==="SentryError"}catch{}return!1}function Jl(n=[]){for(let r=n.length-1;r>=0;r--){let a=n[r];if(a&&a.filename!=="<anonymous>"&&a.filename!=="[native code]")return a.filename||null}return null}function fr(n){try{let r;try{r=n.exception.values[0].stacktrace.frames}catch{}return r?Jl(r):null}catch{return F.error(`Cannot extract url for event ${vt(n)}`),null}}function Ql(n){return n.type||!n.exception||!n.exception.values||n.exception.values.length===0?!1:!n.message&&!n.exception.values.some(r=>r.stacktrace||r.type&&r.type!=="Error"||r.value)}let Zl="Dedupe",Na=()=>{let n;return{name:Zl,processEvent(r){if(r.type)return r;try{if(ef(r,n))return F.warn("Event dropped due to being a duplicate of previously captured event."),null}catch{}return n=r}}};function ef(n,r){return r?!!(tf(n,r)||nf(n,r)):!1}function tf(n,r){let a=n.message,u=r.message;return!(!a&&!u||a&&!u||!a&&u||a!==u||!$a(n,r)||!La(n,r))}function nf(n,r){let a=Ba(r),u=Ba(n);return!(!a||!u||a.type!==u.type||a.value!==u.value||!$a(n,r)||!La(n,r))}function La(n,r){let a=Fo(n),u=Fo(r);if(!a&&!u)return!0;if(a&&!u||!a&&u||(a=a,u=u,u.length!==a.length))return!1;for(let f=0;f<u.length;f++){let d=u[f],g=a[f];if(d.filename!==g.filename||d.lineno!==g.lineno||d.colno!==g.colno||d.function!==g.function)return!1}return!0}function $a(n,r){let a=n.fingerprint,u=r.fingerprint;if(!a&&!u)return!0;if(a&&!u||!a&&u)return!1;a=a,u=u;try{return a.join("")===u.join("")}catch{return!1}}function Ba(n){return n.exception&&n.exception.values&&n.exception.values[0]}function rf(){return{bindClient(n){Fe().setClient(n)},withScope:cr,getClient:()=>pe(),getScope:Fe,getIsolationScope:$e,captureException:(n,r)=>Fe().captureException(n,r),captureMessage:(n,r,a)=>Fe().captureMessage(n,r,a),captureEvent:ur,addBreadcrumb:lt,setUser:ba,setTags:va,setTag:_a,setExtra:ya,setExtras:ga,setContext:ma,getIntegration(n){let r=pe();return r&&r.getIntegrationByName(n.id)||null},startSession:lr,endSession:Tn,captureSession(n){if(n)return Tn();af()}}}let of=rf;function af(){let n=Fe(),r=pe(),a=n.getSession();r&&a&&r.captureSession(a)}let sf=n=>(G(()=>{console.warn("You are using browserTracingIntegration() even though this bundle does not include tracing.")}),{name:"BrowserTracing"});function xn(){G(()=>{console.warn("You are using metrics even though this bundle does not include tracing.")})}let cf={increment:xn,distribution:xn,set:xn,gauge:xn,timing:(n,r)=>{if(xn(),typeof r=="function")return r()}},oe=B,gi=0;function ja(){return gi>0}function uf(){gi++,setTimeout(()=>{gi--})}function Zt(n,r={},a){if(typeof n!="function")return n;try{let f=n.__sentry_wrapped__;if(f)return f;if(_n(n))return n}catch{return n}let u=function(){let f=Array.prototype.slice.call(arguments);try{a&&typeof a=="function"&&a.apply(this,arguments);let d=f.map(g=>Zt(g,r));return n.apply(this,d)}catch(d){throw uf(),cr(g=>{g.addEventProcessor(b=>(r.mechanism&&(oi(b,void 0,void 0),wn(b,r.mechanism)),b.extra={...b.extra,arguments:f},b)),pa(d)}),d}};try{for(let f in n)Object.prototype.hasOwnProperty.call(n,f)&&(u[f]=n[f])}catch{}qt(u,n),We(n,"__sentry_wrapped__",u);try{Object.getOwnPropertyDescriptor(u,"name").configurable&&Object.defineProperty(u,"name",{get(){return n.name}})}catch{}return u}function dr(n,r){let a=vi(n,r),u={type:r&&r.name,value:pf(r)};return a.length&&(u.stacktrace={frames:a}),u.type===void 0&&u.value===""&&(u.value="Unrecoverable error caught"),u}function lf(n,r,a,u){let f=pe(),d=f&&f.getOptions().normalizeDepth,g=yf(r),b={__serialized__:Ko(r,d)};if(g)return{exception:{values:[dr(n,g)]},extra:b};let x={exception:{values:[{type:y(r)?r.constructor.name:u?"UnhandledRejection":"Error",value:mf(r,{isUnhandledRejection:u})}]},extra:b};if(a){let R=vi(n,a);R.length&&(x.exception.values[0].stacktrace={frames:R})}return x}function yi(n,r){return{exception:{values:[dr(n,r)]}}}function vi(n,r){let a=r.stacktrace||r.stack||"",u=df(r),f=hf(r);try{return n(a,u,f)}catch{}return[]}let ff=/Minified React error #\d+;/i;function df(n){return n&&ff.test(n.message)?1:0}function hf(n){return typeof n.framesToPop=="number"?n.framesToPop:0}function pf(n){let r=n&&n.message;return r?r.error&&typeof r.error.message=="string"?r.error.message:r:"No error message"}function Ua(n,r,a,u){let f=a&&a.syntheticException||void 0,d=_i(n,r,f,u);return wn(d),d.level="error",a&&a.event_id&&(d.event_id=a.event_id),Mt(d)}function Ka(n,r,a="info",u,f){let d=u&&u.syntheticException||void 0,g=bi(n,r,d,f);return g.level=a,u&&u.event_id&&(g.event_id=u.event_id),Mt(g)}function _i(n,r,a,u,f){let d;if(s(r)&&r.error)return yi(n,r.error);if(c(r)||l(r)){let g=r;if("stack"in r)d=yi(n,r);else{let b=g.name||(c(g)?"DOMError":"DOMException"),x=g.message?`${b}: ${g.message}`:b;d=bi(n,x,a,u),oi(d,x)}return"code"in g&&(d.tags={...d.tags,"DOMException.code":`${g.code}`}),d}return i(r)?yi(n,r):v(r)||y(r)?(d=lf(n,r,a,f),wn(d,{synthetic:!0}),d):(d=bi(n,r,a,u),oi(d,`${r}`,void 0),wn(d,{synthetic:!0}),d)}function bi(n,r,a,u){let f={};if(u&&a){let d=vi(n,a);d.length&&(f.exception={values:[{value:r,stacktrace:{frames:d}}]})}if(p(r)){let{__sentry_template_string__:d,__sentry_template_values__:g}=r;return f.logentry={message:d,params:g},f}return f.message=r,f}function mf(n,{isUnhandledRejection:r}){let a=ot(n),u=r?"promise rejection":"exception";return s(n)?`Event \`ErrorEvent\` captured as ${u} with message \`${n.message}\``:y(n)?`Event \`${gf(n)}\` (type=${n.type}) captured as ${u}`:`Object captured as ${u} with keys: ${a}`}function gf(n){try{let r=Object.getPrototypeOf(n);return r?r.constructor.name:void 0}catch{}}function yf(n){for(let r in n)if(Object.prototype.hasOwnProperty.call(n,r)){let a=n[r];if(a instanceof Error)return a}}function Ha(n,{metadata:r,tunnel:a,dsn:u}){let f={event_id:n.event_id,sent_at:new Date().toISOString(),...r&&r.sdk&&{sdk:{name:r.sdk.name,version:r.sdk.version}},...!!a&&!!u&&{dsn:Y(u)}},d=vf(n);return En(f,[d])}function vf(n){return[{type:"user_report"},n]}class Wa extends Rl{constructor(r){let a={parentSpanIsAlwaysRootSpan:!0,...r},u=oe.SENTRY_SDK_SOURCE||Vc();$l(a,"browser",["browser"],u),super(a),a.sendClientReports&&oe.document&&oe.document.addEventListener("visibilitychange",()=>{oe.document.visibilityState==="hidden"&&this._flushOutcomes()})}eventFromException(r,a){return Ua(this._options.stackParser,r,a,this._options.attachStacktrace)}eventFromMessage(r,a="info",u){return Ka(this._options.stackParser,r,a,u,this._options.attachStacktrace)}captureUserFeedback(r){if(!this._isEnabled()){F.warn("SDK not enabled, will not capture user feedback.");return}let a=Ha(r,{metadata:this.getSdkMetadata(),dsn:this.getDsn(),tunnel:this.getOptions().tunnel});this.sendEnvelope(a)}_prepareEvent(r,a,u){return r.platform=r.platform||"javascript",super._prepareEvent(r,a,u)}_flushOutcomes(){let r=this._clearOutcomes();if(r.length===0){F.log("No outcomes to send");return}if(!this._dsn){F.log("No dsn provided, will not send outcomes");return}F.log("Sending outcomes:",r);let a=gu(r,this._options.tunnel&&Y(this._dsn));this.sendEnvelope(a)}}let Me=B,_f=1e3,za,wi,Ei;function bf(n){let r="dom";Ot(r,n),Ft(r,wf)}function wf(){if(!Me.document)return;let n=Je.bind(null,"dom"),r=Va(n,!0);Me.document.addEventListener("click",r,!1),Me.document.addEventListener("keypress",r,!1),["EventTarget","Node"].forEach(a=>{let u=Me[a]&&Me[a].prototype;!u||!u.hasOwnProperty||!u.hasOwnProperty("addEventListener")||(ye(u,"addEventListener",function(f){return function(d,g,b){if(d==="click"||d=="keypress")try{let x=this,R=x.__sentry_instrumentation_handlers__=x.__sentry_instrumentation_handlers__||{},W=R[d]=R[d]||{refCount:0};if(!W.handler){let U=Va(n);W.handler=U,f.call(this,d,U,b)}W.refCount++}catch{}return f.call(this,d,g,b)}}),ye(u,"removeEventListener",function(f){return function(d,g,b){if(d==="click"||d=="keypress")try{let x=this,R=x.__sentry_instrumentation_handlers__||{},W=R[d];W&&(W.refCount--,W.refCount<=0&&(f.call(this,d,W.handler,b),W.handler=void 0,delete R[d]),Object.keys(R).length===0&&delete x.__sentry_instrumentation_handlers__)}catch{}return f.call(this,d,g,b)}}))})}function Ef(n){if(n.type!==wi)return!1;try{if(!n.target||n.target._sentryId!==Ei)return!1}catch{}return!0}function Sf(n,r){return n!=="keypress"?!1:!r||!r.tagName?!0:!(r.tagName==="INPUT"||r.tagName==="TEXTAREA"||r.isContentEditable)}function Va(n,r=!1){return a=>{if(!a||a._sentryCaptured)return;let u=If(a);if(Sf(a.type,u))return;We(a,"_sentryCaptured",!0),u&&!u._sentryId&&We(u,"_sentryId",Ie());let f=a.type==="keypress"?"input":a.type;Ef(a)||(n({event:a,name:f,global:r}),wi=a.type,Ei=u?u._sentryId:void 0),clearTimeout(za),za=Me.setTimeout(()=>{Ei=void 0,wi=void 0},_f)}}function If(n){try{return n.target}catch{return null}}let hr;function Ga(n){let r="history";Ot(r,n),Ft(r,kf)}function kf(){if(!Eu())return;let n=Me.onpopstate;Me.onpopstate=function(...a){let u=Me.location.href,f=hr;if(hr=u,Je("history",{from:f,to:u}),n)try{return n.apply(this,a)}catch{}};function r(a){return function(...u){let f=u.length>2?u[2]:void 0;if(f){let d=hr,g=String(f);hr=g,Je("history",{from:d,to:g})}return a.apply(this,u)}}ye(Me.history,"pushState",r),ye(Me.history,"replaceState",r)}let pr={};function Tf(n){let r=pr[n];if(r)return r;let a=Me[n];if(ri(a))return pr[n]=a.bind(Me);let u=Me.document;if(u&&typeof u.createElement=="function")try{let f=u.createElement("iframe");f.hidden=!0,u.head.appendChild(f);let d=f.contentWindow;d&&d[n]&&(a=d[n]),u.head.removeChild(f)}catch(f){F.warn(`Could not create sandbox iframe for ${n} check, bailing to window.${n}: `,f)}return a&&(pr[n]=a.bind(Me))}function Ya(n){pr[n]=void 0}let Pn="__sentry_xhr_v3__";function xf(n){let r="xhr";Ot(r,n),Ft(r,Pf)}function Pf(){if(!Me.XMLHttpRequest)return;let n=XMLHttpRequest.prototype;ye(n,"open",function(r){return function(...a){let u=st()*1e3,f=h(a[0])?a[0].toUpperCase():void 0,d=Cf(a[1]);if(!f||!d)return r.apply(this,a);this[Pn]={method:f,url:d,request_headers:{}},f==="POST"&&d.match(/sentry_key/)&&(this.__sentry_own_request__=!0);let g=()=>{let b=this[Pn];if(b&&this.readyState===4){try{b.status_code=this.status}catch{}let x={endTimestamp:st()*1e3,startTimestamp:u,xhr:this};Je("xhr",x)}};return"onreadystatechange"in this&&typeof this.onreadystatechange=="function"?ye(this,"onreadystatechange",function(b){return function(...x){return g(),b.apply(this,x)}}):this.addEventListener("readystatechange",g),ye(this,"setRequestHeader",function(b){return function(...x){let[R,W]=x,U=this[Pn];return U&&h(R)&&h(W)&&(U.request_headers[R.toLowerCase()]=W),b.apply(this,x)}}),r.apply(this,a)}}),ye(n,"send",function(r){return function(...a){let u=this[Pn];if(!u)return r.apply(this,a);a[0]!==void 0&&(u.body=a[0]);let f={startTimestamp:st()*1e3,xhr:this};return Je("xhr",f),r.apply(this,a)}})}function Cf(n){if(h(n))return n;try{return n.toString()}catch{}}function qa(n,r=Tf("fetch")){let a=0,u=0;function f(d){let g=d.body.length;a+=g,u++;let b={body:d.body,method:"POST",referrerPolicy:"origin",headers:n.headers,keepalive:a<=6e4&&u<15,...n.fetchOptions};if(!r)return Ya("fetch"),or("No fetch implementation available");try{return r(n.url,b).then(x=>(a-=g,u--,{statusCode:x.status,headers:{"x-sentry-rate-limits":x.headers.get("X-Sentry-Rate-Limits"),"retry-after":x.headers.get("Retry-After")}}))}catch(x){return Ya("fetch"),a-=g,u--,or(x)}}return Aa(n,f)}let Af=10,Df=20,Rf=30,Of=40,Ff=50;function en(n,r,a,u){let f={filename:n,function:r==="<anonymous>"?et:r,in_app:!0};return a!==void 0&&(f.lineno=a),u!==void 0&&(f.colno=u),f}let Mf=/^\s*at (\S+?)(?::(\d+))(?::(\d+))\s*$/i,Nf=/^\s*at (?:(.+?\)(?: \[.+\])?|.*?) ?\((?:address at )?)?(?:async )?((?:<anonymous>|[-a-z]+:|.*bundle|\/)?.*?)(?::(\d+))?(?::(\d+))?\)?\s*$/i,Lf=/\((\S*)(?::(\d+))(?::(\d+))\)/,Xa=[Rf,n=>{let r=Mf.exec(n);if(r){let[,u,f,d]=r;return en(u,et,+f,+d)}let a=Nf.exec(n);if(a){if(a[2]&&a[2].indexOf("eval")===0){let g=Lf.exec(a[2]);g&&(a[2]=g[1],a[3]=g[2],a[4]=g[3])}let[f,d]=es(a[1]||et,a[2]);return en(d,f,a[3]?+a[3]:void 0,a[4]?+a[4]:void 0)}}],$f=/^\s*(.*?)(?:\((.*?)\))?(?:^|@)?((?:[-a-z]+)?:\/.*?|\[native code\]|[^@]*(?:bundle|\d+\.js)|\/[\w\-. /=]+)(?::(\d+))?(?::(\d+))?\s*$/i,Bf=/(\S+) line (\d+)(?: > eval line \d+)* > eval/i,Ja=[Ff,n=>{let r=$f.exec(n);if(r){if(r[3]&&r[3].indexOf(" > eval")>-1){let d=Bf.exec(r[3]);d&&(r[1]=r[1]||"eval",r[3]=d[1],r[4]=d[2],r[5]="")}let u=r[3],f=r[1]||et;return[f,u]=es(f,u),en(u,f,r[4]?+r[4]:void 0,r[5]?+r[5]:void 0)}}],jf=/^\s*at (?:((?:\[object object\])?.+) )?\(?((?:[-a-z]+):.*?):(\d+)(?::(\d+))?\)?\s*$/i,Uf=[Of,n=>{let r=jf.exec(n);return r?en(r[2],r[1]||et,+r[3],r[4]?+r[4]:void 0):void 0}],Kf=/ line (\d+).*script (?:in )?(\S+)(?:: in function (\S+))?$/i,Hf=[Af,n=>{let r=Kf.exec(n);return r?en(r[2],r[3]||et,+r[1]):void 0}],Wf=/ line (\d+), column (\d+)\s*(?:in (?:<anonymous function: ([^>]+)>|([^)]+))\(.*\))? in (.*):\s*$/i,zf=[Df,n=>{let r=Wf.exec(n);return r?en(r[5],r[3]||r[4]||et,+r[1],+r[2]):void 0}],Qa=[Xa,Ja],Za=Oo(...Qa),es=(n,r)=>{let a=n.indexOf("safari-extension")!==-1,u=n.indexOf("safari-web-extension")!==-1;return a||u?[n.indexOf("@")!==-1?n.split("@")[0]:et,a?`safari-extension:${r}`:`safari-web-extension:${r}`]:[n,r]},mr=1024,Vf="Breadcrumbs",ts=(n={})=>{let r={console:!0,dom:!0,fetch:!0,history:!0,sentry:!0,xhr:!0,...n};return{name:Vf,setup(a){r.console&&Mc(qf(a)),r.dom&&bf(Yf(a,r.dom)),r.xhr&&xf(Xf(a)),r.fetch&&Bc(Jf(a)),r.history&&Ga(Qf(a)),r.sentry&&a.on("beforeSendEvent",Gf(a))}}};function Gf(n){return function(a){pe()===n&&lt({category:`sentry.${a.type==="transaction"?"transaction":"event"}`,event_id:a.event_id,level:a.level,message:vt(a)},{event:a})}}function Yf(n,r){return function(u){if(pe()!==n)return;let f,d,g=typeof r=="object"?r.serializeAttribute:void 0,b=typeof r=="object"&&typeof r.maxStringLength=="number"?r.maxStringLength:void 0;b&&b>mr&&(F.warn(`\`dom.maxStringLength\` cannot exceed ${mr}, but a value of ${b} was configured. Sentry will use ${mr} instead.`),b=mr),typeof g=="string"&&(g=[g]);try{let R=u.event,W=Zf(R)?R.target:R;f=he(W,{keyAttrs:g,maxStringLength:b}),d=Oe(W)}catch{f="<unknown>"}if(f.length===0)return;let x={category:`ui.${u.name}`,message:f};d&&(x.data={"ui.component_name":d}),lt(x,{event:u.event,name:u.name,global:u.global})}}function qf(n){return function(a){if(pe()!==n)return;let u={category:"console",data:{arguments:a.args,logger:"console"},level:eu(a.level),message:P(a.args," ")};if(a.level==="assert")if(a.args[0]===!1)u.message=`Assertion failed: ${P(a.args.slice(1)," ")||"console.assert"}`,u.data.arguments=a.args.slice(1);else return;lt(u,{input:a.args,level:a.level})}}function Xf(n){return function(a){if(pe()!==n)return;let{startTimestamp:u,endTimestamp:f}=a,d=a.xhr[Pn];if(!u||!f||!d)return;let{method:g,url:b,status_code:x,body:R}=d,W={method:g,url:b,status_code:x},U={xhr:a.xhr,input:R,startTimestamp:u,endTimestamp:f};lt({category:"xhr",data:W,type:"http"},U)}}function Jf(n){return function(a){if(pe()!==n)return;let{startTimestamp:u,endTimestamp:f}=a;if(f&&!(a.fetchData.url.match(/sentry_key/)&&a.fetchData.method==="POST"))if(a.error){let d=a.fetchData,g={data:a.error,input:a.args,startTimestamp:u,endTimestamp:f};lt({category:"fetch",data:d,level:"error",type:"http"},g)}else{let d=a.response,g={...a.fetchData,status_code:d&&d.status},b={input:a.args,response:d,startTimestamp:u,endTimestamp:f};lt({category:"fetch",data:g,type:"http"},b)}}}function Qf(n){return function(a){if(pe()!==n)return;let u=a.from,f=a.to,d=si(oe.location.href),g=u?si(u):void 0,b=si(f);(!g||!g.path)&&(g=d),d.protocol===b.protocol&&d.host===b.host&&(f=b.relative),d.protocol===g.protocol&&d.host===g.host&&(u=g.relative),lt({category:"navigation",data:{from:u,to:f}})}}function Zf(n){return!!n&&!!n.target}let ed=["EventTarget","Window","Node","ApplicationCache","AudioTrackList","BroadcastChannel","ChannelMergerNode","CryptoOperation","EventSource","FileReader","HTMLUnknownElement","IDBDatabase","IDBRequest","IDBTransaction","KeyOperation","MediaController","MessagePort","ModalWindow","Notification","SVGElementInstance","Screen","SharedWorker","TextTrack","TextTrackCue","TextTrackList","WebSocket","WebSocketWorker","Worker","XMLHttpRequest","XMLHttpRequestEventTarget","XMLHttpRequestUpload"],td="BrowserApiErrors",ns=(n={})=>{let r={XMLHttpRequest:!0,eventTarget:!0,requestAnimationFrame:!0,setInterval:!0,setTimeout:!0,...n};return{name:td,setupOnce(){r.setTimeout&&ye(oe,"setTimeout",rs),r.setInterval&&ye(oe,"setInterval",rs),r.requestAnimationFrame&&ye(oe,"requestAnimationFrame",nd),r.XMLHttpRequest&&"XMLHttpRequest"in oe&&ye(XMLHttpRequest.prototype,"send",rd);let a=r.eventTarget;a&&(Array.isArray(a)?a:ed).forEach(id)}}};function rs(n){return function(...r){let a=r[0];return r[0]=Zt(a,{mechanism:{data:{function:yt(n)},handled:!1,type:"instrument"}}),n.apply(this,r)}}function nd(n){return function(r){return n.apply(this,[Zt(r,{mechanism:{data:{function:"requestAnimationFrame",handler:yt(n)},handled:!1,type:"instrument"}})])}}function rd(n){return function(...r){let a=this;return["onload","onerror","onprogress","onreadystatechange"].forEach(f=>{f in a&&typeof a[f]=="function"&&ye(a,f,function(d){let g={mechanism:{data:{function:f,handler:yt(d)},handled:!1,type:"instrument"}},b=_n(d);return b&&(g.mechanism.data.handler=yt(b)),Zt(d,g)})}),n.apply(this,r)}}function id(n){let r=oe,a=r[n]&&r[n].prototype;!a||!a.hasOwnProperty||!a.hasOwnProperty("addEventListener")||(ye(a,"addEventListener",function(u){return function(f,d,g){try{typeof d.handleEvent=="function"&&(d.handleEvent=Zt(d.handleEvent,{mechanism:{data:{function:"handleEvent",handler:yt(d),target:n},handled:!1,type:"instrument"}}))}catch{}return u.apply(this,[f,Zt(d,{mechanism:{data:{function:"addEventListener",handler:yt(d),target:n},handled:!1,type:"instrument"}}),g])}}),ye(a,"removeEventListener",function(u){return function(f,d,g){let b=d;try{let x=b&&b.__sentry_wrapped__;x&&u.call(this,f,x,g)}catch{}return u.call(this,f,b,g)}}))}let od="GlobalHandlers",is=(n={})=>{let r={onerror:!0,onunhandledrejection:!0,...n};return{name:od,setupOnce(){Error.stackTraceLimit=50},setup(a){r.onerror&&(ad(a),os("onerror")),r.onunhandledrejection&&(sd(a),os("onunhandledrejection"))}}};function ad(n){Kc(r=>{let{stackParser:a,attachStacktrace:u}=as();if(pe()!==n||ja())return;let{msg:f,url:d,line:g,column:b,error:x}=r,R=ld(_i(a,x||f,void 0,u,!1),d,g,b);R.level="error",ur(R,{originalException:x,mechanism:{handled:!1,type:"onerror"}})})}function sd(n){Wc(r=>{let{stackParser:a,attachStacktrace:u}=as();if(pe()!==n||ja())return;let f=cd(r),d=m(f)?ud(f):_i(a,f,void 0,u,!0);d.level="error",ur(d,{originalException:f,mechanism:{handled:!1,type:"onunhandledrejection"}})})}function cd(n){if(m(n))return n;try{if("reason"in n)return n.reason;if("detail"in n&&"reason"in n.detail)return n.detail.reason}catch{}return n}function ud(n){return{exception:{values:[{type:"UnhandledRejection",value:`Non-Error promise rejection captured with value: ${String(n)}`}]}}}function ld(n,r,a,u){let f=n.exception=n.exception||{},d=f.values=f.values||[],g=d[0]=d[0]||{},b=g.stacktrace=g.stacktrace||{},x=b.frames=b.frames||[],R=isNaN(parseInt(u,10))?void 0:u,W=isNaN(parseInt(a,10))?void 0:a,U=h(r)&&r.length>0?r:je();return x.length===0&&x.push({colno:R,filename:U,function:et,in_app:!0,lineno:W}),n}function os(n){F.log(`Global Handler attached: ${n}`)}function as(){let n=pe();return n&&n.getOptions()||{stackParser:()=>[],attachStacktrace:!1}}let ss=()=>({name:"HttpContext",preprocessEvent(n){if(!oe.navigator&&!oe.location&&!oe.document)return;let r=n.request&&n.request.url||oe.location&&oe.location.href,{referrer:a}=oe.document||{},{userAgent:u}=oe.navigator||{},f={...n.request&&n.request.headers,...a&&{Referer:a},...u&&{"User-Agent":u}},d={...n.request,...r&&{url:r},headers:f};n.request=d}}),fd="cause",dd=5,hd="LinkedErrors",cs=(n={})=>{let r=n.limit||dd,a=n.key||fd;return{name:hd,preprocessEvent(u,f,d){let g=d.getOptions();D(dr,g.stackParser,g.maxValueLength,a,r,u,f)}}};function us(n){return[Ma(),Fa(),ns(),ts(),is(),cs(),Na(),ss()]}function pd(n={}){return{...{defaultIntegrations:us(),release:typeof __SENTRY_RELEASE__=="string"?__SENTRY_RELEASE__:oe.SENTRY_RELEASE&&oe.SENTRY_RELEASE.id?oe.SENTRY_RELEASE.id:void 0,autoSessionTracking:!0,sendClientReports:!0},...n}}function md(){let n=oe,r=n.chrome?"chrome":"browser",a=n[r],u=a&&a.runtime&&a.runtime.id,f=oe.location&&oe.location.href||"",d=["chrome-extension:","moz-extension:","ms-browser-extension:"],g=!!u&&oe===oe.top&&d.some(x=>f.startsWith(`${x}//`)),b=typeof n.nw<"u";return!!u&&!g&&!b}function gd(n={}){let r=pd(n);if(md()){G(()=>{console.error("[Sentry] You cannot run Sentry this way in a browser extension, check: https://docs.sentry.io/platforms/javascript/best-practices/browser-extensions/")});return}No()||F.warn("No Fetch API detected. The Sentry SDK requires a Fetch API compatible environment to send events. Please add a Fetch API polyfill.");let a={...r,stackParser:Oc(r.stackParser||Za),integrations:Cl(r),transport:r.transport||qa},u=Ml(Wa,a);return r.autoSessionTracking&&bd(),u}function yd(n={}){if(!oe.document){F.error("Global document not defined in showReportDialog call");return}let r=Fe(),a=r.getClient(),u=a&&a.getDsn();if(!u){F.error("DSN not configured for showReportDialog call");return}if(r&&(n.user={...r.getUser(),...n.user}),!n.eventId){let b=wa();b&&(n.eventId=b)}let f=oe.document.createElement("script");f.async=!0,f.crossOrigin="anonymous",f.src=xl(u,n),n.onLoad&&(f.onload=n.onLoad);let{onClose:d}=n;if(d){let b=x=>{if(x.data==="__sentry_reportdialog_closed__")try{d()}finally{oe.removeEventListener("message",b)}};oe.addEventListener("message",b)}let g=oe.document.head||oe.document.body;g?g.appendChild(f):F.error("Not injecting report dialog. No injection point found in HTML")}function vd(){}function _d(n){n()}function bd(){if(typeof oe.document>"u"){F.warn("Session tracking in non-browser environment with @sentry/browser is not supported.");return}lr({ignoreDuration:!0}),pi(),Ga(({from:n,to:r})=>{n!==void 0&&n!==r&&(lr({ignoreDuration:!0}),pi())})}function wd(n){let r=pe();r&&r.captureUserFeedback(n)}let Ed={replayIntegration:"replay",replayCanvasIntegration:"replay-canvas",feedbackIntegration:"feedback",feedbackModalIntegration:"feedback-modal",feedbackScreenshotIntegration:"feedback-screenshot",captureConsoleIntegration:"captureconsole",contextLinesIntegration:"contextlines",linkedErrorsIntegration:"linkederrors",debugIntegration:"debug",dedupeIntegration:"dedupe",extraErrorDataIntegration:"extraerrordata",httpClientIntegration:"httpclient",reportingObserverIntegration:"reportingobserver",rewriteFramesIntegration:"rewriteframes",sessionTimingIntegration:"sessiontiming",browserProfilingIntegration:"browserprofiling"},ls=oe;async function Sd(n){let r=Ed[n],a=ls.Sentry=ls.Sentry||{};if(!r)throw new Error(`Cannot lazy load integration: ${n}`);let u=a[n];if(typeof u=="function")return u;let f=Id(r),d=oe.document.createElement("script");d.src=f,d.crossOrigin="anonymous",d.referrerPolicy="origin";let g=new Promise((x,R)=>{d.addEventListener("load",()=>x()),d.addEventListener("error",R)});oe.document.body.appendChild(d);try{await g}catch{throw new Error(`Error when loading integration: ${n}`)}let b=a[n];if(typeof b!="function")throw new Error(`Could not load integration: ${n}`);return b}function Id(n){let r=pe(),a=r&&r.getOptions(),u=a&&a.cdnBaseUrl||"https://browser.sentry-cdn.com";return new URL(`/${V}/${n}.min.js`,u).toString()}return e.BrowserClient=Wa,e.SDK_VERSION=V,e.SEMANTIC_ATTRIBUTE_SENTRY_OP=ia,e.SEMANTIC_ATTRIBUTE_SENTRY_ORIGIN=oa,e.SEMANTIC_ATTRIBUTE_SENTRY_SAMPLE_RATE=ra,e.SEMANTIC_ATTRIBUTE_SENTRY_SOURCE=na,e.Scope=ut,e.WINDOW=oe,e.addBreadcrumb=lt,e.addEventProcessor=El,e.addIntegration=Dl,e.breadcrumbsIntegration=ts,e.browserApiErrorsIntegration=ns,e.browserTracingIntegration=sf,e.captureEvent=ur,e.captureException=pa,e.captureMessage=vl,e.captureSession=pi,e.captureUserFeedback=wd,e.chromeStackLineParser=Xa,e.close=bl,e.continueTrace=el,e.createTransport=Aa,e.createUserFeedbackEnvelope=Ha,e.dedupeIntegration=Na,e.defaultStackLineParsers=Qa,e.defaultStackParser=Za,e.endSession=Tn,e.eventFromException=Ua,e.eventFromMessage=Ka,e.exceptionFromError=dr,e.feedbackAsyncIntegration=Jo,e.feedbackIntegration=Jo,e.flush=_l,e.forceLoad=vd,e.functionToStringIntegration=Fa,e.geckoStackLineParser=Ja,e.getClient=pe,e.getCurrentHub=of,e.getCurrentScope=Fe,e.getDefaultIntegrations=us,e.getGlobalScope=ta,e.getIsolationScope=$e,e.globalHandlersIntegration=is,e.httpContextIntegration=ss,e.inboundFiltersIntegration=Ma,e.init=gd,e.isInitialized=wl,e.lastEventId=wa,e.lazyLoadIntegration=Sd,e.linkedErrorsIntegration=cs,e.makeFetchTransport=qa,e.metrics=cf,e.onLoad=_d,e.opera10StackLineParser=Hf,e.opera11StackLineParser=zf,e.parameterize=Ll,e.replayIntegration=ku,e.setContext=ma,e.setCurrentClient=Ca,e.setExtra=ya,e.setExtras=ga,e.setTag=_a,e.setTags=va,e.setUser=ba,e.showReportDialog=yd,e.spanToBaggageHeader=qu,e.spanToJSON=In,e.spanToTraceHeader=Hu,e.startSession=lr,e.winjsStackLineParser=Uf,e.withIsolationScope=Nu,e.withScope=cr,e}({});var Ii,Cn,hs,ps,ms,Td,An,Pe,Ce,Ae,De,ki,Ti,yr,xi,gs,ys,ft,vr;ft=function(e,t){var i,o;return i=(e&65535)+(t&65535),o=(e>>16)+(t>>16)+(i>>16),o<<16|i&65535};hs=function(e,t){return e<<t|e>>>32-t};An=function(e,t,i,o,s,c){return ft(hs(ft(ft(t,e),ft(o,c)),s),i)};Pe=function(e,t,i,o,s,c,l){return An(t&i|~t&o,e,t,s,c,l)};Ce=function(e,t,i,o,s,c,l){return An(t&o|i&~o,e,t,s,c,l)};Ae=function(e,t,i,o,s,c,l){return An(t^i^o,e,t,s,c,l)};De=function(e,t,i,o,s,c,l){return An(i^(t|~o),e,t,s,c,l)};Cn=function(e,t){var i,o,s,c,l,h,p,m,v;for(e[t>>5]|=128<<t%32,e[(t+64>>>9<<4)+14]=t,l=void 0,h=void 0,p=void 0,m=void 0,v=void 0,i=1732584193,o=-271733879,s=-1732584194,c=271733878,l=0;l<e.length;)h=i,p=o,m=s,v=c,i=Pe(i,o,s,c,e[l],7,-680876936),c=Pe(c,i,o,s,e[l+1],12,-389564586),s=Pe(s,c,i,o,e[l+2],17,606105819),o=Pe(o,s,c,i,e[l+3],22,-1044525330),i=Pe(i,o,s,c,e[l+4],7,-176418897),c=Pe(c,i,o,s,e[l+5],12,1200080426),s=Pe(s,c,i,o,e[l+6],17,-1473231341),o=Pe(o,s,c,i,e[l+7],22,-45705983),i=Pe(i,o,s,c,e[l+8],7,1770035416),c=Pe(c,i,o,s,e[l+9],12,-1958414417),s=Pe(s,c,i,o,e[l+10],17,-42063),o=Pe(o,s,c,i,e[l+11],22,-1990404162),i=Pe(i,o,s,c,e[l+12],7,1804603682),c=Pe(c,i,o,s,e[l+13],12,-40341101),s=Pe(s,c,i,o,e[l+14],17,-1502002290),o=Pe(o,s,c,i,e[l+15],22,1236535329),i=Ce(i,o,s,c,e[l+1],5,-165796510),c=Ce(c,i,o,s,e[l+6],9,-1069501632),s=Ce(s,c,i,o,e[l+11],14,643717713),o=Ce(o,s,c,i,e[l],20,-373897302),i=Ce(i,o,s,c,e[l+5],5,-701558691),c=Ce(c,i,o,s,e[l+10],9,38016083),s=Ce(s,c,i,o,e[l+15],14,-660478335),o=Ce(o,s,c,i,e[l+4],20,-405537848),i=Ce(i,o,s,c,e[l+9],5,568446438),c=Ce(c,i,o,s,e[l+14],9,-1019803690),s=Ce(s,c,i,o,e[l+3],14,-187363961),o=Ce(o,s,c,i,e[l+8],20,1163531501),i=Ce(i,o,s,c,e[l+13],5,-1444681467),c=Ce(c,i,o,s,e[l+2],9,-51403784),s=Ce(s,c,i,o,e[l+7],14,1735328473),o=Ce(o,s,c,i,e[l+12],20,-1926607734),i=Ae(i,o,s,c,e[l+5],4,-378558),c=Ae(c,i,o,s,e[l+8],11,-2022574463),s=Ae(s,c,i,o,e[l+11],16,1839030562),o=Ae(o,s,c,i,e[l+14],23,-35309556),i=Ae(i,o,s,c,e[l+1],4,-1530992060),c=Ae(c,i,o,s,e[l+4],11,1272893353),s=Ae(s,c,i,o,e[l+7],16,-155497632),o=Ae(o,s,c,i,e[l+10],23,-1094730640),i=Ae(i,o,s,c,e[l+13],4,681279174),c=Ae(c,i,o,s,e[l],11,-358537222),s=Ae(s,c,i,o,e[l+3],16,-722521979),o=Ae(o,s,c,i,e[l+6],23,76029189),i=Ae(i,o,s,c,e[l+9],4,-640364487),c=Ae(c,i,o,s,e[l+12],11,-421815835),s=Ae(s,c,i,o,e[l+15],16,530742520),o=Ae(o,s,c,i,e[l+2],23,-995338651),i=De(i,o,s,c,e[l],6,-198630844),c=De(c,i,o,s,e[l+7],10,1126891415),s=De(s,c,i,o,e[l+14],15,-1416354905),o=De(o,s,c,i,e[l+5],21,-57434055),i=De(i,o,s,c,e[l+12],6,1700485571),c=De(c,i,o,s,e[l+3],10,-1894986606),s=De(s,c,i,o,e[l+10],15,-1051523),o=De(o,s,c,i,e[l+1],21,-2054922799),i=De(i,o,s,c,e[l+8],6,1873313359),c=De(c,i,o,s,e[l+15],10,-30611744),s=De(s,c,i,o,e[l+6],15,-1560198380),o=De(o,s,c,i,e[l+13],21,1309151649),i=De(i,o,s,c,e[l+4],6,-145523070),c=De(c,i,o,s,e[l+11],10,-1120210379),s=De(s,c,i,o,e[l+2],15,718787259),o=De(o,s,c,i,e[l+9],21,-343485551),i=ft(i,h),o=ft(o,p),s=ft(s,m),c=ft(c,v),l+=16;return[i,o,s,c]};Ii=function(e){var t,i,o;for(t=void 0,o="",i=e.length*32,t=0;t<i;)o+=String.fromCharCode(e[t>>5]>>>t%32&255),t+=8;return o};yr=function(e){var t,i,o;for(t=void 0,o=[],o[(e.length>>2)-1]=void 0,t=0;t<o.length;)o[t]=0,t+=1;for(i=e.length*8,t=0;t<i;)o[t>>5]|=(e.charCodeAt(t/8)&255)<<t%32,t+=8;return o};ys=function(e){return Ii(Cn(yr(e),e.length*8))};gs=function(e,t){var i,o,s,c,l;for(s=void 0,i=yr(e),c=[],l=[],o=void 0,c[15]=l[15]=void 0,i.length>16&&(i=Cn(i,e.length*8)),s=0;s<16;)c[s]=i[s]^909522486,l[s]=i[s]^1549556828,s+=1;return o=Cn(c.concat(yr(t)),512+t.length*8),Ii(Cn(l.concat(o),640))};xi=function(e){var t,i,o,s;for(t="0123456789abcdef",o="",s=void 0,i=void 0,i=0;i<e.length;)s=e.charCodeAt(i),o+=t.charAt(s>>>4&15)+t.charAt(s&15),i+=1;return o};vr=function(e){return unescape(encodeURIComponent(e))};Ti=function(e){return ys(vr(e))};ms=function(e){return xi(Ti(e))};ki=function(e,t){return gs(vr(e),vr(t))};ps=function(e,t){return xi(ki(e,t))};var xd=Td=function(e,t,i){return t?i?ki(t,e):ps(t,e):i?Ti(e):ms(e)},vs=xd;var tn=ds,Pi=!1;async function Dn(e){return(await chrome.storage.local.get(e)||{})[e]}async function Pd(){let e=await Dn(H.B);try{if(!e||(e?.lastUpdated||0)+(e?.validity||0)<Date.now()){te()("Fetching sentry filter...");let t=Xe().extVersionFull,i=await fetch(H.he.replace("%VERSION%",t),{cache:"reload"});if(i.status===200){e=await i.json(),e.lastUpdated=Date.now();let o={};o[H.B]=e,await chrome.storage.local.set(o)}}}catch{}return e||{}}function Cd(e,t,i){if(e.action==="deny all")return te()("Error reporting is 'deny all'"),!0;if(e.action==="filter"&&e.patterns){fe&&(i&&console.log(i),t&&console.log(t));let o=!1;for(let s of e.patterns){if(s.hash&&s.hash===t)te()("Sentry filter matched hash: "+t),o=!0;else if(s.regex&&i){let[,c,l]=s.regex.match(/^\/(.+)\/(.*)$/)||[];o=c&&i.match(new RegExp(c,l))!==null,o&&te()("Sentry filter matched regex: "+s.regex)}if(o)break}return o}else return!1}async function Ad(e){let t=await Dn(H._),i=await Dn(H.c),o=await Dn(H.e)=="true";return e.tags={...e.tags||{}},t&&(e.tags.UUID=t),i&&(e.tags.Serial=i),e.tags.Pro=o,e}function _s(){Pi=!0;let e=chrome.runtime.id;try{let t=function(i){function o(s){let c={body:s.body,method:"POST",referrerPolicy:"origin",headers:i.headers,...i.fetchOptions};return fetch(i.url,c).then(l=>({statusCode:l.status,headers:{"x-sentry-rate-limits":l.headers.get("X-Sentry-Rate-Limits"),"retry-after":l.headers.get("Retry-After")}}))}return tn.createTransport(i,o)};_r()&&delete chrome.runtime.id,tn.init({dsn:"https://b3cea7a848c3686ab337138a6a9751d0@o4507590541901824.ingest.us.sentry.io/4507590546096128",release:"head@"+Xe().extVersionFull,debug:fe,autoSessionTracking:!1,transport:t,allowUrls:[/mcbpblocgmgfnpjjppndjkmgjaogfceg/,/kmmldmlijnljnnhagfldmihaimmholga/],integrations:[],beforeSend:i=>Dn(H.re).then(o=>o==="false"?(fe&&(te()(i),te()("Sentry is disabled")),null):new Promise(s=>{let c=(l,h)=>{i.breadcrumbs=[{level:l,timestamp:Date.now()/1e3,message:h},...i.breadcrumbs||[]]};try{let l,h,p=i?.exception?.values?.slice(-1).pop();if(p){let v=p.stacktrace?.frames;if(v?.length>0){let y=v.map(A=>({filename:A.filename,lineno:A.lineno,colno:A.colno,function:A.function})),E=JSON.stringify(y);l=vs(E),c("debug",E),c("info",`FSHASH: ${l}`)}h=p.type.trim()+": "+p.value.trim()}!l&&!h&&s(i);let m=Pd().then(v=>Cd(v,l,h)?null:Ad(i)).catch(v=>(c("debug",v.message+" "+v.stack),i));s(m)}catch(l){c("debug",l.message+" "+l.stack),s(i)}}))})}finally{_r()&&(chrome.runtime.id=e)}}function Rn(e){Pi&&tn.addBreadcrumb({message:e})}function Ci(e,t){Pi&&tn.captureMessage(e,t)}function Qe(){return/^win/i.test(navigator.platform)}function br(){return/opr\/\d+\./i.test(navigator.appVersion)||chrome.runtime.id==="pbjmgmedeliohhbaefhlplndokcbmjio"}function wr(){return/edg\/\d+\./i.test(navigator.appVersion)||chrome.runtime.id==="fcbmiimfkmkkkffjlopcpdlgclncnknm"}function dt(){return/apple/i.test(navigator.vendor)}function ht(){return bs()==="firefox"}function Nt(){return br()?"op":wr()?"edge":dt()?"safari":ht()?"fx":"ch"}function bs(){var e=chrome.runtime.id;if(e==="legfpnnmhhnhjgekmmbkilmijnjoehne")return br()?"opera":wr()?"edge":"chrome";let t=["pbjmgmedeliohhbaefhlplndokcbmjio"],i=["fireshot@getfireshot.com","fireshot-pro@getfireshot.com","fireshot-beta@getfireshot.com","{0b457cAA-602d-484a-8fe7-c1d894a011ba}","{5e11ab1e-083c-11e5-a6c0-1697f925ec7b}"],o=["fcbmiimfkmkkkffjlopcpdlgclncnknm"];return t.indexOf(e)>-1?"opera":i.indexOf(e)>-1?"firefox":o.indexOf(e)>-1?"edge":"chrome"}var Dd=bs(),nn={contractId:{chrome:"com.getfireshot.api",opera:"com.getfireshot.api",edge:"com.getfireshot.api",firefox:"com.getfireshot.api.firefox"},nativeFilePath:{chrome:"fireshot-chrome-plugin.dat",opera:"fireshot-chrome-plugin.dat",edge:"fireshot-chrome-plugin.dat",firefox:"fireshot-chrome-plugin.dat"}};for(Ai in nn)nn[Ai]=nn[Ai][Dd];var Ai;var Lt=chrome.runtime.id,fe=["legfpnnmhhnhjgekmmbkilmijnjoehne","fireshot-beta@getfireshot.com","kmmldmlijnljnnhagfldmihaimmholga"].indexOf(Lt)>-1;chrome.storage.local.get([H.M]).then(e=>fe=fe||e[H.M]);var Rd=console.log;te()("Extension ID: "+Lt);function Od(e){fe&&console.log(`${e} not implemented yet.`)}function Fd(){return re(H.j)==="true"||re(H.j)==="1"}function _r(){return self.constructor.name==="ServiceWorkerGlobalScope"}function Di(){if(Fd())return!1;{let e=re(H.u,"false")==="true";return _r()&&e&&!Ps.port?(we(H.u,"false"),!1):e}}function Xe(){let e=chrome.runtime.getManifest();return{extVersion:e.version.split(".",3).join("."),extVersionFull:e.version.split(".",4).join("."),fSilentMode:Lt=="legfpnnmhhnhjgekmmbkilmijnjoehne"||Lt=="hpbicldbpgipcloiojdbchegbbjiobbm"||Lt=="adpnodbfhlagloahhdhjggicnfcpggkm"}}function ws(e){te()("openURLV2");let i=(o,s=0)=>{s>0&&te()(`trial ${s}`);let c=()=>{++s<10?setTimeout(()=>i(o,s),150):chrome.windows.create({url:e}).catch(l=>reportError(l))};try{chrome.tabs.create(o).catch(()=>c())}catch{c()}};i({url:e})}function On(e,t){if(te()("openURL"),!t)return chrome.tabs.create({url:e});chrome.tabs.create({url:e},i=>{let o=(s,c)=>{if(s===i.id)switch(c.status){case"complete":chrome.tabs.onUpdated.removeListener(o),t(i);break}};chrome.tabs.onUpdated.addListener(o),setTimeout(()=>chrome.tabs.onUpdated.removeListener(o),1e4)})}function te(){return(...e)=>{if(e.length!==0)if(fe&&Rd(...e),e.length>1)Rn(JSON.stringify(e).substring(0,512));else{let t=typeof e[0]=="string"?e[0]:JSON.stringify(e);Rn(t.substring(0,512))}}}function Er(e){fe&&console.time(e)}function Sr(e){fe&&console.timeEnd(e)}function Fn(e){console.error("FireShot: "+e)}function Es(){let e=document.createNodeIterator(document.documentElement,NodeFilter.SHOW_ELEMENT,null),t;for(;t=e.nextNode();)[{i18Attr:"data-i18n",originalAttr:"innerText"},{i18Attr:"data-title-i18n",originalAttr:"title"}].forEach(o=>{let s;if(s=t.getAttribute(o.i18Attr)){let c=chrome.i18n.getMessage(s);c?t[o.originalAttr]=c:t[o.originalAttr]=(fe?"#":"")+t[o.originalAttr],fe||t.removeAttribute(o.i18Attr)}})}function wt(e,t,i,o,s){Od("gaTrack")}function rn(e,t,i){for(e=e.toString();e.length<i;)e=t+e;return e}function Ss(e,t,i=re(H.i,2)-1){let o=re(H.v,100),s=0,c;do{c=re(H.o,H.G);let l=new Date,h=e,p=t,m="not available";try{m=new URL(h).hostname}catch{}c=c.replace(/%n/g,re(H.m,"true")==="true"?rn(i,0,re(H.g,3)):i),c=c.replace(/%y/g,l.getFullYear()),c=c.replace(/%m/g,rn(l.getMonth()+1,0,2)),c=c.replace(/%d/g,rn(l.getDate(),0,2)),c=c.replace(/%H/g,rn(l.getHours(),0,2)),c=c.replace(/%M/g,rn(l.getMinutes(),0,2)),c=c.replace(/%S/g,rn(l.getSeconds(),0,2)),c=c.replace(/%A/g,l.toLocaleDateString(navigator.language,{weekday:"long"})),c=c.replace(/%B/g,l.toLocaleDateString(navigator.language,{month:"long"})),s==1?h=h.substr(0,Math.max(14,o-c.length+1)):s==2?(h=h.replace(/(.*)\?.*/gi,"$1"),c=c.replace(/%u/g,h),p=p.substr(0,Math.max(14,o-c.length+1))+"_"):s==3&&(h=h.substr(0,(o-c.length)/2-1),c=c.replace(/%u/g,h),p=p.substr(0,o-c.length-1)+"_"),c=c.replace(/%u/g,h),c=c.replace(/%t/g,p),c=c.replace(/%e/g,m),c=c.replace(/[:/\\*?<>|"]/g,function(v){switch(v){case"<":return"{";case">":return"}";case"|":return"-"}return"_"})}while(++s<4&&c.length>o);return c===""&&(c="Untitled"),c}function tt(){return Di()?re(H.e)=="true":!Qe()&&re(H.e)=="true"}function Ri(){return re(H.I)==="true"}function Is(e,t,i){dt()||ht()?t():chrome.permissions.contains(e,o=>{o?t():chrome.permissions.request(e,s=>{!chrome.runtime.lastError||console.log(chrome.runtime.lastError),s?t():(te()("The user rejected to grant permissions."),i&&i())})})}function ks(e,t){Is({permissions:["downloads"]},e,t)}function Ts(){return new Promise(e=>Is({origins:["https://mail.google.com/*"]},()=>e(!0),()=>e(!1)))}function Oi(e){let t;return(...i)=>{t&&cancelAnimationFrame(t),t=requestAnimationFrame(()=>{e(...i)})}}function xs(e=0){return new Promise(t=>{setTimeout(t,e)})}var Md=0,Nd=1,Ps={port:void 0,ready:!1,autoReconnect:!1,updating:!1,updated:!1,ignoreResponse:!1,portBusy:!1,callback:void 0,callbackDisconnected:void 0,prevVersion:void 0,updateTrials:0,pendingData:"",firstPacket:!0,onNativeHostUpdated:null,onPluginEvent:null,init:function(e,t,i,o){this.onNativeHostUpdated=t,this.onPluginEvent=e;let s=c=>{if(this.ignoreResponse){te()("Ignored response: "+JSON.stringify(c)),c.topic==="status"&&c.code==Nd&&(this.updating=!1,this.autoReconnect=!1,e&&e(c));return}this.autoReconnect=!1,!this.processInternally(c)&&e&&e(c)};this.callback=i,this.callbackDisconnected=o,this.ignoreResponse=!1,this.portBusy=!0;try{this.port=chrome.runtime.connectNative(nn.contractId+"")}catch(c){Fn(c.message),this.portBusy=!1}this.port.onMessage.addListener(c=>{if(c.data!=="")this.pendingData+=c.data;else try{let l=JSON.parse(this.pendingData);fe&&te()("Original Packet: "+this.pendingData.substr(0,1024)),this.pendingData="",s(l)}catch(l){tn.captureException(l),console.error("Original Packet: "+this.pendingData.substr(0,1024)),this.pendingData="",Fn(l.message)}}),this.port.onDisconnect.addListener(()=>{chrome.runtime.lastError&&console.log("ERROR: "+chrome.runtime.lastError.message),this.ready=!1,this.portBusy=!1,we(H.u,"false"),!this.updating&&this.callbackDisconnected&&this.callbackDisconnected(),te()("Native port disconnected."),this.firstPacket=!0,this.pendingData="",this.autoReconnect&&this.doReconnect()}),te()("Native port created successfully. Starting test..."),this.launchJSON({JSONCommand:"ping",version:Xe().extVersionFull,id:Lt})},processInternally:function(e){if(e.topic=="hostVersion"){if(this.hostVersion=e.data,Xe().extVersion!=this.hostVersion)return++this.updateTrials>3?(te()("Too much of unsuccessful update trials. No updates anymore."),Ci("Too much of unsuccessful update trials. No updates anymore."),this.updating=!1,!1):(this.prevVersion=this.hostVersion,this.doUpdate(),!0)}else if(e.topic=="status")if(e.code==Md){var t=e.data;return this.updateTrials=0,this.ready=!0,we(H.u,"true"),this.callback&&(this.callback(),this.callback=void 0),this.updating&&(this.updated=!0,this.updating=!1,this.prevVersion!="0"&&this.onNativeHostUpdated(t)),!1}else return this.updating&&(this.updating=!1),!1;else if(e.topic=="getDLL")return this.sendDLL(e.x64),!0;return!1},launchJSON:function(e){this.port.postMessage(e)},getFile:function(e,t){let i=()=>{let o=!0;if(e.search(/sss-x64\.dat|sss\.dat|fireshot-chrome-plugin\.dat/)!==-1){let s=Xe().extVersionFull,c=H.de+s,l=parseInt(bt.getOption(c,"0"));l<3?(te()("Opening helper installer page."),o=!1,bt.setOption(c,l+1),ws("https://getfireshot.com/helper-install.php?ver="+s)):te()("Helper installer page cannot be shown more than 3 times, aborting.")}return o};te()("Fetching: "+e),fetch(chrome.runtime.getURL(e)).then(o=>{te()(`Fetching status = [${o.status}]`),o.ok?o.blob().then(s=>{te()(`Blob size is ${s.size} bytes`);let c=new FileReader;c.onload=l=>{te()("Fetching complete");let h="base64,";t(l.target.result.substr(l.target.result.indexOf(h)+h.length,l.target.result.length))},c.onerror=()=>{te()("Error in FileReader")},c.readAsDataURL(s)}).catch(s=>{i()&&reportError(s)}):(te()("NativeError-Error retrieving file"),Ci(`Error retrieving file: ${o.status}`))}).catch(o=>{i()&&reportError(o)})},sendDLL:function(e){this.getFile(`native/${e?"sss-x64.dat":"sss.dat"}`,t=>{t&&this.launchJSON({JSONCommand:"updateDLL",version:Xe().extVersionFull,data:t})})},doUpdate:function(){let e=Xe().extVersionFull;te()("Updating native to the version: "+e),this.ignoreResponse=!0,this.getFile("native/"+nn.nativeFilePath,t=>{this.updating=!0,this.autoReconnect=!0,this.launchJSON({JSONCommand:"updateNative",version:e,data:t})})},doReconnect:function(){setTimeout(()=>{te()("Trying to reconnect..."),this.init(this.onPluginEvent,this.onNativeHostUpdated,this.callback,this.callbackDisconnected)},1e3)},forceDisconnect:function(){this.autoReconnect=!1,this.port&&this.port.disconnect(),this.ready=!1,we(H.u,"false")}};var Wi=function(e,t){return Wi=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,o){i.__proto__=o}||function(i,o){for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(i[s]=o[s])},Wi(e,t)};function Ld(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");Wi(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}var ne=function(){return ne=Object.assign||function(t){for(var i,o=1,s=arguments.length;o<s;o++){i=arguments[o];for(var c in i)Object.prototype.hasOwnProperty.call(i,c)&&(t[c]=i[c])}return t},ne.apply(this,arguments)};function Nr(e,t,i){if(i||arguments.length===2)for(var o=0,s=t.length,c;o<s;o++)(c||!(o in t))&&(c||(c=Array.prototype.slice.call(t,0,o)),c[o]=t[o]);return e.concat(c||Array.prototype.slice.call(t))}var Re=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,xe=Object.keys,ve=Array.isArray;typeof Promise<"u"&&!Re.Promise&&(Re.Promise=Promise);function Ge(e,t){return typeof t!="object"||xe(t).forEach(function(i){e[i]=t[i]}),e}var ln=Object.getPrototypeOf,$d={}.hasOwnProperty;function He(e,t){return $d.call(e,t)}function fn(e,t){typeof t=="function"&&(t=t(ln(e))),(typeof Reflect>"u"?xe:Reflect.ownKeys)(t).forEach(function(i){Tt(e,i,t[i])})}var zs=Object.defineProperty;function Tt(e,t,i,o){zs(e,t,Ge(i&&He(i,"get")&&typeof i.get=="function"?{get:i.get,set:i.set,configurable:!0}:{value:i,configurable:!0,writable:!0},o))}function hn(e){return{from:function(t){return e.prototype=Object.create(t.prototype),Tt(e.prototype,"constructor",e),{extend:fn.bind(null,e.prototype)}}}}var Bd=Object.getOwnPropertyDescriptor;function Vs(e,t){var i=Bd(e,t),o;return i||(o=ln(e))&&Vs(o,t)}var jd=[].slice;function Yr(e,t,i){return jd.call(e,t,i)}function Gs(e,t){return t(e)}function Mn(e){if(!e)throw new Error("Assertion Failed")}function Ys(e){Re.setImmediate?setImmediate(e):setTimeout(e,0)}function Ud(e,t){return e.reduce(function(i,o,s){var c=t(o,s);return c&&(i[c[0]]=c[1]),i},{})}function gt(e,t){if(typeof t=="string"&&He(e,t))return e[t];if(!t)return e;if(typeof t!="string"){for(var i=[],o=0,s=t.length;o<s;++o){var c=gt(e,t[o]);i.push(c)}return i}var l=t.indexOf(".");if(l!==-1){var h=e[t.substr(0,l)];return h==null?void 0:gt(h,t.substr(l+1))}}function Ve(e,t,i){if(!(!e||t===void 0)&&!("isFrozen"in Object&&Object.isFrozen(e)))if(typeof t!="string"&&"length"in t){Mn(typeof i!="string"&&"length"in i);for(var o=0,s=t.length;o<s;++o)Ve(e,t[o],i[o])}else{var c=t.indexOf(".");if(c!==-1){var l=t.substr(0,c),h=t.substr(c+1);if(h==="")i===void 0?ve(e)&&!isNaN(parseInt(l))?e.splice(l,1):delete e[l]:e[l]=i;else{var p=e[l];(!p||!He(e,l))&&(p=e[l]={}),Ve(p,h,i)}}else i===void 0?ve(e)&&!isNaN(parseInt(t))?e.splice(t,1):delete e[t]:e[t]=i}}function Kd(e,t){typeof t=="string"?Ve(e,t,void 0):"length"in t&&[].map.call(t,function(i){Ve(e,i,void 0)})}function qs(e){var t={};for(var i in e)He(e,i)&&(t[i]=e[i]);return t}var Hd=[].concat;function Xs(e){return Hd.apply([],e)}var Wd="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(Xs([8,16,32,64].map(function(e){return["Int","Uint","Float"].map(function(t){return t+e+"Array"})}))).filter(function(e){return Re[e]}),Js=new Set(Wd.map(function(e){return Re[e]}));function Qs(e){var t={};for(var i in e)if(He(e,i)){var o=e[i];t[i]=!o||typeof o!="object"||Js.has(o.constructor)?o:Qs(o)}return t}function zd(e){for(var t in e)if(He(e,t))return!1;return!0}var Ln=null;function Wt(e){Ln=new WeakMap;var t=zi(e);return Ln=null,t}function zi(e){if(!e||typeof e!="object")return e;var t=Ln.get(e);if(t)return t;if(ve(e)){t=[],Ln.set(e,t);for(var i=0,o=e.length;i<o;++i)t.push(zi(e[i]))}else if(Js.has(e.constructor))t=e;else{var s=ln(e);t=s===Object.prototype?{}:Object.create(s),Ln.set(e,t);for(var c in e)He(e,c)&&(t[c]=zi(e[c]))}return t}var Vd={}.toString;function Vi(e){return Vd.call(e).slice(8,-1)}var Gi=typeof Symbol<"u"?Symbol.iterator:"@@iterator",Gd=typeof Gi=="symbol"?function(e){var t;return e!=null&&(t=e[Gi])&&t.apply(e)}:function(){return null};function $t(e,t){var i=e.indexOf(t);return i>=0&&e.splice(i,1),i>=0}var sn={};function mt(e){var t,i,o,s;if(arguments.length===1){if(ve(e))return e.slice();if(this===sn&&typeof e=="string")return[e];if(s=Gd(e)){for(i=[];o=s.next(),!o.done;)i.push(o.value);return i}if(e==null)return[e];if(t=e.length,typeof t=="number"){for(i=new Array(t);t--;)i[t]=e[t];return i}return[e]}for(t=arguments.length,i=new Array(t);t--;)i[t]=arguments[t];return i}var so=typeof Symbol<"u"?function(e){return e[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},Yd=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"],Zs=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],co=Yd.concat(Zs),qd={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function pn(e,t){this.name=e,this.message=t}hn(pn).from(Error).extend({toString:function(){return this.name+": "+this.message}});function ec(e,t){return e+". Errors: "+Object.keys(t).map(function(i){return t[i].toString()}).filter(function(i,o,s){return s.indexOf(i)===o}).join(`
`)}function Lr(e,t,i,o){this.failures=t,this.failedKeys=o,this.successCount=i,this.message=ec(e,t)}hn(Lr).from(pn);function cn(e,t){this.name="BulkError",this.failures=Object.keys(t).map(function(i){return t[i]}),this.failuresByPos=t,this.message=ec(e,this.failures)}hn(cn).from(pn);var uo=co.reduce(function(e,t){return e[t]=t+"Error",e},{}),Xd=pn,Z=co.reduce(function(e,t){var i=t+"Error";function o(s,c){this.name=i,s?typeof s=="string"?(this.message="".concat(s).concat(c?`
 `+c:""),this.inner=c||null):typeof s=="object"&&(this.message="".concat(s.name," ").concat(s.message),this.inner=s):(this.message=qd[t]||i,this.inner=null)}return hn(o).from(Xd),e[t]=o,e},{});Z.Syntax=SyntaxError;Z.Type=TypeError;Z.Range=RangeError;var Cs=Zs.reduce(function(e,t){return e[t+"Error"]=Z[t],e},{});function Jd(e,t){if(!e||e instanceof pn||e instanceof TypeError||e instanceof SyntaxError||!e.name||!Cs[e.name])return e;var i=new Cs[e.name](t||e.message,e);return"stack"in e&&Tt(i,"stack",{get:function(){return this.inner.stack}}),i}var qr=co.reduce(function(e,t){return["Syntax","Type","Range"].indexOf(t)===-1&&(e[t+"Error"]=Z[t]),e},{});qr.ModifyError=Lr;qr.DexieError=pn;qr.BulkError=cn;function de(){}function zn(e){return e}function Qd(e,t){return e==null||e===zn?t:function(i){return t(e(i))}}function zt(e,t){return function(){e.apply(this,arguments),t.apply(this,arguments)}}function Zd(e,t){return e===de?t:function(){var i=e.apply(this,arguments);i!==void 0&&(arguments[0]=i);var o=this.onsuccess,s=this.onerror;this.onsuccess=null,this.onerror=null;var c=t.apply(this,arguments);return o&&(this.onsuccess=this.onsuccess?zt(o,this.onsuccess):o),s&&(this.onerror=this.onerror?zt(s,this.onerror):s),c!==void 0?c:i}}function eh(e,t){return e===de?t:function(){e.apply(this,arguments);var i=this.onsuccess,o=this.onerror;this.onsuccess=this.onerror=null,t.apply(this,arguments),i&&(this.onsuccess=this.onsuccess?zt(i,this.onsuccess):i),o&&(this.onerror=this.onerror?zt(o,this.onerror):o)}}function th(e,t){return e===de?t:function(i){var o=e.apply(this,arguments);Ge(i,o);var s=this.onsuccess,c=this.onerror;this.onsuccess=null,this.onerror=null;var l=t.apply(this,arguments);return s&&(this.onsuccess=this.onsuccess?zt(s,this.onsuccess):s),c&&(this.onerror=this.onerror?zt(c,this.onerror):c),o===void 0?l===void 0?void 0:l:Ge(o,l)}}function nh(e,t){return e===de?t:function(){return t.apply(this,arguments)===!1?!1:e.apply(this,arguments)}}function lo(e,t){return e===de?t:function(){var i=e.apply(this,arguments);if(i&&typeof i.then=="function"){for(var o=this,s=arguments.length,c=new Array(s);s--;)c[s]=arguments[s];return i.then(function(){return t.apply(o,c)})}return t.apply(this,arguments)}}var rt=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function tc(e,t){rt=e}var jn={},nc=100,fo=typeof Promise>"u"?[]:function(){var e=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[e,ln(e),e];var t=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[t,ln(t),e]}(),As=fo[0],Ds=fo[1],rh=fo[2],ih=Ds&&Ds.then,$n=As&&As.constructor,ho=!!rh;function oh(){queueMicrotask(sh)}var Un=function(e,t){Nn.push([e,t]),$r&&(oh(),$r=!1)},Yi=!0,$r=!0,Ut=[],Ar=[],qi=zn,kt={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:de,pgp:!1,env:{},finalize:de},X=kt,Nn=[],Kt=0,Dr=[];function j(e){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var t=this._PSD=X;if(typeof e!="function"){if(e!==jn)throw new TypeError("Not a function");this._state=arguments[1],this._value=arguments[2],this._state===!1&&Ji(this,this._value);return}this._state=null,this._value=null,++t.ref,ic(this,e)}var Xi={get:function(){var e=X,t=Br;function i(o,s){var c=this,l=!e.global&&(e!==X||t!==Br),h=l&&!Pt(),p=new j(function(m,v){po(c,new rc(Rs(o,e,l,h),Rs(s,e,l,h),m,v,e))});return this._consoleTask&&(p._consoleTask=this._consoleTask),p}return i.prototype=jn,i},set:function(e){Tt(this,"then",e&&e.prototype===jn?Xi:{get:function(){return e},set:Xi.set})}};fn(j.prototype,{then:Xi,_then:function(e,t){po(this,new rc(null,null,e,t,X))},catch:function(e){if(arguments.length===1)return this.then(null,e);var t=arguments[0],i=arguments[1];return typeof t=="function"?this.then(null,function(o){return o instanceof t?i(o):Rr(o)}):this.then(null,function(o){return o&&o.name===t?i(o):Rr(o)})},finally:function(e){return this.then(function(t){return j.resolve(e()).then(function(){return t})},function(t){return j.resolve(e()).then(function(){return Rr(t)})})},timeout:function(e,t){var i=this;return e<1/0?new j(function(o,s){var c=setTimeout(function(){return s(new Z.Timeout(t))},e);i.then(o,s).finally(clearTimeout.bind(null,c))}):this}});typeof Symbol<"u"&&Symbol.toStringTag&&Tt(j.prototype,Symbol.toStringTag,"Dexie.Promise");kt.env=ac();function rc(e,t,i,o,s){this.onFulfilled=typeof e=="function"?e:null,this.onRejected=typeof t=="function"?t:null,this.resolve=i,this.reject=o,this.psd=s}fn(j,{all:function(){var e=mt.apply(null,arguments).map(jr);return new j(function(t,i){e.length===0&&t([]);var o=e.length;e.forEach(function(s,c){return j.resolve(s).then(function(l){e[c]=l,--o||t(e)},i)})})},resolve:function(e){if(e instanceof j)return e;if(e&&typeof e.then=="function")return new j(function(i,o){e.then(i,o)});var t=new j(jn,!0,e);return t},reject:Rr,race:function(){var e=mt.apply(null,arguments).map(jr);return new j(function(t,i){e.map(function(o){return j.resolve(o).then(t,i)})})},PSD:{get:function(){return X},set:function(e){return X=e}},totalEchoes:{get:function(){return Br}},newPSD:xt,usePSD:Vt,scheduler:{get:function(){return Un},set:function(e){Un=e}},rejectionMapper:{get:function(){return qi},set:function(e){qi=e}},follow:function(e,t){return new j(function(i,o){return xt(function(s,c){var l=X;l.unhandleds=[],l.onunhandled=c,l.finalize=zt(function(){var h=this;ch(function(){h.unhandleds.length===0?s():c(h.unhandleds[0])})},l.finalize),e()},t,i,o)})}});$n&&($n.allSettled&&Tt(j,"allSettled",function(){var e=mt.apply(null,arguments).map(jr);return new j(function(t){e.length===0&&t([]);var i=e.length,o=new Array(i);e.forEach(function(s,c){return j.resolve(s).then(function(l){return o[c]={status:"fulfilled",value:l}},function(l){return o[c]={status:"rejected",reason:l}}).then(function(){return--i||t(o)})})})}),$n.any&&typeof AggregateError<"u"&&Tt(j,"any",function(){var e=mt.apply(null,arguments).map(jr);return new j(function(t,i){e.length===0&&i(new AggregateError([]));var o=e.length,s=new Array(o);e.forEach(function(c,l){return j.resolve(c).then(function(h){return t(h)},function(h){s[l]=h,--o||i(new AggregateError(s))})})})}));function ic(e,t){try{t(function(i){if(e._state===null){if(i===e)throw new TypeError("A promise cannot be resolved with itself.");var o=e._lib&&mn();i&&typeof i.then=="function"?ic(e,function(s,c){i instanceof j?i._then(s,c):i.then(s,c)}):(e._state=!0,e._value=i,oc(e)),o&&gn()}},Ji.bind(null,e))}catch(i){Ji(e,i)}}function Ji(e,t){if(Ar.push(t),e._state===null){var i=e._lib&&mn();t=qi(t),e._state=!1,e._value=t,uh(e),oc(e),i&&gn()}}function oc(e){var t=e._listeners;e._listeners=[];for(var i=0,o=t.length;i<o;++i)po(e,t[i]);var s=e._PSD;--s.ref||s.finalize(),Kt===0&&(++Kt,Un(function(){--Kt===0&&mo()},[]))}function po(e,t){if(e._state===null){e._listeners.push(t);return}var i=e._state?t.onFulfilled:t.onRejected;if(i===null)return(e._state?t.resolve:t.reject)(e._value);++t.psd.ref,++Kt,Un(ah,[i,e,t])}function ah(e,t,i){try{var o,s=t._value;!t._state&&Ar.length&&(Ar=[]),o=rt&&t._consoleTask?t._consoleTask.run(function(){return e(s)}):e(s),!t._state&&Ar.indexOf(s)===-1&&lh(t),i.resolve(o)}catch(c){i.reject(c)}finally{--Kt===0&&mo(),--i.psd.ref||i.psd.finalize()}}function sh(){Vt(kt,function(){mn()&&gn()})}function mn(){var e=Yi;return Yi=!1,$r=!1,e}function gn(){var e,t,i;do for(;Nn.length>0;)for(e=Nn,Nn=[],i=e.length,t=0;t<i;++t){var o=e[t];o[0].apply(null,o[1])}while(Nn.length>0);Yi=!0,$r=!0}function mo(){var e=Ut;Ut=[],e.forEach(function(o){o._PSD.onunhandled.call(null,o._value,o)});for(var t=Dr.slice(0),i=t.length;i;)t[--i]()}function ch(e){function t(){e(),Dr.splice(Dr.indexOf(t),1)}Dr.push(t),++Kt,Un(function(){--Kt===0&&mo()},[])}function uh(e){Ut.some(function(t){return t._value===e._value})||Ut.push(e)}function lh(e){for(var t=Ut.length;t;)if(Ut[--t]._value===e._value){Ut.splice(t,1);return}}function Rr(e){return new j(jn,!1,e)}function ge(e,t){var i=X;return function(){var o=mn(),s=X;try{return Ct(i,!0),e.apply(this,arguments)}catch(c){t&&t(c)}finally{Ct(s,!1),o&&gn()}}}var Te={awaits:0,echoes:0,id:0},fh=0,Or=[],Fr=0,Br=0,dh=0;function xt(e,t,i,o){var s=X,c=Object.create(s);c.parent=s,c.ref=0,c.global=!1,c.id=++dh,kt.env,c.env=ho?{Promise:j,PromiseProp:{value:j,configurable:!0,writable:!0},all:j.all,race:j.race,allSettled:j.allSettled,any:j.any,resolve:j.resolve,reject:j.reject}:{},t&&Ge(c,t),++s.ref,c.finalize=function(){--this.parent.ref||this.parent.finalize()};var l=Vt(c,e,i,o);return c.ref===0&&c.finalize(),l}function yn(){return Te.id||(Te.id=++fh),++Te.awaits,Te.echoes+=nc,Te.id}function Pt(){return Te.awaits?(--Te.awaits===0&&(Te.id=0),Te.echoes=Te.awaits*nc,!0):!1}(""+ih).indexOf("[native code]")===-1&&(yn=Pt=de);function jr(e){return Te.echoes&&e&&e.constructor===$n?(yn(),e.then(function(t){return Pt(),t},function(t){return Pt(),_e(t)})):e}function hh(e){++Br,(!Te.echoes||--Te.echoes===0)&&(Te.echoes=Te.awaits=Te.id=0),Or.push(X),Ct(e,!0)}function ph(){var e=Or[Or.length-1];Or.pop(),Ct(e,!1)}function Ct(e,t){var i=X;if((t?Te.echoes&&(!Fr++||e!==X):Fr&&(!--Fr||e!==X))&&queueMicrotask(t?hh.bind(null,e):ph),e!==X&&(X=e,i===kt&&(kt.env=ac()),ho)){var o=kt.env.Promise,s=e.env;(i.global||e.global)&&(Object.defineProperty(Re,"Promise",s.PromiseProp),o.all=s.all,o.race=s.race,o.resolve=s.resolve,o.reject=s.reject,s.allSettled&&(o.allSettled=s.allSettled),s.any&&(o.any=s.any))}}function ac(){var e=Re.Promise;return ho?{Promise:e,PromiseProp:Object.getOwnPropertyDescriptor(Re,"Promise"),all:e.all,race:e.race,allSettled:e.allSettled,any:e.any,resolve:e.resolve,reject:e.reject}:{}}function Vt(e,t,i,o,s){var c=X;try{return Ct(e,!0),t(i,o,s)}finally{Ct(c,!1)}}function Rs(e,t,i,o){return typeof e!="function"?e:function(){var s=X;i&&yn(),Ct(t,!0);try{return e.apply(this,arguments)}finally{Ct(s,!1),o&&queueMicrotask(Pt)}}}function Fi(e){Promise===$n&&Te.echoes===0?Fr===0?e():enqueueNativeMicroTask(e):setTimeout(e,0)}var _e=j.reject;function Qi(e,t,i,o){if(!e.idbdb||!e._state.openComplete&&!X.letThrough&&!e._vip){if(e._state.openComplete)return _e(new Z.DatabaseClosed(e._state.dbOpenError));if(!e._state.isBeingOpened){if(!e._state.autoOpen)return _e(new Z.DatabaseClosed);e.open().catch(de)}return e._state.dbReadyPromise.then(function(){return Qi(e,t,i,o)})}else{var s=e._createTransaction(t,i,e._dbSchema);try{s.create(),e._state.PR1398_maxLoop=3}catch(c){return c.name===uo.InvalidState&&e.isOpen()&&--e._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),e.close({disableAutoOpen:!1}),e.open().then(function(){return Qi(e,t,i,o)})):_e(c)}return s._promise(t,function(c,l){return xt(function(){return X.trans=s,o(c,l,s)})}).then(function(c){if(t==="readwrite")try{s.idbtrans.commit()}catch{}return t==="readonly"?c:s._completion.then(function(){return c})})}}var Os="4.0.8",jt="\uFFFF",Zi=-1/0,pt="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",sc="String expected.",un=[],Xr="__dbnames",Mi="readonly",Ni="readwrite";function Gt(e,t){return e?t?function(){return e.apply(this,arguments)&&t.apply(this,arguments)}:e:t}var cc={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function Ir(e){return typeof e=="string"&&!/\./.test(e)?function(t){return t[e]===void 0&&e in t&&(t=Wt(t),delete t[e]),t}:function(t){return t}}function mh(){throw Z.Type()}function se(e,t){try{var i=Fs(e),o=Fs(t);if(i!==o)return i==="Array"?1:o==="Array"?-1:i==="binary"?1:o==="binary"?-1:i==="string"?1:o==="string"?-1:i==="Date"?1:o!=="Date"?NaN:-1;switch(i){case"number":case"Date":case"string":return e>t?1:e<t?-1:0;case"binary":return yh(Ms(e),Ms(t));case"Array":return gh(e,t)}}catch{}return NaN}function gh(e,t){for(var i=e.length,o=t.length,s=i<o?i:o,c=0;c<s;++c){var l=se(e[c],t[c]);if(l!==0)return l}return i===o?0:i<o?-1:1}function yh(e,t){for(var i=e.length,o=t.length,s=i<o?i:o,c=0;c<s;++c)if(e[c]!==t[c])return e[c]<t[c]?-1:1;return i===o?0:i<o?-1:1}function Fs(e){var t=typeof e;if(t!=="object")return t;if(ArrayBuffer.isView(e))return"binary";var i=Vi(e);return i==="ArrayBuffer"?"binary":i}function Ms(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e)}var uc=function(){function e(){}return e.prototype._trans=function(t,i,o){var s=this._tx||X.trans,c=this.name,l=rt&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(t==="readonly"?"read":"write"," ").concat(this.name));function h(v,y,E){if(!E.schema[c])throw new Z.NotFound("Table "+c+" not part of transaction");return i(E.idbtrans,E)}var p=mn();try{var m=s&&s.db._novip===this.db._novip?s===X.trans?s._promise(t,h,o):xt(function(){return s._promise(t,h,o)},{trans:s,transless:X.transless||X}):Qi(this.db,t,[this.name],h);return l&&(m._consoleTask=l,m=m.catch(function(v){return console.trace(v),_e(v)})),m}finally{p&&gn()}},e.prototype.get=function(t,i){var o=this;return t&&t.constructor===Object?this.where(t).first(i):t==null?_e(new Z.Type("Invalid argument to Table.get()")):this._trans("readonly",function(s){return o.core.get({trans:s,key:t}).then(function(c){return o.hook.reading.fire(c)})}).then(i)},e.prototype.where=function(t){if(typeof t=="string")return new this.db.WhereClause(this,t);if(ve(t))return new this.db.WhereClause(this,"[".concat(t.join("+"),"]"));var i=xe(t);if(i.length===1)return this.where(i[0]).equals(t[i[0]]);var o=this.schema.indexes.concat(this.schema.primKey).filter(function(y){if(y.compound&&i.every(function(A){return y.keyPath.indexOf(A)>=0})){for(var E=0;E<i.length;++E)if(i.indexOf(y.keyPath[E])===-1)return!1;return!0}return!1}).sort(function(y,E){return y.keyPath.length-E.keyPath.length})[0];if(o&&this.db._maxKey!==jt){var s=o.keyPath.slice(0,i.length);return this.where(s).equals(s.map(function(y){return t[y]}))}!o&&rt&&console.warn("The query ".concat(JSON.stringify(t)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(i.join("+"),"]"));var c=this.schema.idxByName,l=this.db._deps.indexedDB;function h(y,E){return l.cmp(y,E)===0}var p=i.reduce(function(y,E){var A=y[0],_=y[1],w=c[E],S=t[E];return[A||w,A||!w?Gt(_,w&&w.multi?function(I){var T=gt(I,E);return ve(T)&&T.some(function(P){return h(S,P)})}:function(I){return h(S,gt(I,E))}):_]},[null,null]),m=p[0],v=p[1];return m?this.where(m.name).equals(t[m.keyPath]).filter(v):o?this.filter(v):this.where(i).equals("")},e.prototype.filter=function(t){return this.toCollection().and(t)},e.prototype.count=function(t){return this.toCollection().count(t)},e.prototype.offset=function(t){return this.toCollection().offset(t)},e.prototype.limit=function(t){return this.toCollection().limit(t)},e.prototype.each=function(t){return this.toCollection().each(t)},e.prototype.toArray=function(t){return this.toCollection().toArray(t)},e.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},e.prototype.orderBy=function(t){return new this.db.Collection(new this.db.WhereClause(this,ve(t)?"[".concat(t.join("+"),"]"):t))},e.prototype.reverse=function(){return this.toCollection().reverse()},e.prototype.mapToClass=function(t){var i=this,o=i.db,s=i.name;this.schema.mappedClass=t,t.prototype instanceof mh&&(t=function(p){Ld(m,p);function m(){return p!==null&&p.apply(this,arguments)||this}return Object.defineProperty(m.prototype,"db",{get:function(){return o},enumerable:!1,configurable:!0}),m.prototype.table=function(){return s},m}(t));for(var c=new Set,l=t.prototype;l;l=ln(l))Object.getOwnPropertyNames(l).forEach(function(p){return c.add(p)});var h=function(p){if(!p)return p;var m=Object.create(t.prototype);for(var v in p)if(!c.has(v))try{m[v]=p[v]}catch{}return m};return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=h,this.hook("reading",h),t},e.prototype.defineClass=function(){function t(i){Ge(this,i)}return this.mapToClass(t)},e.prototype.add=function(t,i){var o=this,s=this.schema.primKey,c=s.auto,l=s.keyPath,h=t;return l&&c&&(h=Ir(l)(t)),this._trans("readwrite",function(p){return o.core.mutate({trans:p,type:"add",keys:i!=null?[i]:null,values:[h]})}).then(function(p){return p.numFailures?j.reject(p.failures[0]):p.lastResult}).then(function(p){if(l)try{Ve(t,l,p)}catch{}return p})},e.prototype.update=function(t,i){if(typeof t=="object"&&!ve(t)){var o=gt(t,this.schema.primKey.keyPath);return o===void 0?_e(new Z.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(o).modify(i)}else return this.where(":id").equals(t).modify(i)},e.prototype.put=function(t,i){var o=this,s=this.schema.primKey,c=s.auto,l=s.keyPath,h=t;return l&&c&&(h=Ir(l)(t)),this._trans("readwrite",function(p){return o.core.mutate({trans:p,type:"put",values:[h],keys:i!=null?[i]:null})}).then(function(p){return p.numFailures?j.reject(p.failures[0]):p.lastResult}).then(function(p){if(l)try{Ve(t,l,p)}catch{}return p})},e.prototype.delete=function(t){var i=this;return this._trans("readwrite",function(o){return i.core.mutate({trans:o,type:"delete",keys:[t]})}).then(function(o){return o.numFailures?j.reject(o.failures[0]):void 0})},e.prototype.clear=function(){var t=this;return this._trans("readwrite",function(i){return t.core.mutate({trans:i,type:"deleteRange",range:cc})}).then(function(i){return i.numFailures?j.reject(i.failures[0]):void 0})},e.prototype.bulkGet=function(t){var i=this;return this._trans("readonly",function(o){return i.core.getMany({keys:t,trans:o}).then(function(s){return s.map(function(c){return i.hook.reading.fire(c)})})})},e.prototype.bulkAdd=function(t,i,o){var s=this,c=Array.isArray(i)?i:void 0;o=o||(c?void 0:i);var l=o?o.allKeys:void 0;return this._trans("readwrite",function(h){var p=s.schema.primKey,m=p.auto,v=p.keyPath;if(v&&c)throw new Z.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(c&&c.length!==t.length)throw new Z.InvalidArgument("Arguments objects and keys must have the same length");var y=t.length,E=v&&m?t.map(Ir(v)):t;return s.core.mutate({trans:h,type:"add",keys:c,values:E,wantResults:l}).then(function(A){var _=A.numFailures,w=A.results,S=A.lastResult,I=A.failures,T=l?w:S;if(_===0)return T;throw new cn("".concat(s.name,".bulkAdd(): ").concat(_," of ").concat(y," operations failed"),I)})})},e.prototype.bulkPut=function(t,i,o){var s=this,c=Array.isArray(i)?i:void 0;o=o||(c?void 0:i);var l=o?o.allKeys:void 0;return this._trans("readwrite",function(h){var p=s.schema.primKey,m=p.auto,v=p.keyPath;if(v&&c)throw new Z.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(c&&c.length!==t.length)throw new Z.InvalidArgument("Arguments objects and keys must have the same length");var y=t.length,E=v&&m?t.map(Ir(v)):t;return s.core.mutate({trans:h,type:"put",keys:c,values:E,wantResults:l}).then(function(A){var _=A.numFailures,w=A.results,S=A.lastResult,I=A.failures,T=l?w:S;if(_===0)return T;throw new cn("".concat(s.name,".bulkPut(): ").concat(_," of ").concat(y," operations failed"),I)})})},e.prototype.bulkUpdate=function(t){var i=this,o=this.core,s=t.map(function(h){return h.key}),c=t.map(function(h){return h.changes}),l=[];return this._trans("readwrite",function(h){return o.getMany({trans:h,keys:s,cache:"clone"}).then(function(p){var m=[],v=[];t.forEach(function(E,A){var _=E.key,w=E.changes,S=p[A];if(S){for(var I=0,T=Object.keys(w);I<T.length;I++){var P=T[I],C=w[P];if(P===i.schema.primKey.keyPath){if(se(C,_)!==0)throw new Z.Constraint("Cannot update primary key in bulkUpdate()")}else Ve(S,P,C)}l.push(A),m.push(_),v.push(S)}});var y=m.length;return o.mutate({trans:h,type:"put",keys:m,values:v,updates:{keys:s,changeSpecs:c}}).then(function(E){var A=E.numFailures,_=E.failures;if(A===0)return y;for(var w=0,S=Object.keys(_);w<S.length;w++){var I=S[w],T=l[Number(I)];if(T!=null){var P=_[I];delete _[I],_[T]=P}}throw new cn("".concat(i.name,".bulkUpdate(): ").concat(A," of ").concat(y," operations failed"),_)})})})},e.prototype.bulkDelete=function(t){var i=this,o=t.length;return this._trans("readwrite",function(s){return i.core.mutate({trans:s,type:"delete",keys:t})}).then(function(s){var c=s.numFailures,l=s.lastResult,h=s.failures;if(c===0)return l;throw new cn("".concat(i.name,".bulkDelete(): ").concat(c," of ").concat(o," operations failed"),h)})},e}();function Vn(e){var t={},i=function(h,p){if(p){for(var m=arguments.length,v=new Array(m-1);--m;)v[m-1]=arguments[m];return t[h].subscribe.apply(null,v),e}else if(typeof h=="string")return t[h]};i.addEventType=c;for(var o=1,s=arguments.length;o<s;++o)c(arguments[o]);return i;function c(h,p,m){if(typeof h=="object")return l(h);p||(p=nh),m||(m=de);var v={subscribers:[],fire:m,subscribe:function(y){v.subscribers.indexOf(y)===-1&&(v.subscribers.push(y),v.fire=p(v.fire,y))},unsubscribe:function(y){v.subscribers=v.subscribers.filter(function(E){return E!==y}),v.fire=v.subscribers.reduce(p,m)}};return t[h]=i[h]=v,v}function l(h){xe(h).forEach(function(p){var m=h[p];if(ve(m))c(p,h[p][0],h[p][1]);else if(m==="asap")var v=c(p,zn,function(){for(var E=arguments.length,A=new Array(E);E--;)A[E]=arguments[E];v.subscribers.forEach(function(_){Ys(function(){_.apply(null,A)})})});else throw new Z.InvalidArgument("Invalid event config")})}}function Gn(e,t){return hn(t).from({prototype:e}),t}function vh(e){return Gn(uc.prototype,function(i,o,s){this.db=e,this._tx=s,this.name=i,this.schema=o,this.hook=e._allTables[i]?e._allTables[i].hook:Vn(null,{creating:[Zd,de],reading:[Qd,zn],updating:[th,de],deleting:[eh,de]})})}function on(e,t){return!(e.filter||e.algorithm||e.or)&&(t?e.justLimit:!e.replayFilter)}function Li(e,t){e.filter=Gt(e.filter,t)}function $i(e,t,i){var o=e.replayFilter;e.replayFilter=o?function(){return Gt(o(),t())}:t,e.justLimit=i&&!o}function _h(e,t){e.isMatch=Gt(e.isMatch,t)}function Mr(e,t){if(e.isPrimKey)return t.primaryKey;var i=t.getIndexByKeyPath(e.index);if(!i)throw new Z.Schema("KeyPath "+e.index+" on object store "+t.name+" is not indexed");return i}function Ns(e,t,i){var o=Mr(e,t.schema);return t.openCursor({trans:i,values:!e.keysOnly,reverse:e.dir==="prev",unique:!!e.unique,query:{index:o,range:e.range}})}function kr(e,t,i,o){var s=e.replayFilter?Gt(e.filter,e.replayFilter()):e.filter;if(e.or){var c={},l=function(h,p,m){if(!s||s(p,m,function(E){return p.stop(E)},function(E){return p.fail(E)})){var v=p.primaryKey,y=""+v;y==="[object ArrayBuffer]"&&(y=""+new Uint8Array(v)),He(c,y)||(c[y]=!0,t(h,p,m))}};return Promise.all([e.or._iterate(l,i),Ls(Ns(e,o,i),e.algorithm,l,!e.keysOnly&&e.valueMapper)])}else return Ls(Ns(e,o,i),Gt(e.algorithm,s),t,!e.keysOnly&&e.valueMapper)}function Ls(e,t,i,o){var s=o?function(l,h,p){return i(o(l),h,p)}:i,c=ge(s);return e.then(function(l){if(l)return l.start(function(){var h=function(){return l.continue()};(!t||t(l,function(p){return h=p},function(p){l.stop(p),h=de},function(p){l.fail(p),h=de}))&&c(l.value,l,function(p){return h=p}),h()})})}var rm=Symbol(),bh=function(){function e(t){Object.assign(this,t)}return e.prototype.execute=function(t){var i;if(this.add!==void 0){var o=this.add;if(ve(o))return Nr(Nr([],ve(t)?t:[],!0),o,!0).sort();if(typeof o=="number")return(Number(t)||0)+o;if(typeof o=="bigint")try{return BigInt(t)+o}catch{return BigInt(0)+o}throw new TypeError("Invalid term ".concat(o))}if(this.remove!==void 0){var s=this.remove;if(ve(s))return ve(t)?t.filter(function(l){return!s.includes(l)}).sort():[];if(typeof s=="number")return Number(t)-s;if(typeof s=="bigint")try{return BigInt(t)-s}catch{return BigInt(0)-s}throw new TypeError("Invalid subtrahend ".concat(s))}var c=(i=this.replacePrefix)===null||i===void 0?void 0:i[0];return c&&typeof t=="string"&&t.startsWith(c)?this.replacePrefix[1]+t.substring(c.length):t},e}(),wh=function(){function e(){}return e.prototype._read=function(t,i){var o=this._ctx;return o.error?o.table._trans(null,_e.bind(null,o.error)):o.table._trans("readonly",t).then(i)},e.prototype._write=function(t){var i=this._ctx;return i.error?i.table._trans(null,_e.bind(null,i.error)):i.table._trans("readwrite",t,"locked")},e.prototype._addAlgorithm=function(t){var i=this._ctx;i.algorithm=Gt(i.algorithm,t)},e.prototype._iterate=function(t,i){return kr(this._ctx,t,i,this._ctx.table.core)},e.prototype.clone=function(t){var i=Object.create(this.constructor.prototype),o=Object.create(this._ctx);return t&&Ge(o,t),i._ctx=o,i},e.prototype.raw=function(){return this._ctx.valueMapper=null,this},e.prototype.each=function(t){var i=this._ctx;return this._read(function(o){return kr(i,t,o,i.table.core)})},e.prototype.count=function(t){var i=this;return this._read(function(o){var s=i._ctx,c=s.table.core;if(on(s,!0))return c.count({trans:o,query:{index:Mr(s,c.schema),range:s.range}}).then(function(h){return Math.min(h,s.limit)});var l=0;return kr(s,function(){return++l,!1},o,c).then(function(){return l})}).then(t)},e.prototype.sortBy=function(t,i){var o=t.split(".").reverse(),s=o[0],c=o.length-1;function l(m,v){return v?l(m[o[v]],v-1):m[s]}var h=this._ctx.dir==="next"?1:-1;function p(m,v){var y=l(m,c),E=l(v,c);return y<E?-h:y>E?h:0}return this.toArray(function(m){return m.sort(p)}).then(i)},e.prototype.toArray=function(t){var i=this;return this._read(function(o){var s=i._ctx;if(s.dir==="next"&&on(s,!0)&&s.limit>0){var c=s.valueMapper,l=Mr(s,s.table.core.schema);return s.table.core.query({trans:o,limit:s.limit,values:!0,query:{index:l,range:s.range}}).then(function(p){var m=p.result;return c?m.map(c):m})}else{var h=[];return kr(s,function(p){return h.push(p)},o,s.table.core).then(function(){return h})}},t)},e.prototype.offset=function(t){var i=this._ctx;return t<=0?this:(i.offset+=t,on(i)?$i(i,function(){var o=t;return function(s,c){return o===0?!0:o===1?(--o,!1):(c(function(){s.advance(o),o=0}),!1)}}):$i(i,function(){var o=t;return function(){return--o<0}}),this)},e.prototype.limit=function(t){return this._ctx.limit=Math.min(this._ctx.limit,t),$i(this._ctx,function(){var i=t;return function(o,s,c){return--i<=0&&s(c),i>=0}},!0),this},e.prototype.until=function(t,i){return Li(this._ctx,function(o,s,c){return t(o.value)?(s(c),i):!0}),this},e.prototype.first=function(t){return this.limit(1).toArray(function(i){return i[0]}).then(t)},e.prototype.last=function(t){return this.reverse().first(t)},e.prototype.filter=function(t){return Li(this._ctx,function(i){return t(i.value)}),_h(this._ctx,t),this},e.prototype.and=function(t){return this.filter(t)},e.prototype.or=function(t){return new this.db.WhereClause(this._ctx.table,t,this)},e.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},e.prototype.desc=function(){return this.reverse()},e.prototype.eachKey=function(t){var i=this._ctx;return i.keysOnly=!i.isMatch,this.each(function(o,s){t(s.key,s)})},e.prototype.eachUniqueKey=function(t){return this._ctx.unique="unique",this.eachKey(t)},e.prototype.eachPrimaryKey=function(t){var i=this._ctx;return i.keysOnly=!i.isMatch,this.each(function(o,s){t(s.primaryKey,s)})},e.prototype.keys=function(t){var i=this._ctx;i.keysOnly=!i.isMatch;var o=[];return this.each(function(s,c){o.push(c.key)}).then(function(){return o}).then(t)},e.prototype.primaryKeys=function(t){var i=this._ctx;if(i.dir==="next"&&on(i,!0)&&i.limit>0)return this._read(function(s){var c=Mr(i,i.table.core.schema);return i.table.core.query({trans:s,values:!1,limit:i.limit,query:{index:c,range:i.range}})}).then(function(s){var c=s.result;return c}).then(t);i.keysOnly=!i.isMatch;var o=[];return this.each(function(s,c){o.push(c.primaryKey)}).then(function(){return o}).then(t)},e.prototype.uniqueKeys=function(t){return this._ctx.unique="unique",this.keys(t)},e.prototype.firstKey=function(t){return this.limit(1).keys(function(i){return i[0]}).then(t)},e.prototype.lastKey=function(t){return this.reverse().firstKey(t)},e.prototype.distinct=function(){var t=this._ctx,i=t.index&&t.table.schema.idxByName[t.index];if(!i||!i.multi)return this;var o={};return Li(this._ctx,function(s){var c=s.primaryKey.toString(),l=He(o,c);return o[c]=!0,!l}),this},e.prototype.modify=function(t){var i=this,o=this._ctx;return this._write(function(s){var c;if(typeof t=="function")c=t;else{var l=xe(t),h=l.length;c=function(I){for(var T=!1,P=0;P<h;++P){var C=l[P],k=t[C],D=gt(I,C);k instanceof bh?(Ve(I,C,k.execute(D)),T=!0):D!==k&&(Ve(I,C,k),T=!0)}return T}}var p=o.table.core,m=p.schema.primaryKey,v=m.outbound,y=m.extractKey,E=i.db._options.modifyChunkSize||200,A=[],_=0,w=[],S=function(I,T){var P=T.failures,C=T.numFailures;_+=I-C;for(var k=0,D=xe(P);k<D.length;k++){var M=D[k];A.push(P[M])}};return i.clone().primaryKeys().then(function(I){var T=on(o)&&o.limit===1/0&&(typeof t!="function"||t===Bi)&&{index:o.index,range:o.range},P=function(C){var k=Math.min(E,I.length-C);return p.getMany({trans:s,keys:I.slice(C,C+k),cache:"immutable"}).then(function(D){for(var M=[],N=[],z=v?[]:null,L=[],V=0;V<k;++V){var B=D[V],Q={value:Wt(B),primKey:I[C+V]};c.call(Q,Q.value,Q)!==!1&&(Q.value==null?L.push(I[C+V]):!v&&se(y(B),y(Q.value))!==0?(L.push(I[C+V]),M.push(Q.value)):(N.push(Q.value),v&&z.push(I[C+V])))}return Promise.resolve(M.length>0&&p.mutate({trans:s,type:"add",values:M}).then(function(ie){for(var J in ie.failures)L.splice(parseInt(J),1);S(M.length,ie)})).then(function(){return(N.length>0||T&&typeof t=="object")&&p.mutate({trans:s,type:"put",keys:z,values:N,criteria:T,changeSpec:typeof t!="function"&&t,isAdditionalChunk:C>0}).then(function(ie){return S(N.length,ie)})}).then(function(){return(L.length>0||T&&t===Bi)&&p.mutate({trans:s,type:"delete",keys:L,criteria:T,isAdditionalChunk:C>0}).then(function(ie){return S(L.length,ie)})}).then(function(){return I.length>C+k&&P(C+E)})})};return P(0).then(function(){if(A.length>0)throw new Lr("Error modifying one or more objects",A,_,w);return I.length})})})},e.prototype.delete=function(){var t=this._ctx,i=t.range;return on(t)&&(t.isPrimKey||i.type===3)?this._write(function(o){var s=t.table.core.schema.primaryKey,c=i;return t.table.core.count({trans:o,query:{index:s,range:c}}).then(function(l){return t.table.core.mutate({trans:o,type:"deleteRange",range:c}).then(function(h){var p=h.failures;h.lastResult,h.results;var m=h.numFailures;if(m)throw new Lr("Could not delete some values",Object.keys(p).map(function(v){return p[v]}),l-m);return l-m})})}):this.modify(Bi)},e}(),Bi=function(e,t){return t.value=null};function Eh(e){return Gn(wh.prototype,function(i,o){this.db=e;var s=cc,c=null;if(o)try{s=o()}catch(m){c=m}var l=i._ctx,h=l.table,p=h.hook.reading.fire;this._ctx={table:h,index:l.index,isPrimKey:!l.index||h.schema.primKey.keyPath&&l.index===h.schema.primKey.name,range:s,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:c,or:l.or,valueMapper:p!==zn?p:null}})}function Sh(e,t){return e<t?-1:e===t?0:1}function Ih(e,t){return e>t?-1:e===t?0:1}function ze(e,t,i){var o=e instanceof fc?new e.Collection(e):e;return o._ctx.error=i?new i(t):new TypeError(t),o}function an(e){return new e.Collection(e,function(){return lc("")}).limit(0)}function kh(e){return e==="next"?function(t){return t.toUpperCase()}:function(t){return t.toLowerCase()}}function Th(e){return e==="next"?function(t){return t.toLowerCase()}:function(t){return t.toUpperCase()}}function xh(e,t,i,o,s,c){for(var l=Math.min(e.length,o.length),h=-1,p=0;p<l;++p){var m=t[p];if(m!==o[p])return s(e[p],i[p])<0?e.substr(0,p)+i[p]+i.substr(p+1):s(e[p],o[p])<0?e.substr(0,p)+o[p]+i.substr(p+1):h>=0?e.substr(0,h)+t[h]+i.substr(h+1):null;s(e[p],m)<0&&(h=p)}return l<o.length&&c==="next"?e+i.substr(e.length):l<e.length&&c==="prev"?e.substr(0,i.length):h<0?null:e.substr(0,h)+o[h]+i.substr(h+1)}function Tr(e,t,i,o){var s,c,l,h,p,m,v,y=i.length;if(!i.every(function(w){return typeof w=="string"}))return ze(e,sc);function E(w){s=kh(w),c=Th(w),l=w==="next"?Sh:Ih;var S=i.map(function(I){return{lower:c(I),upper:s(I)}}).sort(function(I,T){return l(I.lower,T.lower)});h=S.map(function(I){return I.upper}),p=S.map(function(I){return I.lower}),m=w,v=w==="next"?"":o}E("next");var A=new e.Collection(e,function(){return Et(h[0],p[y-1]+o)});A._ondirectionchange=function(w){E(w)};var _=0;return A._addAlgorithm(function(w,S,I){var T=w.key;if(typeof T!="string")return!1;var P=c(T);if(t(P,p,_))return!0;for(var C=null,k=_;k<y;++k){var D=xh(T,P,h[k],p[k],l,m);D===null&&C===null?_=k+1:(C===null||l(C,D)>0)&&(C=D)}return S(C!==null?function(){w.continue(C+v)}:I),!1}),A}function Et(e,t,i,o){return{type:2,lower:e,upper:t,lowerOpen:i,upperOpen:o}}function lc(e){return{type:1,lower:e,upper:e}}var fc=function(){function e(){}return Object.defineProperty(e.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),e.prototype.between=function(t,i,o,s){o=o!==!1,s=s===!0;try{return this._cmp(t,i)>0||this._cmp(t,i)===0&&(o||s)&&!(o&&s)?an(this):new this.Collection(this,function(){return Et(t,i,!o,!s)})}catch{return ze(this,pt)}},e.prototype.equals=function(t){return t==null?ze(this,pt):new this.Collection(this,function(){return lc(t)})},e.prototype.above=function(t){return t==null?ze(this,pt):new this.Collection(this,function(){return Et(t,void 0,!0)})},e.prototype.aboveOrEqual=function(t){return t==null?ze(this,pt):new this.Collection(this,function(){return Et(t,void 0,!1)})},e.prototype.below=function(t){return t==null?ze(this,pt):new this.Collection(this,function(){return Et(void 0,t,!1,!0)})},e.prototype.belowOrEqual=function(t){return t==null?ze(this,pt):new this.Collection(this,function(){return Et(void 0,t)})},e.prototype.startsWith=function(t){return typeof t!="string"?ze(this,sc):this.between(t,t+jt,!0,!0)},e.prototype.startsWithIgnoreCase=function(t){return t===""?this.startsWith(t):Tr(this,function(i,o){return i.indexOf(o[0])===0},[t],jt)},e.prototype.equalsIgnoreCase=function(t){return Tr(this,function(i,o){return i===o[0]},[t],"")},e.prototype.anyOfIgnoreCase=function(){var t=mt.apply(sn,arguments);return t.length===0?an(this):Tr(this,function(i,o){return o.indexOf(i)!==-1},t,"")},e.prototype.startsWithAnyOfIgnoreCase=function(){var t=mt.apply(sn,arguments);return t.length===0?an(this):Tr(this,function(i,o){return o.some(function(s){return i.indexOf(s)===0})},t,jt)},e.prototype.anyOf=function(){var t=this,i=mt.apply(sn,arguments),o=this._cmp;try{i.sort(o)}catch{return ze(this,pt)}if(i.length===0)return an(this);var s=new this.Collection(this,function(){return Et(i[0],i[i.length-1])});s._ondirectionchange=function(l){o=l==="next"?t._ascending:t._descending,i.sort(o)};var c=0;return s._addAlgorithm(function(l,h,p){for(var m=l.key;o(m,i[c])>0;)if(++c,c===i.length)return h(p),!1;return o(m,i[c])===0?!0:(h(function(){l.continue(i[c])}),!1)}),s},e.prototype.notEqual=function(t){return this.inAnyRange([[Zi,t],[t,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},e.prototype.noneOf=function(){var t=mt.apply(sn,arguments);if(t.length===0)return new this.Collection(this);try{t.sort(this._ascending)}catch{return ze(this,pt)}var i=t.reduce(function(o,s){return o?o.concat([[o[o.length-1][1],s]]):[[Zi,s]]},null);return i.push([t[t.length-1],this.db._maxKey]),this.inAnyRange(i,{includeLowers:!1,includeUppers:!1})},e.prototype.inAnyRange=function(t,i){var o=this,s=this._cmp,c=this._ascending,l=this._descending,h=this._min,p=this._max;if(t.length===0)return an(this);if(!t.every(function(k){return k[0]!==void 0&&k[1]!==void 0&&c(k[0],k[1])<=0}))return ze(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",Z.InvalidArgument);var m=!i||i.includeLowers!==!1,v=i&&i.includeUppers===!0;function y(k,D){for(var M=0,N=k.length;M<N;++M){var z=k[M];if(s(D[0],z[1])<0&&s(D[1],z[0])>0){z[0]=h(z[0],D[0]),z[1]=p(z[1],D[1]);break}}return M===N&&k.push(D),k}var E=c;function A(k,D){return E(k[0],D[0])}var _;try{_=t.reduce(y,[]),_.sort(A)}catch{return ze(this,pt)}var w=0,S=v?function(k){return c(k,_[w][1])>0}:function(k){return c(k,_[w][1])>=0},I=m?function(k){return l(k,_[w][0])>0}:function(k){return l(k,_[w][0])>=0};function T(k){return!S(k)&&!I(k)}var P=S,C=new this.Collection(this,function(){return Et(_[0][0],_[_.length-1][1],!m,!v)});return C._ondirectionchange=function(k){k==="next"?(P=S,E=c):(P=I,E=l),_.sort(A)},C._addAlgorithm(function(k,D,M){for(var N=k.key;P(N);)if(++w,w===_.length)return D(M),!1;return T(N)?!0:(o._cmp(N,_[w][1])===0||o._cmp(N,_[w][0])===0||D(function(){E===c?k.continue(_[w][0]):k.continue(_[w][1])}),!1)}),C},e.prototype.startsWithAnyOf=function(){var t=mt.apply(sn,arguments);return t.every(function(i){return typeof i=="string"})?t.length===0?an(this):this.inAnyRange(t.map(function(i){return[i,i+jt]})):ze(this,"startsWithAnyOf() only works with strings")},e}();function Ph(e){return Gn(fc.prototype,function(i,o,s){if(this.db=e,this._ctx={table:i,index:o===":id"?null:o,or:s},this._cmp=this._ascending=se,this._descending=function(c,l){return se(l,c)},this._max=function(c,l){return se(c,l)>0?c:l},this._min=function(c,l){return se(c,l)<0?c:l},this._IDBKeyRange=e._deps.IDBKeyRange,!this._IDBKeyRange)throw new Z.MissingAPI})}function nt(e){return ge(function(t){return Kn(t),e(t.target.error),!1})}function Kn(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault()}var Yn="storagemutated",eo="x-storagemutated-1",At=Vn(null,Yn),Ch=function(){function e(){}return e.prototype._lock=function(){return Mn(!X.global),++this._reculock,this._reculock===1&&!X.global&&(X.lockOwnerFor=this),this},e.prototype._unlock=function(){if(Mn(!X.global),--this._reculock===0)for(X.global||(X.lockOwnerFor=null);this._blockedFuncs.length>0&&!this._locked();){var t=this._blockedFuncs.shift();try{Vt(t[1],t[0])}catch{}}return this},e.prototype._locked=function(){return this._reculock&&X.lockOwnerFor!==this},e.prototype.create=function(t){var i=this;if(!this.mode)return this;var o=this.db.idbdb,s=this.db._state.dbOpenError;if(Mn(!this.idbtrans),!t&&!o)switch(s&&s.name){case"DatabaseClosedError":throw new Z.DatabaseClosed(s);case"MissingAPIError":throw new Z.MissingAPI(s.message,s);default:throw new Z.OpenFailed(s)}if(!this.active)throw new Z.TransactionInactive;return Mn(this._completion._state===null),t=this.idbtrans=t||(this.db.core?this.db.core.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}):o.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})),t.onerror=ge(function(c){Kn(c),i._reject(t.error)}),t.onabort=ge(function(c){Kn(c),i.active&&i._reject(new Z.Abort(t.error)),i.active=!1,i.on("abort").fire(c)}),t.oncomplete=ge(function(){i.active=!1,i._resolve(),"mutatedParts"in t&&At.storagemutated.fire(t.mutatedParts)}),this},e.prototype._promise=function(t,i,o){var s=this;if(t==="readwrite"&&this.mode!=="readwrite")return _e(new Z.ReadOnly("Transaction is readonly"));if(!this.active)return _e(new Z.TransactionInactive);if(this._locked())return new j(function(l,h){s._blockedFuncs.push([function(){s._promise(t,i,o).then(l,h)},X])});if(o)return xt(function(){var l=new j(function(h,p){s._lock();var m=i(h,p,s);m&&m.then&&m.then(h,p)});return l.finally(function(){return s._unlock()}),l._lib=!0,l});var c=new j(function(l,h){var p=i(l,h,s);p&&p.then&&p.then(l,h)});return c._lib=!0,c},e.prototype._root=function(){return this.parent?this.parent._root():this},e.prototype.waitFor=function(t){var i=this._root(),o=j.resolve(t);if(i._waitingFor)i._waitingFor=i._waitingFor.then(function(){return o});else{i._waitingFor=o,i._waitingQueue=[];var s=i.idbtrans.objectStore(i.storeNames[0]);(function l(){for(++i._spinCount;i._waitingQueue.length;)i._waitingQueue.shift()();i._waitingFor&&(s.get(-1/0).onsuccess=l)})()}var c=i._waitingFor;return new j(function(l,h){o.then(function(p){return i._waitingQueue.push(ge(l.bind(null,p)))},function(p){return i._waitingQueue.push(ge(h.bind(null,p)))}).finally(function(){i._waitingFor===c&&(i._waitingFor=null)})})},e.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new Z.Abort))},e.prototype.table=function(t){var i=this._memoizedTables||(this._memoizedTables={});if(He(i,t))return i[t];var o=this.schema[t];if(!o)throw new Z.NotFound("Table "+t+" not part of transaction");var s=new this.db.Table(t,o,this);return s.core=this.db.core.table(t),i[t]=s,s},e}();function Ah(e){return Gn(Ch.prototype,function(i,o,s,c,l){var h=this;this.db=e,this.mode=i,this.storeNames=o,this.schema=s,this.chromeTransactionDurability=c,this.idbtrans=null,this.on=Vn(this,"complete","error","abort"),this.parent=l||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new j(function(p,m){h._resolve=p,h._reject=m}),this._completion.then(function(){h.active=!1,h.on.complete.fire()},function(p){var m=h.active;return h.active=!1,h.on.error.fire(p),h.parent?h.parent._reject(p):m&&h.idbtrans&&h.idbtrans.abort(),_e(p)})})}function to(e,t,i,o,s,c,l){return{name:e,keyPath:t,unique:i,multi:o,auto:s,compound:c,src:(i&&!l?"&":"")+(o?"*":"")+(s?"++":"")+dc(t)}}function dc(e){return typeof e=="string"?e:e?"["+[].join.call(e,"+")+"]":""}function go(e,t,i){return{name:e,primKey:t,indexes:i,mappedClass:null,idxByName:Ud(i,function(o){return[o.name,o]})}}function Dh(e){return e.length===1?e[0]:e}var Hn=function(e){try{return e.only([[]]),Hn=function(){return[[]]},[[]]}catch{return Hn=function(){return jt},jt}};function no(e){return e==null?function(){}:typeof e=="string"?Rh(e):function(t){return gt(t,e)}}function Rh(e){var t=e.split(".");return t.length===1?function(i){return i[e]}:function(i){return gt(i,e)}}function $s(e){return[].slice.call(e)}var Oh=0;function Bn(e){return e==null?":id":typeof e=="string"?e:"[".concat(e.join("+"),"]")}function Fh(e,t,i){function o(y,E){var A=$s(y.objectStoreNames);return{schema:{name:y.name,tables:A.map(function(_){return E.objectStore(_)}).map(function(_){var w=_.keyPath,S=_.autoIncrement,I=ve(w),T=w==null,P={},C={name:_.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:T,compound:I,keyPath:w,autoIncrement:S,unique:!0,extractKey:no(w)},indexes:$s(_.indexNames).map(function(k){return _.index(k)}).map(function(k){var D=k.name,M=k.unique,N=k.multiEntry,z=k.keyPath,L=ve(z),V={name:D,compound:L,keyPath:z,unique:M,multiEntry:N,extractKey:no(z)};return P[Bn(z)]=V,V}),getIndexByKeyPath:function(k){return P[Bn(k)]}};return P[":id"]=C.primaryKey,w!=null&&(P[Bn(w)]=C.primaryKey),C})},hasGetAll:A.length>0&&"getAll"in E.objectStore(A[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}}function s(y){if(y.type===3)return null;if(y.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var E=y.lower,A=y.upper,_=y.lowerOpen,w=y.upperOpen,S=E===void 0?A===void 0?null:t.upperBound(A,!!w):A===void 0?t.lowerBound(E,!!_):t.bound(E,A,!!_,!!w);return S}function c(y){var E=y.name;function A(S){var I=S.trans,T=S.type,P=S.keys,C=S.values,k=S.range;return new Promise(function(D,M){D=ge(D);var N=I.objectStore(E),z=N.keyPath==null,L=T==="put"||T==="add";if(!L&&T!=="delete"&&T!=="deleteRange")throw new Error("Invalid operation type: "+T);var V=(P||C||{length:1}).length;if(P&&C&&P.length!==C.length)throw new Error("Given keys array must have same length as given values array.");if(V===0)return D({numFailures:0,failures:{},results:[],lastResult:void 0});var B,Q=[],ie=[],J=0,he=function(O){++J,Kn(O)};if(T==="deleteRange"){if(k.type===4)return D({numFailures:J,failures:ie,results:[],lastResult:void 0});k.type===3?Q.push(B=N.clear()):Q.push(B=N.delete(s(k)))}else{var ke=L?z?[C,P]:[C,null]:[P,null],je=ke[0],Oe=ke[1];if(L)for(var be=0;be<V;++be)Q.push(B=Oe&&Oe[be]!==void 0?N[T](je[be],Oe[be]):N[T](je[be])),B.onerror=he;else for(var be=0;be<V;++be)Q.push(B=N[T](je[be])),B.onerror=he}var Ue=function(O){var G=O.target.result;Q.forEach(function(ee,F){return ee.error!=null&&(ie[F]=ee.error)}),D({numFailures:J,failures:ie,results:T==="delete"?P:Q.map(function(ee){return ee.result}),lastResult:G})};B.onerror=function(O){he(O),Ue(O)},B.onsuccess=Ue})}function _(S){var I=S.trans,T=S.values,P=S.query,C=S.reverse,k=S.unique;return new Promise(function(D,M){D=ge(D);var N=P.index,z=P.range,L=I.objectStore(E),V=N.isPrimaryKey?L:L.index(N.name),B=C?k?"prevunique":"prev":k?"nextunique":"next",Q=T||!("openKeyCursor"in V)?V.openCursor(s(z),B):V.openKeyCursor(s(z),B);Q.onerror=nt(M),Q.onsuccess=ge(function(ie){var J=Q.result;if(!J){D(null);return}J.___id=++Oh,J.done=!1;var he=J.continue.bind(J),ke=J.continuePrimaryKey;ke&&(ke=ke.bind(J));var je=J.advance.bind(J),Oe=function(){throw new Error("Cursor not started")},be=function(){throw new Error("Cursor not stopped")};J.trans=I,J.stop=J.continue=J.continuePrimaryKey=J.advance=Oe,J.fail=ge(M),J.next=function(){var Ue=this,O=1;return this.start(function(){return O--?Ue.continue():Ue.stop()}).then(function(){return Ue})},J.start=function(Ue){var O=new Promise(function(ee,F){ee=ge(ee),Q.onerror=nt(F),J.fail=F,J.stop=function(K){J.stop=J.continue=J.continuePrimaryKey=J.advance=be,ee(K)}}),G=function(){if(Q.result)try{Ue()}catch(ee){J.fail(ee)}else J.done=!0,J.start=function(){throw new Error("Cursor behind last entry")},J.stop()};return Q.onsuccess=ge(function(ee){Q.onsuccess=G,G()}),J.continue=he,J.continuePrimaryKey=ke,J.advance=je,G(),O},D(J)},M)})}function w(S){return function(I){return new Promise(function(T,P){T=ge(T);var C=I.trans,k=I.values,D=I.limit,M=I.query,N=D===1/0?void 0:D,z=M.index,L=M.range,V=C.objectStore(E),B=z.isPrimaryKey?V:V.index(z.name),Q=s(L);if(D===0)return T({result:[]});if(S){var ie=k?B.getAll(Q,N):B.getAllKeys(Q,N);ie.onsuccess=function(je){return T({result:je.target.result})},ie.onerror=nt(P)}else{var J=0,he=k||!("openKeyCursor"in B)?B.openCursor(Q):B.openKeyCursor(Q),ke=[];he.onsuccess=function(je){var Oe=he.result;if(!Oe)return T({result:ke});if(ke.push(k?Oe.value:Oe.primaryKey),++J===D)return T({result:ke});Oe.continue()},he.onerror=nt(P)}})}}return{name:E,schema:y,mutate:A,getMany:function(S){var I=S.trans,T=S.keys;return new Promise(function(P,C){P=ge(P);for(var k=I.objectStore(E),D=T.length,M=new Array(D),N=0,z=0,L,V=function(J){var he=J.target;(M[he._pos]=he.result)!=null,++z===N&&P(M)},B=nt(C),Q=0;Q<D;++Q){var ie=T[Q];ie!=null&&(L=k.get(T[Q]),L._pos=Q,L.onsuccess=V,L.onerror=B,++N)}N===0&&P(M)})},get:function(S){var I=S.trans,T=S.key;return new Promise(function(P,C){P=ge(P);var k=I.objectStore(E),D=k.get(T);D.onsuccess=function(M){return P(M.target.result)},D.onerror=nt(C)})},query:w(p),openCursor:_,count:function(S){var I=S.query,T=S.trans,P=I.index,C=I.range;return new Promise(function(k,D){var M=T.objectStore(E),N=P.isPrimaryKey?M:M.index(P.name),z=s(C),L=z?N.count(z):N.count();L.onsuccess=ge(function(V){return k(V.target.result)}),L.onerror=nt(D)})}}}var l=o(e,i),h=l.schema,p=l.hasGetAll,m=h.tables.map(function(y){return c(y)}),v={};return m.forEach(function(y){return v[y.name]=y}),{stack:"dbcore",transaction:e.transaction.bind(e),table:function(y){var E=v[y];if(!E)throw new Error("Table '".concat(y,"' not found"));return v[y]},MIN_KEY:-1/0,MAX_KEY:Hn(t),schema:h}}function Mh(e,t){return t.reduce(function(i,o){var s=o.create;return ne(ne({},i),s(i))},e)}function Nh(e,t,i,o){var s=i.IDBKeyRange;i.indexedDB;var c=Mh(Fh(t,s,o),e.dbcore);return{dbcore:c}}function Ur(e,t){var i=t.db,o=Nh(e._middlewares,i,e._deps,t);e.core=o.dbcore,e.tables.forEach(function(s){var c=s.name;e.core.schema.tables.some(function(l){return l.name===c})&&(s.core=e.core.table(c),e[c]instanceof e.Table&&(e[c].core=s.core))})}function Kr(e,t,i,o){i.forEach(function(s){var c=o[s];t.forEach(function(l){var h=Vs(l,s);(!h||"value"in h&&h.value===void 0)&&(l===e.Transaction.prototype||l instanceof e.Transaction?Tt(l,s,{get:function(){return this.table(s)},set:function(p){zs(this,s,{value:p,writable:!0,configurable:!0,enumerable:!0})}}):l[s]=new e.Table(s,c))})})}function ro(e,t){t.forEach(function(i){for(var o in i)i[o]instanceof e.Table&&delete i[o]})}function Lh(e,t){return e._cfg.version-t._cfg.version}function $h(e,t,i,o){var s=e._dbSchema;i.objectStoreNames.contains("$meta")&&!s.$meta&&(s.$meta=go("$meta",pc("")[0],[]),e._storeNames.push("$meta"));var c=e._createTransaction("readwrite",e._storeNames,s);c.create(i),c._completion.catch(o);var l=c._reject.bind(c),h=X.transless||X;xt(function(){if(X.trans=c,X.transless=h,t===0)xe(s).forEach(function(p){vo(i,p,s[p].primKey,s[p].indexes)}),Ur(e,i),j.follow(function(){return e.on.populate.fire(c)}).catch(l);else return Ur(e,i),jh(e,c,t).then(function(p){return Uh(e,p,c,i)}).catch(l)})}function Bh(e,t){hc(e._dbSchema,t),t.db.version%10===0&&!t.objectStoreNames.contains("$meta")&&t.db.createObjectStore("$meta").add(Math.ceil(t.db.version/10-1),"version");var i=Jr(e,e.idbdb,t);Wr(e,e._dbSchema,t);for(var o=yo(i,e._dbSchema),s=function(m){if(m.change.length||m.recreate)return console.warn("Unable to patch indexes of table ".concat(m.name," because it has changes on the type of index or primary key.")),{value:void 0};var v=t.objectStore(m.name);m.add.forEach(function(y){rt&&console.debug("Dexie upgrade patch: Creating missing index ".concat(m.name,".").concat(y.src)),Hr(v,y)})},c=0,l=o.change;c<l.length;c++){var h=l[c],p=s(h);if(typeof p=="object")return p.value}}function jh(e,t,i){return t.storeNames.includes("$meta")?t.table("$meta").get("version").then(function(o){return o??i}):j.resolve(i)}function Uh(e,t,i,o){var s=[],c=e._versions,l=e._dbSchema=Jr(e,e.idbdb,o),h=c.filter(function(m){return m._cfg.version>=t});if(h.length===0)return j.resolve();h.forEach(function(m){s.push(function(){var v=l,y=m._cfg.dbschema;Wr(e,v,o),Wr(e,y,o),l=e._dbSchema=y;var E=yo(v,y);E.add.forEach(function(T){vo(o,T[0],T[1].primKey,T[1].indexes)}),E.change.forEach(function(T){if(T.recreate)throw new Z.Upgrade("Not yet support for changing primary key");var P=o.objectStore(T.name);T.add.forEach(function(C){return Hr(P,C)}),T.change.forEach(function(C){P.deleteIndex(C.name),Hr(P,C)}),T.del.forEach(function(C){return P.deleteIndex(C)})});var A=m._cfg.contentUpgrade;if(A&&m._cfg.version>t){Ur(e,o),i._memoizedTables={};var _=qs(y);E.del.forEach(function(T){_[T]=v[T]}),ro(e,[e.Transaction.prototype]),Kr(e,[e.Transaction.prototype],xe(_),_),i.schema=_;var w=so(A);w&&yn();var S,I=j.follow(function(){if(S=A(i),S&&w){var T=Pt.bind(null,null);S.then(T,T)}});return S&&typeof S.then=="function"?j.resolve(S):I.then(function(){return S})}}),s.push(function(v){var y=m._cfg.dbschema;Kh(y,v),ro(e,[e.Transaction.prototype]),Kr(e,[e.Transaction.prototype],e._storeNames,e._dbSchema),i.schema=e._dbSchema}),s.push(function(v){e.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(e.idbdb.version/10)===m._cfg.version?(e.idbdb.deleteObjectStore("$meta"),delete e._dbSchema.$meta,e._storeNames=e._storeNames.filter(function(y){return y!=="$meta"})):v.objectStore("$meta").put(m._cfg.version,"version"))})});function p(){return s.length?j.resolve(s.shift()(i.idbtrans)).then(p):j.resolve()}return p().then(function(){hc(l,o)})}function yo(e,t){var i={del:[],add:[],change:[]},o;for(o in e)t[o]||i.del.push(o);for(o in t){var s=e[o],c=t[o];if(!s)i.add.push([o,c]);else{var l={name:o,def:c,recreate:!1,del:[],add:[],change:[]};if(""+(s.primKey.keyPath||"")!=""+(c.primKey.keyPath||"")||s.primKey.auto!==c.primKey.auto)l.recreate=!0,i.change.push(l);else{var h=s.idxByName,p=c.idxByName,m=void 0;for(m in h)p[m]||l.del.push(m);for(m in p){var v=h[m],y=p[m];v?v.src!==y.src&&l.change.push(y):l.add.push(y)}(l.del.length>0||l.add.length>0||l.change.length>0)&&i.change.push(l)}}}return i}function vo(e,t,i,o){var s=e.db.createObjectStore(t,i.keyPath?{keyPath:i.keyPath,autoIncrement:i.auto}:{autoIncrement:i.auto});return o.forEach(function(c){return Hr(s,c)}),s}function hc(e,t){xe(e).forEach(function(i){t.db.objectStoreNames.contains(i)||(rt&&console.debug("Dexie: Creating missing table",i),vo(t,i,e[i].primKey,e[i].indexes))})}function Kh(e,t){[].slice.call(t.db.objectStoreNames).forEach(function(i){return e[i]==null&&t.db.deleteObjectStore(i)})}function Hr(e,t){e.createIndex(t.name,t.keyPath,{unique:t.unique,multiEntry:t.multi})}function Jr(e,t,i){var o={},s=Yr(t.objectStoreNames,0);return s.forEach(function(c){for(var l=i.objectStore(c),h=l.keyPath,p=to(dc(h),h||"",!0,!1,!!l.autoIncrement,h&&typeof h!="string",!0),m=[],v=0;v<l.indexNames.length;++v){var y=l.index(l.indexNames[v]);h=y.keyPath;var E=to(y.name,h,!!y.unique,!!y.multiEntry,!1,h&&typeof h!="string",!1);m.push(E)}o[c]=go(c,p,m)}),o}function Hh(e,t,i){e.verno=t.version/10;var o=e._dbSchema=Jr(e,t,i);e._storeNames=Yr(t.objectStoreNames,0),Kr(e,[e._allTables],xe(o),o)}function Wh(e,t){var i=Jr(e,e.idbdb,t),o=yo(i,e._dbSchema);return!(o.add.length||o.change.some(function(s){return s.add.length||s.change.length}))}function Wr(e,t,i){for(var o=i.db.objectStoreNames,s=0;s<o.length;++s){var c=o[s],l=i.objectStore(c);e._hasGetAll="getAll"in l;for(var h=0;h<l.indexNames.length;++h){var p=l.indexNames[h],m=l.index(p).keyPath,v=typeof m=="string"?m:"["+Yr(m).join("+")+"]";if(t[c]){var y=t[c].idxByName[v];y&&(y.name=p,delete t[c].idxByName[v],t[c].idxByName[p]=y)}}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&Re.WorkerGlobalScope&&Re instanceof Re.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(e._hasGetAll=!1)}function pc(e){return e.split(",").map(function(t,i){t=t.trim();var o=t.replace(/([&*]|\+\+)/g,""),s=/^\[/.test(o)?o.match(/^\[(.*)\]$/)[1].split("+"):o;return to(o,s||null,/\&/.test(t),/\*/.test(t),/\+\+/.test(t),ve(s),i===0)})}var zh=function(){function e(){}return e.prototype._parseStoresSpec=function(t,i){xe(t).forEach(function(o){if(t[o]!==null){var s=pc(t[o]),c=s.shift();if(c.unique=!0,c.multi)throw new Z.Schema("Primary key cannot be multi-valued");s.forEach(function(l){if(l.auto)throw new Z.Schema("Only primary key can be marked as autoIncrement (++)");if(!l.keyPath)throw new Z.Schema("Index must have a name and cannot be an empty string")}),i[o]=go(o,c,s)}})},e.prototype.stores=function(t){var i=this.db;this._cfg.storesSource=this._cfg.storesSource?Ge(this._cfg.storesSource,t):t;var o=i._versions,s={},c={};return o.forEach(function(l){Ge(s,l._cfg.storesSource),c=l._cfg.dbschema={},l._parseStoresSpec(s,c)}),i._dbSchema=c,ro(i,[i._allTables,i,i.Transaction.prototype]),Kr(i,[i._allTables,i,i.Transaction.prototype,this._cfg.tables],xe(c),c),i._storeNames=xe(c),this},e.prototype.upgrade=function(t){return this._cfg.contentUpgrade=lo(this._cfg.contentUpgrade||de,t),this},e}();function Vh(e){return Gn(zh.prototype,function(i){this.db=e,this._cfg={version:i,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})}function _o(e,t){var i=e._dbNamesDB;return i||(i=e._dbNamesDB=new dn(Xr,{addons:[],indexedDB:e,IDBKeyRange:t}),i.version(1).stores({dbnames:"name"})),i.table("dbnames")}function bo(e){return e&&typeof e.databases=="function"}function Gh(e){var t=e.indexedDB,i=e.IDBKeyRange;return bo(t)?Promise.resolve(t.databases()).then(function(o){return o.map(function(s){return s.name}).filter(function(s){return s!==Xr})}):_o(t,i).toCollection().primaryKeys()}function Yh(e,t){var i=e.indexedDB,o=e.IDBKeyRange;!bo(i)&&t!==Xr&&_o(i,o).put({name:t}).catch(de)}function qh(e,t){var i=e.indexedDB,o=e.IDBKeyRange;!bo(i)&&t!==Xr&&_o(i,o).delete(t).catch(de)}function io(e){return xt(function(){return X.letThrough=!0,e()})}function Xh(){var e=!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent);if(!e||!indexedDB.databases)return Promise.resolve();var t;return new Promise(function(i){var o=function(){return indexedDB.databases().finally(i)};t=setInterval(o,100),o()}).finally(function(){return clearInterval(t)})}var ji;function wo(e){return!("from"in e)}var Ke=function(e,t){if(this)Ge(this,arguments.length?{d:1,from:e,to:arguments.length>1?t:e}:{d:0});else{var i=new Ke;return e&&"d"in e&&Ge(i,e),i}};fn(Ke.prototype,(ji={add:function(e){return zr(this,e),this},addKey:function(e){return Wn(this,e,e),this},addKeys:function(e){var t=this;return e.forEach(function(i){return Wn(t,i,i)}),this},hasKey:function(e){var t=Vr(this).next(e).value;return t&&se(t.from,e)<=0&&se(t.to,e)>=0}},ji[Gi]=function(){return Vr(this)},ji));function Wn(e,t,i){var o=se(t,i);if(!isNaN(o)){if(o>0)throw RangeError();if(wo(e))return Ge(e,{from:t,to:i,d:1});var s=e.l,c=e.r;if(se(i,e.from)<0)return s?Wn(s,t,i):e.l={from:t,to:i,d:1,l:null,r:null},Bs(e);if(se(t,e.to)>0)return c?Wn(c,t,i):e.r={from:t,to:i,d:1,l:null,r:null},Bs(e);se(t,e.from)<0&&(e.from=t,e.l=null,e.d=c?c.d+1:1),se(i,e.to)>0&&(e.to=i,e.r=null,e.d=e.l?e.l.d+1:1);var l=!e.r;s&&!e.l&&zr(e,s),c&&l&&zr(e,c)}}function zr(e,t){function i(o,s){var c=s.from,l=s.to,h=s.l,p=s.r;Wn(o,c,l),h&&i(o,h),p&&i(o,p)}wo(t)||i(e,t)}function Jh(e,t){var i=Vr(t),o=i.next();if(o.done)return!1;for(var s=o.value,c=Vr(e),l=c.next(s.from),h=l.value;!o.done&&!l.done;){if(se(h.from,s.to)<=0&&se(h.to,s.from)>=0)return!0;se(s.from,h.from)<0?s=(o=i.next(h.from)).value:h=(l=c.next(s.from)).value}return!1}function Vr(e){var t=wo(e)?null:{s:0,n:e};return{next:function(i){for(var o=arguments.length>0;t;)switch(t.s){case 0:if(t.s=1,o)for(;t.n.l&&se(i,t.n.from)<0;)t={up:t,n:t.n.l,s:1};else for(;t.n.l;)t={up:t,n:t.n.l,s:1};case 1:if(t.s=2,!o||se(i,t.n.to)<=0)return{value:t.n,done:!1};case 2:if(t.n.r){t.s=3,t={up:t,n:t.n.r,s:0};continue}case 3:t=t.up}return{done:!0}}}}function Bs(e){var t,i,o=(((t=e.r)===null||t===void 0?void 0:t.d)||0)-(((i=e.l)===null||i===void 0?void 0:i.d)||0),s=o>1?"r":o<-1?"l":"";if(s){var c=s==="r"?"l":"r",l=ne({},e),h=e[s];e.from=h.from,e.to=h.to,e[s]=h[s],l[s]=h[c],e[c]=l,l.d=js(l)}e.d=js(e)}function js(e){var t=e.r,i=e.l;return(t?i?Math.max(t.d,i.d):t.d:i?i.d:0)+1}function Qr(e,t){return xe(t).forEach(function(i){e[i]?zr(e[i],t[i]):e[i]=Qs(t[i])}),e}function Eo(e,t){return e.all||t.all||Object.keys(e).some(function(i){return t[i]&&Jh(t[i],e[i])})}var Ht={},Ui={},Ki=!1;function xr(e,t){Qr(Ui,e),Ki||(Ki=!0,setTimeout(function(){Ki=!1;var i=Ui;Ui={},So(i,!1)},0))}function So(e,t){t===void 0&&(t=!1);var i=new Set;if(e.all)for(var o=0,s=Object.values(Ht);o<s.length;o++){var c=s[o];Us(c,e,i,t)}else for(var l in e){var h=/^idb\:\/\/(.*)\/(.*)\//.exec(l);if(h){var p=h[1],m=h[2],c=Ht["idb://".concat(p,"/").concat(m)];c&&Us(c,e,i,t)}}i.forEach(function(v){return v()})}function Us(e,t,i,o){for(var s=[],c=0,l=Object.entries(e.queries.query);c<l.length;c++){for(var h=l[c],p=h[0],m=h[1],v=[],y=0,E=m;y<E.length;y++){var A=E[y];Eo(t,A.obsSet)?A.subscribers.forEach(function(I){return i.add(I)}):o&&v.push(A)}o&&s.push([p,v])}if(o)for(var _=0,w=s;_<w.length;_++){var S=w[_],p=S[0],v=S[1];e.queries.query[p]=v}}function Qh(e){var t=e._state,i=e._deps.indexedDB;if(t.isBeingOpened||e.idbdb)return t.dbReadyPromise.then(function(){return t.dbOpenError?_e(t.dbOpenError):e});t.isBeingOpened=!0,t.dbOpenError=null,t.openComplete=!1;var o=t.openCanceller,s=Math.round(e.verno*10),c=!1;function l(){if(t.openCanceller!==o)throw new Z.DatabaseClosed("db.open() was cancelled")}var h=t.dbReadyResolve,p=null,m=!1,v=function(){return new j(function(y,E){if(l(),!i)throw new Z.MissingAPI;var A=e.name,_=t.autoSchema||!s?i.open(A):i.open(A,s);if(!_)throw new Z.MissingAPI;_.onerror=nt(E),_.onblocked=ge(e._fireOnBlocked),_.onupgradeneeded=ge(function(w){if(p=_.transaction,t.autoSchema&&!e._options.allowEmptyDB){_.onerror=Kn,p.abort(),_.result.close();var S=i.deleteDatabase(A);S.onsuccess=S.onerror=ge(function(){E(new Z.NoSuchDatabase("Database ".concat(A," doesnt exist")))})}else{p.onerror=nt(E);var I=w.oldVersion>Math.pow(2,62)?0:w.oldVersion;m=I<1,e.idbdb=_.result,c&&Bh(e,p),$h(e,I/10,p,E)}},E),_.onsuccess=ge(function(){p=null;var w=e.idbdb=_.result,S=Yr(w.objectStoreNames);if(S.length>0)try{var I=w.transaction(Dh(S),"readonly");if(t.autoSchema)Hh(e,w,I);else if(Wr(e,e._dbSchema,I),!Wh(e,I)&&!c)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),w.close(),s=w.version+1,c=!0,y(v());Ur(e,I)}catch{}un.push(e),w.onversionchange=ge(function(T){t.vcFired=!0,e.on("versionchange").fire(T)}),w.onclose=ge(function(T){e.on("close").fire(T)}),m&&Yh(e._deps,A),y()},E)}).catch(function(y){switch(y?.name){case"UnknownError":if(t.PR1398_maxLoop>0)return t.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),v();break;case"VersionError":if(s>0)return s=0,v();break}return j.reject(y)})};return j.race([o,(typeof navigator>"u"?j.resolve():Xh()).then(v)]).then(function(){return l(),t.onReadyBeingFired=[],j.resolve(io(function(){return e.on.ready.fire(e.vip)})).then(function y(){if(t.onReadyBeingFired.length>0){var E=t.onReadyBeingFired.reduce(lo,de);return t.onReadyBeingFired=[],j.resolve(io(function(){return E(e.vip)})).then(y)}})}).finally(function(){t.openCanceller===o&&(t.onReadyBeingFired=null,t.isBeingOpened=!1)}).catch(function(y){t.dbOpenError=y;try{p&&p.abort()}catch{}return o===t.openCanceller&&e._close(),_e(y)}).finally(function(){t.openComplete=!0,h()}).then(function(){if(m){var y={};e.tables.forEach(function(E){E.schema.indexes.forEach(function(A){A.name&&(y["idb://".concat(e.name,"/").concat(E.name,"/").concat(A.name)]=new Ke(-1/0,[[[]]]))}),y["idb://".concat(e.name,"/").concat(E.name,"/")]=y["idb://".concat(e.name,"/").concat(E.name,"/:dels")]=new Ke(-1/0,[[[]]])}),At(Yn).fire(y),So(y,!0)}return e})}function oo(e){var t=function(l){return e.next(l)},i=function(l){return e.throw(l)},o=c(t),s=c(i);function c(l){return function(h){var p=l(h),m=p.value;return p.done?m:!m||typeof m.then!="function"?ve(m)?Promise.all(m).then(o,s):o(m):m.then(o,s)}}return c(t)()}function Zh(e,t,i){var o=arguments.length;if(o<2)throw new Z.InvalidArgument("Too few arguments");for(var s=new Array(o-1);--o;)s[o-1]=arguments[o];i=s.pop();var c=Xs(s);return[e,c,i]}function mc(e,t,i,o,s){return j.resolve().then(function(){var c=X.transless||X,l=e._createTransaction(t,i,e._dbSchema,o);l.explicit=!0;var h={trans:l,transless:c};if(o)l.idbtrans=o.idbtrans;else try{l.create(),l.idbtrans._explicit=!0,e._state.PR1398_maxLoop=3}catch(y){return y.name===uo.InvalidState&&e.isOpen()&&--e._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),e.close({disableAutoOpen:!1}),e.open().then(function(){return mc(e,t,i,null,s)})):_e(y)}var p=so(s);p&&yn();var m,v=j.follow(function(){if(m=s.call(l,l),m)if(p){var y=Pt.bind(null,null);m.then(y,y)}else typeof m.next=="function"&&typeof m.throw=="function"&&(m=oo(m))},h);return(m&&typeof m.then=="function"?j.resolve(m).then(function(y){return l.active?y:_e(new Z.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):v.then(function(){return m})).then(function(y){return o&&l._resolve(),l._completion.then(function(){return y})}).catch(function(y){return l._reject(y),_e(y)})})}function Pr(e,t,i){for(var o=ve(e)?e.slice():[e],s=0;s<i;++s)o.push(t);return o}function ep(e){return ne(ne({},e),{table:function(t){var i=e.table(t),o=i.schema,s={},c=[];function l(w,S,I){var T=Bn(w),P=s[T]=s[T]||[],C=w==null?0:typeof w=="string"?1:w.length,k=S>0,D=ne(ne({},I),{name:k?"".concat(T,"(virtual-from:").concat(I.name,")"):I.name,lowLevelIndex:I,isVirtual:k,keyTail:S,keyLength:C,extractKey:no(w),unique:!k&&I.unique});if(P.push(D),D.isPrimaryKey||c.push(D),C>1){var M=C===2?w[0]:w.slice(0,C-1);l(M,S+1,I)}return P.sort(function(N,z){return N.keyTail-z.keyTail}),D}var h=l(o.primaryKey.keyPath,0,o.primaryKey);s[":id"]=[h];for(var p=0,m=o.indexes;p<m.length;p++){var v=m[p];l(v.keyPath,0,v)}function y(w){var S=s[Bn(w)];return S&&S[0]}function E(w,S){return{type:w.type===1?2:w.type,lower:Pr(w.lower,w.lowerOpen?e.MAX_KEY:e.MIN_KEY,S),lowerOpen:!0,upper:Pr(w.upper,w.upperOpen?e.MIN_KEY:e.MAX_KEY,S),upperOpen:!0}}function A(w){var S=w.query.index;return S.isVirtual?ne(ne({},w),{query:{index:S.lowLevelIndex,range:E(w.query.range,S.keyTail)}}):w}var _=ne(ne({},i),{schema:ne(ne({},o),{primaryKey:h,indexes:c,getIndexByKeyPath:y}),count:function(w){return i.count(A(w))},query:function(w){return i.query(A(w))},openCursor:function(w){var S=w.query.index,I=S.keyTail,T=S.isVirtual,P=S.keyLength;if(!T)return i.openCursor(w);function C(k){function D(N){N!=null?k.continue(Pr(N,w.reverse?e.MAX_KEY:e.MIN_KEY,I)):w.unique?k.continue(k.key.slice(0,P).concat(w.reverse?e.MIN_KEY:e.MAX_KEY,I)):k.continue()}var M=Object.create(k,{continue:{value:D},continuePrimaryKey:{value:function(N,z){k.continuePrimaryKey(Pr(N,e.MAX_KEY,I),z)}},primaryKey:{get:function(){return k.primaryKey}},key:{get:function(){var N=k.key;return P===1?N[0]:N.slice(0,P)}},value:{get:function(){return k.value}}});return M}return i.openCursor(A(w)).then(function(k){return k&&C(k)})}});return _}})}var tp={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:ep};function Io(e,t,i,o){return i=i||{},o=o||"",xe(e).forEach(function(s){if(!He(t,s))i[o+s]=void 0;else{var c=e[s],l=t[s];if(typeof c=="object"&&typeof l=="object"&&c&&l){var h=Vi(c),p=Vi(l);h!==p?i[o+s]=t[s]:h==="Object"?Io(c,l,i,o+s+"."):c!==l&&(i[o+s]=t[s])}else c!==l&&(i[o+s]=t[s])}}),xe(t).forEach(function(s){He(e,s)||(i[o+s]=t[s])}),i}function ko(e,t){return t.type==="delete"?t.keys:t.keys||t.values.map(e.extractKey)}var np={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(e){return ne(ne({},e),{table:function(t){var i=e.table(t),o=i.schema.primaryKey,s=ne(ne({},i),{mutate:function(c){var l=X.trans,h=l.table(t).hook,p=h.deleting,m=h.creating,v=h.updating;switch(c.type){case"add":if(m.fire===de)break;return l._promise("readwrite",function(){return y(c)},!0);case"put":if(m.fire===de&&v.fire===de)break;return l._promise("readwrite",function(){return y(c)},!0);case"delete":if(p.fire===de)break;return l._promise("readwrite",function(){return y(c)},!0);case"deleteRange":if(p.fire===de)break;return l._promise("readwrite",function(){return E(c)},!0)}return i.mutate(c);function y(_){var w=X.trans,S=_.keys||ko(o,_);if(!S)throw new Error("Keys missing");return _=_.type==="add"||_.type==="put"?ne(ne({},_),{keys:S}):ne({},_),_.type!=="delete"&&(_.values=Nr([],_.values,!0)),_.keys&&(_.keys=Nr([],_.keys,!0)),rp(i,_,S).then(function(I){var T=S.map(function(P,C){var k=I[C],D={onerror:null,onsuccess:null};if(_.type==="delete")p.fire.call(D,P,k,w);else if(_.type==="add"||k===void 0){var M=m.fire.call(D,P,_.values[C],w);P==null&&M!=null&&(P=M,_.keys[C]=P,o.outbound||Ve(_.values[C],o.keyPath,P))}else{var N=Io(k,_.values[C]),z=v.fire.call(D,N,P,k,w);if(z){var L=_.values[C];Object.keys(z).forEach(function(V){He(L,V)?L[V]=z[V]:Ve(L,V,z[V])})}}return D});return i.mutate(_).then(function(P){for(var C=P.failures,k=P.results,D=P.numFailures,M=P.lastResult,N=0;N<S.length;++N){var z=k?k[N]:S[N],L=T[N];z==null?L.onerror&&L.onerror(C[N]):L.onsuccess&&L.onsuccess(_.type==="put"&&I[N]?_.values[N]:z)}return{failures:C,results:k,numFailures:D,lastResult:M}}).catch(function(P){return T.forEach(function(C){return C.onerror&&C.onerror(P)}),Promise.reject(P)})})}function E(_){return A(_.trans,_.range,1e4)}function A(_,w,S){return i.query({trans:_,values:!1,query:{index:o,range:w},limit:S}).then(function(I){var T=I.result;return y({type:"delete",keys:T,trans:_}).then(function(P){return P.numFailures>0?Promise.reject(P.failures[0]):T.length<S?{failures:[],numFailures:0,lastResult:void 0}:A(_,ne(ne({},w),{lower:T[T.length-1],lowerOpen:!0}),S)})})}}});return s}})}};function rp(e,t,i){return t.type==="add"?Promise.resolve([]):e.getMany({trans:t.trans,keys:i,cache:"immutable"})}function gc(e,t,i){try{if(!t||t.keys.length<e.length)return null;for(var o=[],s=0,c=0;s<t.keys.length&&c<e.length;++s)se(t.keys[s],e[c])===0&&(o.push(i?Wt(t.values[s]):t.values[s]),++c);return o.length===e.length?o:null}catch{return null}}var ip={stack:"dbcore",level:-1,create:function(e){return{table:function(t){var i=e.table(t);return ne(ne({},i),{getMany:function(o){if(!o.cache)return i.getMany(o);var s=gc(o.keys,o.trans._cache,o.cache==="clone");return s?j.resolve(s):i.getMany(o).then(function(c){return o.trans._cache={keys:o.keys,values:o.cache==="clone"?Wt(c):c},c})},mutate:function(o){return o.type!=="add"&&(o.trans._cache=null),i.mutate(o)}})}}}};function yc(e,t){return e.trans.mode==="readonly"&&!!e.subscr&&!e.trans.explicit&&e.trans.db._options.cache!=="disabled"&&!t.schema.primaryKey.outbound}function vc(e,t){switch(e){case"query":return t.values&&!t.unique;case"get":return!1;case"getMany":return!1;case"count":return!1;case"openCursor":return!1}}var op={stack:"dbcore",level:0,name:"Observability",create:function(e){var t=e.schema.name,i=new Ke(e.MIN_KEY,e.MAX_KEY);return ne(ne({},e),{transaction:function(o,s,c){if(X.subscr&&s!=="readonly")throw new Z.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(X.querier));return e.transaction(o,s,c)},table:function(o){var s=e.table(o),c=s.schema,l=c.primaryKey,h=c.indexes,p=l.extractKey,m=l.outbound,v=l.autoIncrement&&h.filter(function(_){return _.compound&&_.keyPath.includes(l.keyPath)}),y=ne(ne({},s),{mutate:function(_){var w=_.trans,S=_.mutatedParts||(_.mutatedParts={}),I=function(V){var B="idb://".concat(t,"/").concat(o,"/").concat(V);return S[B]||(S[B]=new Ke)},T=I(""),P=I(":dels"),C=_.type,k=_.type==="deleteRange"?[_.range]:_.type==="delete"?[_.keys]:_.values.length<50?[ko(l,_).filter(function(V){return V}),_.values]:[],D=k[0],M=k[1],N=_.trans._cache;if(ve(D)){T.addKeys(D);var z=C==="delete"||D.length===M.length?gc(D,N):null;z||P.addKeys(D),(z||M)&&ap(I,c,z,M)}else if(D){var L={from:D.lower,to:D.upper};P.add(L),T.add(L)}else T.add(i),P.add(i),c.indexes.forEach(function(V){return I(V.name).add(i)});return s.mutate(_).then(function(V){return D&&(_.type==="add"||_.type==="put")&&(T.addKeys(V.results),v&&v.forEach(function(B){var Q=_.values.map(function(J){return B.extractKey(J)}),ie=B.keyPath.findIndex(function(J){return J===l.keyPath});V.results.forEach(function(J){return Q[ie]=J}),I(B.name).addKeys(Q)})),w.mutatedParts=Qr(w.mutatedParts||{},S),V})}}),E=function(_){var w,S,I=_.query,T=I.index,P=I.range;return[T,new Ke((w=P.lower)!==null&&w!==void 0?w:e.MIN_KEY,(S=P.upper)!==null&&S!==void 0?S:e.MAX_KEY)]},A={get:function(_){return[l,new Ke(_.key)]},getMany:function(_){return[l,new Ke().addKeys(_.keys)]},count:E,query:E,openCursor:E};return xe(A).forEach(function(_){y[_]=function(w){var S=X.subscr,I=!!S,T=yc(X,s)&&vc(_,w),P=T?w.obsSet={}:S;if(I){var C=function(V){var B="idb://".concat(t,"/").concat(o,"/").concat(V);return P[B]||(P[B]=new Ke)},k=C(""),D=C(":dels"),M=A[_](w),N=M[0],z=M[1];if(_==="query"&&N.isPrimaryKey&&!w.values?D.add(z):C(N.name||"").add(z),!N.isPrimaryKey)if(_==="count")D.add(i);else{var L=_==="query"&&m&&w.values&&s.query(ne(ne({},w),{values:!1}));return s[_].apply(this,arguments).then(function(V){if(_==="query"){if(m&&w.values)return L.then(function(J){var he=J.result;return k.addKeys(he),V});var B=w.values?V.result.map(p):V.result;w.values?k.addKeys(B):D.addKeys(B)}else if(_==="openCursor"){var Q=V,ie=w.values;return Q&&Object.create(Q,{key:{get:function(){return D.addKey(Q.primaryKey),Q.key}},primaryKey:{get:function(){var J=Q.primaryKey;return D.addKey(J),J}},value:{get:function(){return ie&&k.addKey(Q.primaryKey),Q.value}}})}return V})}}return s[_].apply(this,arguments)}}),y}})}};function ap(e,t,i,o){function s(c){var l=e(c.name||"");function h(m){return m!=null?c.extractKey(m):null}var p=function(m){return c.multiEntry&&ve(m)?m.forEach(function(v){return l.addKey(v)}):l.addKey(m)};(i||o).forEach(function(m,v){var y=i&&h(i[v]),E=o&&h(o[v]);se(y,E)!==0&&(y!=null&&p(y),E!=null&&p(E))})}t.indexes.forEach(s)}function Ks(e,t,i){if(i.numFailures===0)return t;if(t.type==="deleteRange")return null;var o=t.keys?t.keys.length:"values"in t&&t.values?t.values.length:1;if(i.numFailures===o)return null;var s=ne({},t);return ve(s.keys)&&(s.keys=s.keys.filter(function(c,l){return!(l in i.failures)})),"values"in s&&ve(s.values)&&(s.values=s.values.filter(function(c,l){return!(l in i.failures)})),s}function sp(e,t){return t.lower===void 0?!0:t.lowerOpen?se(e,t.lower)>0:se(e,t.lower)>=0}function cp(e,t){return t.upper===void 0?!0:t.upperOpen?se(e,t.upper)<0:se(e,t.upper)<=0}function Hi(e,t){return sp(e,t)&&cp(e,t)}function Hs(e,t,i,o,s,c){if(!i||i.length===0)return e;var l=t.query.index,h=l.multiEntry,p=t.query.range,m=o.schema.primaryKey,v=m.extractKey,y=l.extractKey,E=(l.lowLevelIndex||l).extractKey,A=i.reduce(function(_,w){var S=_,I=[];if(w.type==="add"||w.type==="put")for(var T=new Ke,P=w.values.length-1;P>=0;--P){var C=w.values[P],k=v(C);if(!T.hasKey(k)){var D=y(C);(h&&ve(D)?D.some(function(L){return Hi(L,p)}):Hi(D,p))&&(T.addKey(k),I.push(C))}}switch(w.type){case"add":S=_.concat(t.values?I:I.map(function(L){return v(L)}));break;case"put":var M=new Ke().addKeys(w.values.map(function(L){return v(L)}));S=_.filter(function(L){return!M.hasKey(t.values?v(L):L)}).concat(t.values?I:I.map(function(L){return v(L)}));break;case"delete":var N=new Ke().addKeys(w.keys);S=_.filter(function(L){return!N.hasKey(t.values?v(L):L)});break;case"deleteRange":var z=w.range;S=_.filter(function(L){return!Hi(v(L),z)});break}return S},e);return A===e?e:(A.sort(function(_,w){return se(E(_),E(w))||se(v(_),v(w))}),t.limit&&t.limit<1/0&&(A.length>t.limit?A.length=t.limit:e.length===t.limit&&A.length<t.limit&&(s.dirty=!0)),c?Object.freeze(A):A)}function Ws(e,t){return se(e.lower,t.lower)===0&&se(e.upper,t.upper)===0&&!!e.lowerOpen==!!t.lowerOpen&&!!e.upperOpen==!!t.upperOpen}function up(e,t,i,o){if(e===void 0)return t!==void 0?-1:0;if(t===void 0)return 1;var s=se(e,t);if(s===0){if(i&&o)return 0;if(i)return 1;if(o)return-1}return s}function lp(e,t,i,o){if(e===void 0)return t!==void 0?1:0;if(t===void 0)return-1;var s=se(e,t);if(s===0){if(i&&o)return 0;if(i)return-1;if(o)return 1}return s}function fp(e,t){return up(e.lower,t.lower,e.lowerOpen,t.lowerOpen)<=0&&lp(e.upper,t.upper,e.upperOpen,t.upperOpen)>=0}function dp(e,t,i,o){var s=Ht["idb://".concat(e,"/").concat(t)];if(!s)return[];var c=s.queries[i];if(!c)return[null,!1,s,null];var l=o.query?o.query.index.name:null,h=c[l||""];if(!h)return[null,!1,s,null];switch(i){case"query":var p=h.find(function(y){return y.req.limit===o.limit&&y.req.values===o.values&&Ws(y.req.query.range,o.query.range)});if(p)return[p,!0,s,h];var m=h.find(function(y){var E="limit"in y.req?y.req.limit:1/0;return E>=o.limit&&(o.values?y.req.values:!0)&&fp(y.req.query.range,o.query.range)});return[m,!1,s,h];case"count":var v=h.find(function(y){return Ws(y.req.query.range,o.query.range)});return[v,!!v,s,h]}}function hp(e,t,i,o){e.subscribers.add(i),o.addEventListener("abort",function(){e.subscribers.delete(i),e.subscribers.size===0&&pp(e,t)})}function pp(e,t){setTimeout(function(){e.subscribers.size===0&&$t(t,e)},3e3)}var mp={stack:"dbcore",level:0,name:"Cache",create:function(e){var t=e.schema.name,i=ne(ne({},e),{transaction:function(o,s,c){var l=e.transaction(o,s,c);if(s==="readwrite"){var h=new AbortController,p=h.signal,m=function(v){return function(){if(h.abort(),s==="readwrite"){for(var y=new Set,E=0,A=o;E<A.length;E++){var _=A[E],w=Ht["idb://".concat(t,"/").concat(_)];if(w){var S=e.table(_),I=w.optimisticOps.filter(function(ie){return ie.trans===l});if(l._explicit&&v&&l.mutatedParts)for(var T=0,P=Object.values(w.queries.query);T<P.length;T++)for(var C=P[T],k=0,D=C.slice();k<D.length;k++){var M=D[k];Eo(M.obsSet,l.mutatedParts)&&($t(C,M),M.subscribers.forEach(function(ie){return y.add(ie)}))}else if(I.length>0){w.optimisticOps=w.optimisticOps.filter(function(ie){return ie.trans!==l});for(var N=0,z=Object.values(w.queries.query);N<z.length;N++)for(var C=z[N],L=0,V=C.slice();L<V.length;L++){var M=V[L];if(M.res!=null&&l.mutatedParts)if(v&&!M.dirty){var B=Object.isFrozen(M.res),Q=Hs(M.res,M.req,I,S,M,B);M.dirty?($t(C,M),M.subscribers.forEach(function(he){return y.add(he)})):Q!==M.res&&(M.res=Q,M.promise=j.resolve({result:Q}))}else M.dirty&&$t(C,M),M.subscribers.forEach(function(he){return y.add(he)})}}}}y.forEach(function(ie){return ie()})}}};l.addEventListener("abort",m(!1),{signal:p}),l.addEventListener("error",m(!1),{signal:p}),l.addEventListener("complete",m(!0),{signal:p})}return l},table:function(o){var s=e.table(o),c=s.schema.primaryKey,l=ne(ne({},s),{mutate:function(h){var p=X.trans;if(c.outbound||p.db._options.cache==="disabled"||p.explicit)return s.mutate(h);var m=Ht["idb://".concat(t,"/").concat(o)];if(!m)return s.mutate(h);var v=s.mutate(h);return(h.type==="add"||h.type==="put")&&(h.values.length>=50||ko(c,h).some(function(y){return y==null}))?v.then(function(y){var E=ne(ne({},h),{values:h.values.map(function(_,w){var S,I=!((S=c.keyPath)===null||S===void 0)&&S.includes(".")?Wt(_):ne({},_);return Ve(I,c.keyPath,y.results[w]),I})}),A=Ks(m,E,y);m.optimisticOps.push(A),queueMicrotask(function(){return h.mutatedParts&&xr(h.mutatedParts)})}):(m.optimisticOps.push(h),h.mutatedParts&&xr(h.mutatedParts),v.then(function(y){if(y.numFailures>0){$t(m.optimisticOps,h);var E=Ks(m,h,y);E&&m.optimisticOps.push(E),h.mutatedParts&&xr(h.mutatedParts)}}),v.catch(function(){$t(m.optimisticOps,h),h.mutatedParts&&xr(h.mutatedParts)})),v},query:function(h){var p;if(!yc(X,s)||!vc("query",h))return s.query(h);var m=((p=X.trans)===null||p===void 0?void 0:p.db._options.cache)==="immutable",v=X,y=v.requery,E=v.signal,A=dp(t,o,"query",h),_=A[0],w=A[1],S=A[2],I=A[3];if(_&&w)_.obsSet=h.obsSet;else{var T=s.query(h).then(function(P){var C=P.result;if(_&&(_.res=C),m){for(var k=0,D=C.length;k<D;++k)Object.freeze(C[k]);Object.freeze(C)}else P.result=Wt(C);return P}).catch(function(P){return I&&_&&$t(I,_),Promise.reject(P)});_={obsSet:h.obsSet,promise:T,subscribers:new Set,type:"query",req:h,dirty:!1},I?I.push(_):(I=[_],S||(S=Ht["idb://".concat(t,"/").concat(o)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}}),S.queries.query[h.query.index.name||""]=I)}return hp(_,I,y,E),_.promise.then(function(P){return{result:Hs(P.result,h,S?.optimisticOps,s,_,m)}})}});return l}});return i}};function Cr(e,t){return new Proxy(e,{get:function(i,o,s){return o==="db"?t:Reflect.get(i,o,s)}})}var dn=function(){function e(t,i){var o=this;this._middlewares={},this.verno=0;var s=e.dependencies;this._options=i=ne({addons:e.addons,autoOpen:!0,indexedDB:s.indexedDB,IDBKeyRange:s.IDBKeyRange,cache:"cloned"},i),this._deps={indexedDB:i.indexedDB,IDBKeyRange:i.IDBKeyRange};var c=i.addons;this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var l={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:de,dbReadyPromise:null,cancelOpen:de,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:i.autoOpen};l.dbReadyPromise=new j(function(p){l.dbReadyResolve=p}),l.openCanceller=new j(function(p,m){l.cancelOpen=m}),this._state=l,this.name=t,this.on=Vn(this,"populate","blocked","versionchange","close",{ready:[lo,de]}),this.on.ready.subscribe=Gs(this.on.ready.subscribe,function(p){return function(m,v){e.vip(function(){var y=o._state;if(y.openComplete)y.dbOpenError||j.resolve().then(m),v&&p(m);else if(y.onReadyBeingFired)y.onReadyBeingFired.push(m),v&&p(m);else{p(m);var E=o;v||p(function A(){E.on.ready.unsubscribe(m),E.on.ready.unsubscribe(A)})}})}}),this.Collection=Eh(this),this.Table=vh(this),this.Transaction=Ah(this),this.Version=Vh(this),this.WhereClause=Ph(this),this.on("versionchange",function(p){p.newVersion>0?console.warn("Another connection wants to upgrade database '".concat(o.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(o.name,"'. Closing db now to resume the delete request.")),o.close({disableAutoOpen:!1})}),this.on("blocked",function(p){!p.newVersion||p.newVersion<p.oldVersion?console.warn("Dexie.delete('".concat(o.name,"') was blocked")):console.warn("Upgrade '".concat(o.name,"' blocked by other connection holding version ").concat(p.oldVersion/10))}),this._maxKey=Hn(i.IDBKeyRange),this._createTransaction=function(p,m,v,y){return new o.Transaction(p,m,v,o._options.chromeTransactionDurability,y)},this._fireOnBlocked=function(p){o.on("blocked").fire(p),un.filter(function(m){return m.name===o.name&&m!==o&&!m._state.vcFired}).map(function(m){return m.on("versionchange").fire(p)})},this.use(ip),this.use(mp),this.use(op),this.use(tp),this.use(np);var h=new Proxy(this,{get:function(p,m,v){if(m==="_vip")return!0;if(m==="table")return function(E){return Cr(o.table(E),h)};var y=Reflect.get(p,m,v);return y instanceof uc?Cr(y,h):m==="tables"?y.map(function(E){return Cr(E,h)}):m==="_createTransaction"?function(){var E=y.apply(this,arguments);return Cr(E,h)}:y}});this.vip=h,c.forEach(function(p){return p(o)})}return e.prototype.version=function(t){if(isNaN(t)||t<.1)throw new Z.Type("Given version is not a positive number");if(t=Math.round(t*10)/10,this.idbdb||this._state.isBeingOpened)throw new Z.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,t);var i=this._versions,o=i.filter(function(s){return s._cfg.version===t})[0];return o||(o=new this.Version(t),i.push(o),i.sort(Lh),o.stores({}),this._state.autoSchema=!1,o)},e.prototype._whenReady=function(t){var i=this;return this.idbdb&&(this._state.openComplete||X.letThrough||this._vip)?t():new j(function(o,s){if(i._state.openComplete)return s(new Z.DatabaseClosed(i._state.dbOpenError));if(!i._state.isBeingOpened){if(!i._state.autoOpen){s(new Z.DatabaseClosed);return}i.open().catch(de)}i._state.dbReadyPromise.then(o,s)}).then(t)},e.prototype.use=function(t){var i=t.stack,o=t.create,s=t.level,c=t.name;c&&this.unuse({stack:i,name:c});var l=this._middlewares[i]||(this._middlewares[i]=[]);return l.push({stack:i,create:o,level:s??10,name:c}),l.sort(function(h,p){return h.level-p.level}),this},e.prototype.unuse=function(t){var i=t.stack,o=t.name,s=t.create;return i&&this._middlewares[i]&&(this._middlewares[i]=this._middlewares[i].filter(function(c){return s?c.create!==s:o?c.name!==o:!1})),this},e.prototype.open=function(){var t=this;return Vt(kt,function(){return Qh(t)})},e.prototype._close=function(){var t=this._state,i=un.indexOf(this);if(i>=0&&un.splice(i,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}t.isBeingOpened||(t.dbReadyPromise=new j(function(o){t.dbReadyResolve=o}),t.openCanceller=new j(function(o,s){t.cancelOpen=s}))},e.prototype.close=function(t){var i=t===void 0?{disableAutoOpen:!0}:t,o=i.disableAutoOpen,s=this._state;o?(s.isBeingOpened&&s.cancelOpen(new Z.DatabaseClosed),this._close(),s.autoOpen=!1,s.dbOpenError=new Z.DatabaseClosed):(this._close(),s.autoOpen=this._options.autoOpen||s.isBeingOpened,s.openComplete=!1,s.dbOpenError=null)},e.prototype.delete=function(t){var i=this;t===void 0&&(t={disableAutoOpen:!0});var o=arguments.length>0&&typeof arguments[0]!="object",s=this._state;return new j(function(c,l){var h=function(){i.close(t);var p=i._deps.indexedDB.deleteDatabase(i.name);p.onsuccess=ge(function(){qh(i._deps,i.name),c()}),p.onerror=nt(l),p.onblocked=i._fireOnBlocked};if(o)throw new Z.InvalidArgument("Invalid closeOptions argument to db.delete()");s.isBeingOpened?s.dbReadyPromise.then(h):h()})},e.prototype.backendDB=function(){return this.idbdb},e.prototype.isOpen=function(){return this.idbdb!==null},e.prototype.hasBeenClosed=function(){var t=this._state.dbOpenError;return t&&t.name==="DatabaseClosed"},e.prototype.hasFailed=function(){return this._state.dbOpenError!==null},e.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(e.prototype,"tables",{get:function(){var t=this;return xe(this._allTables).map(function(i){return t._allTables[i]})},enumerable:!1,configurable:!0}),e.prototype.transaction=function(){var t=Zh.apply(this,arguments);return this._transaction.apply(this,t)},e.prototype._transaction=function(t,i,o){var s=this,c=X.trans;(!c||c.db!==this||t.indexOf("!")!==-1)&&(c=null);var l=t.indexOf("?")!==-1;t=t.replace("!","").replace("?","");var h,p;try{if(p=i.map(function(v){var y=v instanceof s.Table?v.name:v;if(typeof y!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return y}),t=="r"||t===Mi)h=Mi;else if(t=="rw"||t==Ni)h=Ni;else throw new Z.InvalidArgument("Invalid transaction mode: "+t);if(c){if(c.mode===Mi&&h===Ni)if(l)c=null;else throw new Z.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");c&&p.forEach(function(v){if(c&&c.storeNames.indexOf(v)===-1)if(l)c=null;else throw new Z.SubTransaction("Table "+v+" not included in parent transaction.")}),l&&c&&!c.active&&(c=null)}}catch(v){return c?c._promise(null,function(y,E){E(v)}):_e(v)}var m=mc.bind(null,this,h,p,c,o);return c?c._promise(h,m,"lock"):X.trans?Vt(X.transless,function(){return s._whenReady(m)}):this._whenReady(m)},e.prototype.table=function(t){if(!He(this._allTables,t))throw new Z.InvalidTable("Table ".concat(t," does not exist"));return this._allTables[t]},e}(),gp=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",yp=function(){function e(t){this._subscribe=t}return e.prototype.subscribe=function(t,i,o){return this._subscribe(!t||typeof t=="function"?{next:t,error:i,complete:o}:t)},e.prototype[gp]=function(){return this},e}(),Gr;try{Gr={indexedDB:Re.indexedDB||Re.mozIndexedDB||Re.webkitIndexedDB||Re.msIndexedDB,IDBKeyRange:Re.IDBKeyRange||Re.webkitIDBKeyRange}}catch{Gr={indexedDB:null,IDBKeyRange:null}}function vp(e){var t=!1,i,o=new yp(function(s){var c=so(e);function l(I){var T=mn();try{c&&yn();var P=xt(e,I);return c&&(P=P.finally(Pt)),P}finally{T&&gn()}}var h=!1,p,m={},v={},y={get closed(){return h},unsubscribe:function(){h||(h=!0,p&&p.abort(),E&&At.storagemutated.unsubscribe(w))}};s.start&&s.start(y);var E=!1,A=function(){return Fi(S)};function _(){return Eo(v,m)}var w=function(I){Qr(m,I),_()&&A()},S=function(){if(!(h||!Gr.indexedDB)){m={};var I={};p&&p.abort(),p=new AbortController;var T={subscr:I,signal:p.signal,requery:A,querier:e,trans:null},P=l(T);Promise.resolve(P).then(function(C){t=!0,i=C,!(h||T.signal.aborted)&&(m={},v=I,!zd(v)&&!E&&(At(Yn,w),E=!0),Fi(function(){return!h&&s.next&&s.next(C)}))},function(C){t=!1,["DatabaseClosedError","AbortError"].includes(C?.name)||h||Fi(function(){h||s.error&&s.error(C)})})}};return setTimeout(A,0),y});return o.hasValue=function(){return t},o.getValue=function(){return i},o}var Bt=dn;fn(Bt,ne(ne({},qr),{delete:function(e){var t=new Bt(e,{addons:[]});return t.delete()},exists:function(e){return new Bt(e,{addons:[]}).open().then(function(t){return t.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(e){try{return Gh(Bt.dependencies).then(e)}catch{return _e(new Z.MissingAPI)}},defineClass:function(){function e(t){Ge(this,t)}return e},ignoreTransaction:function(e){return X.trans?Vt(X.transless,e):e()},vip:io,async:function(e){return function(){try{var t=oo(e.apply(this,arguments));return!t||typeof t.then!="function"?j.resolve(t):t}catch(i){return _e(i)}}},spawn:function(e,t,i){try{var o=oo(e.apply(i,t||[]));return!o||typeof o.then!="function"?j.resolve(o):o}catch(s){return _e(s)}},currentTransaction:{get:function(){return X.trans||null}},waitFor:function(e,t){var i=j.resolve(typeof e=="function"?Bt.ignoreTransaction(e):e).timeout(t||6e4);return X.trans?X.trans.waitFor(i):i},Promise:j,debug:{get:function(){return rt},set:function(e){tc(e)}},derive:hn,extend:Ge,props:fn,override:Gs,Events:Vn,on:At,liveQuery:vp,extendObservabilitySet:Qr,getByKeyPath:gt,setByKeyPath:Ve,delByKeyPath:Kd,shallowClone:qs,deepClone:Wt,getObjectDiff:Io,cmp:se,asap:Ys,minKey:Zi,addons:[],connections:un,errnames:uo,dependencies:Gr,cache:Ht,semVer:Os,version:Os.split(".").map(function(e){return parseInt(e)}).reduce(function(e,t,i){return e+t/Math.pow(10,i*2)})}));Bt.maxKey=Hn(Bt.dependencies.IDBKeyRange);typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(At(Yn,function(e){if(!It){var t;t=new CustomEvent(eo,{detail:e}),It=!0,dispatchEvent(t),It=!1}}),addEventListener(eo,function(e){var t=e.detail;It||To(t)}));function To(e){var t=It;try{It=!0,At.storagemutated.fire(e),So(e,!0)}finally{It=t}}var It=!1,St,ao=function(){};typeof BroadcastChannel<"u"&&(ao=function(){St=new BroadcastChannel(eo),St.onmessage=function(e){return e.data&&To(e.data)}},ao(),typeof St.unref=="function"&&St.unref(),At(Yn,function(e){It||St.postMessage(e)}));typeof addEventListener<"u"&&(addEventListener("pagehide",function(e){if(!dn.disableBfCache&&e.persisted){rt&&console.debug("Dexie: handling persisted pagehide"),St?.close();for(var t=0,i=un;t<i.length;t++){var o=i[t];o.close({disableAutoOpen:!1})}}}),addEventListener("pageshow",function(e){!dn.disableBfCache&&e.persisted&&(rt&&console.debug("Dexie: handling persisted pageshow"),ao(),To({all:new Ke(-1/0,[[]])}))}));j.rejectionMapper=Jd;tc(rt);var xo=class{getDB(){let t=new dn("FireShotDB");return t.version(1).stores({captures:`
              ++id,
              time,
              url,
              title`,tiles:"++id, parentId"}),t}async createNewEntry(){return await this.getDB().captures.add({time:0})}async addTile(t,i){await this.getDB().tiles.add({parentId:t,blob:i})}async commitEntry(t,i,o,s,c){await this.getDB().captures.update(t,{time:i,url:o,title:s,metadata:c})}async cleanup(){te()("DB cleanup...");let i=await this.getDB().captures.where("time").equals(0).primaryKeys();await this.deleteCaptures(i)}async deleteCaptures(t){let i=this.getDB();await i.tiles.where("parentId").anyOf(t).delete(),await i.captures.bulkDelete(t)}async deleteOlderThanGivenDays(t){te()("Performing database cleanup...");let i=this.getDB(),o=new Date;o.setDate(o.getDate()-t);let s=await i.captures.where("time").below(o).primaryKeys();s.length>0?(console.log(`Removing ${s.length} items`),await this.deleteCaptures(s)):te()("Nothing to do.")}async getCapture(t){try{let i=this.getDB();return{...await i.captures.get(t),tiles:(await i.tiles.where("parentId").equals(t).sortBy("id")).map(o=>o.blob)}}catch(i){return console.error(i),null}}async getAllCaptures(){return await this.getDB().captures.toArray()}},_c=new xo;function bc(e){chrome.tabs.create({url:"fsOptions.html"+(e?"?extras=1":"")})}function wc(e){On(`https://getfireshot.com/buy.php?browser=${Nt()}${e?"&SRC="+e:""}`)}function Ec(){Qe()?(ht()?chrome.windows:chrome.tabs).create({url:"fsNativeInstall.html"}):Zr()}function Zr(){we(H.e,"true"),fe||Po()}function Po(){window.open("https://getfireshot.com/beta-pro.php?browser="+Nt())}function Sc(){}var Ic=function(e,t,i){var o=.75,s=0,c=e,l=t,h=[],p=[],m=[],v=[],y=0,E=1,A=c.width,_=c.height,w,S,I,T;function P(K){p.push(K),y+=K.length+1}function C(K){K?m.unshift(y):m.push(y)}function k(K){P(arguments.length===1?K:Array.prototype.join.call(arguments," "))}function D(K){let q="";for(let Y=0;Y<K.length;++Y){let le=K.charCodeAt(Y).toString(16);le=("000"+le).slice(-4),q+=le}return q}function M(){let K="",q=new Date;return K=new Date(q.valueOf()+(q.getTimezoneOffset()+8*60)*6e4).toISOString().replace(/[-:T]/g,"").slice(0,-4)+"Z",K}function N(){k(`%PDF-1.5\r
%\xFFCaptured and generated by FireShot [https://getfireshot.com]\xFF`)}function z(K,q,Y){C(Y);var le=Y?1:++E,Ee;q&&(Ee="/Length "+q.length);var me=le+` 0 obj\r
<<`+K+(Ee||"")+">>";return k(me),q&&(k("stream"),k(q),k("endstream")),k("endobj"),le}function L(K){return K.toFixed(2)}function V(K){for(var q=K.toString();q.length<10;)q="0"+q;return q}function B(K){return(dt()?"https://getfireshot.com/pdfs_":"https://getfireshot.com/pdf_")+btoa(K)}function Q(){S=z("/Type/Catalog/Pages 1 0 R"),z("/Type/Pages /Kids ["+w+" 0 R] /Count 1",null,!0)}function ie(){I=z(`/CreationDate (D:${M()})/Creator (FireShot Webpage Screenshots (https://getfireshot.com))/Author (FireShot (https://getfireshot.com))/Title <FEFF${D(i)}>`)}function J(){}function he(){T=y,k(`\r
xref\r
0 `+(m.length+1)+`\r
0000000000 65535 f`);for(var K=0;K<m.length;++K)k(V(m[K])+" 00000 n")}function ke(){k(`trailer\r
<</Root `+S+" 0 R /Size "+(m.length+1)+"/Info "+I+` 0 R>>\r
`)}function je(){k(`startxref\r
`+T+`\r
%%EOF\r
`)}function Oe(K,q){var Y=Math.max(0,q[0]),le=_-Math.max(0,q[1]),Ee=Math.min(c.width,q[0]+q[2]),me=_-Math.min(c.height,q[1]+q[3]),Ze=[L(Y*o),L(me*o),L(Ee*o),L(le*o)].join(" ");h.push(z("/Type/Annot/BS<</W "+s+" /S /S>>/C[0 1 0]/Subtype/Link/Rect["+Ze+"]/A "+K+" 0 R"))}function be(K){var q;return v[K]?q=v[K]:(q=z("/Type/Action/S/URI/URI("+K+")"),v[K]=q),q}function Ue(){for(var K in l)l[K].nActionId=be(B(l[K].a))}function O(){if(l.length){Ue();for(var K in l){var q=l[K];for(var Y in q.r)Oe(q.nActionId,q.r[Y])}}}function G(K){var q="/Type /XObject /Subtype /Image /Width "+K.width+" /Height "+K.height+" /ColorSpace /DeviceRGB /BitsPerComponent 8 /Filter /DCTDecode ",Y=atob(K.toDataURL("image/jpeg").replace("data:image/jpeg;base64,",""));return z(q,Y)}function ee(){var q=[],Y="",le=0,Ee=0,me=document.createElement("canvas"),Ze=me.getContext("2d");for(me.width=c.width;le<c.height;)me.height=Math.min(2048,c.height-le),Ze.drawImage(c,0,-le),le+=me.height,Y+="/I"+Ee+" "+G(me)+` 0 R\r
`,q.push(`q\r
1 0 0 1 0 `+L((c.height-le)*o)+` cm\r
`+L(me.width*o)+" 0 0 "+L(me.height*o)+` 0 0 cm\r
/I`+Ee+++` Do\r
Q`);var Se=h.length?"/Annots["+h.join(" 0 R ")+" 0 R]":"",ye=z("/ProcSet[/PDF/ImageC]/XObject<<"+Y+">>"),We=z("",q.join(`\r
`));w=z("/Type/Page/Parent 1 0 R/MediaBox[0 0 "+L(A*o)+" "+L(_*o)+"]/Contents "+We+" 0 R/Resources "+ye+" 0 R"+Se)}function F(){return N(),O(),ee(),Q(),ie(),he(),ke(),je(),p.join(`
`)}return{getBytes:function(){return fe?F():void 0},toDataURL:function(){return"data:application/pdf;base64,"+btoa(F())},toBlob:function(){var K=F();let q=new Array(K.length);for(var Y=0;Y<K.length;Y++)q[Y]=K.charCodeAt(Y);return new Blob([new Uint8Array(q)],{type:"application/pdf"})}}};async function kc(e){let t=-1;async function i(){async function m(v,y){function E(P,C){return new Promise(k=>{fetch(C.data).then(D=>D.blob()).then(D=>{D.name=decodeURIComponent(C.name),P.push(D),k()})})}let A=await chrome.runtime.sendMessage({type:"getAttachments",email:v.User.getEmailAddress()}),_=JSON.parse(A),w=[],S=[],I=[];y.setToRecipients(decodeURIComponent(_.to).split(",")),y.setSubject(decodeURIComponent(_.subject));for(var T=0;T<_.files.length;++T)w.push(E(_.files[T].inline==="yes"?S:I,_.files[T]));await Promise.all(w).then(()=>{S.length>0&&y.attachInlineFiles(S),I.length>0&&(setTimeout(function(){y.attachFiles(I)},1e3),y.getBodyElement().focus())})}InboxSDK.load(2,"sdk_FireShot_c30c6a0127").then(v=>{let y=v.Compose.registerComposeViewHandler(E=>{y(),m(v,E)});v.Compose.openNewComposeView()})}let o=!1;chrome.runtime.onMessage.addListener(function m(v,y,E){y?.tab?.id===t&&(v.type==="inboxsdk__injectPageWorld"&&!o?(o=!0,chrome.scripting.executeScript({target:{tabId:y.tab.id},world:"MAIN",files:["scripts/3p/pageWorld.js"]}),E(!0)):v.type==="getAttachments"&&(chrome.runtime.onMessage.removeListener(m),E(e)))});let s=!1,c=async(m,v,y)=>{!s&&t===m&&v?.status==="complete"&&/^https?:\/\/mail.google.com\/mail.*$/.test(y.url)&&(chrome.tabs.onUpdated.removeListener(c),s=!0,await chrome.scripting.executeScript({target:{tabId:t},files:["scripts/3p/inboxsdk.js"]}),await chrome.scripting.executeScript({target:{tabId:t},func:i}))},l=null,h=async()=>{chrome.tabs.onUpdated.addListener(c),{id:t}=await chrome.tabs.create({url:"https://gmail.com/"})};if(setTimeout(()=>{chrome.tabs.onUpdated.removeListener(c),chrome.tabs.onRemoved.removeListener(l)},5*60*60*1e3),await Ts())h();else{let{id:m}=await chrome.tabs.create({url:"fsGmailPermissions.html"});l=async v=>{v===m&&(te()("Permissions tab closed"),chrome.tabs.onRemoved.removeListener(l),await chrome.permissions.contains({origins:["https://mail.google.com/*"]})?(te()("Gmail permissions granted starting GMail."),h()):te()("Gmail permissions not granted, aborting attachment"))},chrome.tabs.onRemoved.addListener(l)}}var Tc=function(e,t){return new Promise((i,o)=>{try{let s={},c,l,h=m=>{console.error("a worker error occured."),c?c.terminate():document.head.removeChild(l),reportError(m),o(m)},p=async m=>{m.data.message==="loaded"?(h&&((c||l).removeEventListener("error",h),h=void 0),i(s)):m.data.message==="abort"?(reportError(m.data.data),t({data:{message:"completed",result:null}})):t(m)};if(re(H.oe,"false")!=="true"&&typeof OffscreenCanvas<"u")s.postMessage=(m,v)=>{m.message==="terminate"?c.terminate():c.postMessage(m,v)},c=new Worker(e),c.addEventListener("error",h,!1),c.addEventListener("message",p,!1);else{let m={msgs:[],host:p};window.fsWorkerConnection=m,l=document.createElement("script"),l.addEventListener("error",h,!1),s.postMessage=v=>{m.worker?setTimeout(()=>m.worker({data:v},10)):m.msgs.push(v)},l.async=!0,l.src=e,document.head.appendChild(l)}}catch(s){reportError(s),o(s)}})};_s();var xc=!1,Ac,Ao,Dc,Xn,Jn,ei,qn,Rc,Ye,Yt,vn,Qn={},Pc,it,Co,Cc=-1;window.addEventListener("load",async()=>{let e="showAlert1",t="#";function i(){Qe()?(tt()||$("#upgradeLink,#noflashgoadvanced,#noflashgoadvanced2,#noflashgoadvanced3,#divPDFFeatures").removeClass("hiddenInitially"),$("#divWinPromo").show(),$("#divNonWinPromo").hide()):($("#divWinPromo").hide(),$("#divNonWinPromo").show()),br()?$("#lnkOperaStore").hide():wr()?$("#lnkEdgeNew").hide():dt()?$("#lnkSafariStore").hide():ht()?($("#lnkAmo").hide(),$("#divEmail").hide()):$("#lnkChromeStore").hide(),$("a[href*='APPID']").each(function(){this.href=this.href.replace("APPID",Nt())}),Qn.UUID=re(H._),Qn.Serial=re(H.c),$("#lnkProblem, #lnkProblemBetaPreview, #lnkProblemPDF").attr("href","https://getfireshot.com/report-problem.php?u="+btoa(Xn)+"&browser="+Nt()+"&ver="+Xe().extVersionFull+"&d="+btoa(JSON.stringify(Qn))),y();let O=tt();$("#btnPDFOptionsForGmail").toggle(O),$("#pdfCaret").toggle(!O),$("#pdfSettings").toggle(O)}async function o(O){let G=O==="png"?"image/png":"image/jpeg";if(Ye.length===1&&Ye[0].type===G)return Ye[0];let ee=setTimeout(()=>$("#divProcessing").slideDown(200),200),F=Math.min(H.D/Yt,O==="png"?65535:65500,vn),q=await(await s(0,F)).convertToBlob({type:G});return clearTimeout(ee),$("#divProcessing").slideUp(10),q}async function s(O,G){te()(`getCanvasFromBlobs(${G})`);let ee=new OffscreenCanvas(Yt,G),F=ee.getContext("2d",{alpha:!1,willReadFrequently:!1}),K=0,q=0;for(;K<G&&Ye[q];){let Y=await createImageBitmap(Ye[q++]);F.drawImage(Y,0,K),K+=Y.height}return ee}async function c(){let O=Math.min(H.D/Yt,65535,vn),G=setTimeout(()=>$("#divProcessing").slideDown(200),200),ee=await s(0,O),F=new Ic(ee,Ao,Jn);return clearTimeout(G),$("#divProcessing").slideUp(10),F}function l(){k(async()=>tt()?(wt("UA-1025658-9","fireshot.com","PDF-Pro-Created"),A()):(await c()).toBlob(),qn+".pdf")}function h(){let O=re(H.pe,"png");k(()=>o(O),qn+"."+O)}function p(){$("#lnkOptions, #btnOptions").click(()=>(bc(!0),!1)),$("#advancedInstructionsPreDialog").on("hidden.bs.modal",Ec),$("#lnkInstallAdvancedTop-1, #lnkInstallAdvancedTop-2, #lnkUpgradeFromPDF, #lnkInstallAdvanced, #lnkInstallAdvanced1, #lnkInstallAdvancedClipboardDlg").click(function(){return Qe()?$("#advancedInstructionsPreDialog").modal():(Zr(),i()),!1}),$("#btnCloseAlert1").click(function(){we(e,0)}),$("#btnSaveImage").click(h),$("#btnSaveImagePDF").click(l),$("#btnSendEmail").find("li").click(function(){return $("#btnGmail").dropdown("toggle"),_(),T($(this).attr("value")),!1}),$("#btnClipboard").click(I),$("#btnPrint").click(function(){w(),_()}),$("#lnkPdfSettings").click(O=>(O.stopPropagation(),E(),!1)),$("#pdfCaret").click(O=>{O.stopPropagation(),$("#ddControl").dropdown("toggle")}),$("#menuPDFFeatures").find("li").click(O=>{O.stopPropagation();let G=document.getElementById("menuPDFFeatures").getBoundingClientRect();return $("#divUpgradeMsg").css({"min-width":G.width+"px",height:G.height+"px"}),$("#divUpgradeMsg").fadeIn(200),!1}),$("#menuPDFFeatures").parent().on("hide.bs.dropdown",()=>$("#divUpgradeMsg").hide()),$("#btnCloseAdvancedTopMsg").click(()=>{we(H.L,new Date().getTime()+864e6),$("#divCanBeBetterPromo").fadeOut(300)}),$("#btnCloseAdvertising").click(()=>{$("#divAdvertising").hide()}),$("#lnkAdPromo").click(()=>(On(t),!1)),$("#lnkTest1").click(()=>{}),$("#lnkTest2").click(()=>{}),$("#lnkTest3").click(()=>{}),$("#btnHidePreviewWarning").click(()=>(m(!1),!1)),$("#divPreviewWarning").click(()=>{m(!0)}),$("#lnkDisableBetaPreview").click(()=>(we(H.e,"false"),i(),setTimeout(()=>$("#divBackToLiteWarning").fadeIn(300),300),setTimeout(()=>$("#divBackToLiteWarning").fadeOut(900),4e3),wt("UA-1025658-9","fireshot.com","BetaPreviewCanceled"),!1)),$("#btnEnableBetaPreview, #btnEnableBetaPreview-1, #btnEnableBetaPreview-2").click(()=>{Zr(),setTimeout(i,200)}),$("#btnPDFOptionsForGmail").click(O=>(O.stopPropagation(),E(),!0)),$("#lnkBetaProgramConditions, #lnkBetaProgramConditions-1").click(()=>(Po(),!1)),$("#btnCompactBPPromo, #lnkExpandBPPromo").click(O=>{we(H.W,O.currentTarget.id==="btnCompactBPPromo"),i()}),$("#lnkRemoveAdv").click(()=>(B(),!1)),dt()&&$('a[target="_blank"]').click(function(){if($(this).attr("href")&&$(this).attr("href")!=="#")return window.open($(this).attr("href")),!1}),$("#lnkBuyPro").click(()=>(wc(),!1)),$("#spnOpenInFinder").click(O=>{O.stopPropagation()}),$("#divDownloadedInfoText").click(Sc)}function m(O){we(H.H,O),i()}function v(){return!Qe()&&tt()&&!Ri()}function y(){let O=re(H.H,"true")==="true";v()?($("#divPreviewWarning").removeClass("hiddenInitially"),$("#divCanBeBetterPromo, #divLimitedSavingFunctionality").hide(),O?$("#divPreviewWarning").removeClass("warningCollapsed"):$("#divPreviewWarning").addClass("warningCollapsed")):$("#divPreviewWarning").addClass("hiddenInitially"),(Qe()||tt())&&$("#divBetaPromo").addClass("hiddenInitially"),re(H.W)==="true"?($("#divBPFull").slideUp(300),$("#divBPBrief").slideDown(300)):($("#divBPBrief").hide(),$("#divBPFull").slideDown(300))}function E(){return wt("UA-1025658-9","fireshot.com","PDF-Pro-Settings"),new Promise(O=>{let G=function(ee,F,K,q,Y){return{title:ee,URL:F,created:K,extents:{cx:q,cy:Y}}};PDFDialog.templateVars=new G(Jn,Xn,ei,Yt,vn),PDFDialog.preferences=bt,PDFDialog.show(!1).then(ee=>{ee&&we(H.z,"true"),O(ee)})})}function A(){return!it&&re(H.z,"false")==="false"?E().then(O=>O?ke(!1):void 0):ke(!1)}function _(){(it||re(H.N)==="true")&&window.close()}function w(){document.querySelectorAll("div").forEach(G=>{G.classList.add("noPrint")});let O=document.getElementById("divImgResult");for(;O;)O.classList.remove("noPrint"),O=O.parentElement;if(!tt()){let G=65536;for(let ee of document.getElementById("divImgResult").childNodes)G<=0?ee.classList.add("noPrint"):G-=ee.naturalHeight}print(),document.querySelectorAll(".noPrint").forEach(G=>{G.classList.remove("noPrint")})}function S(){$("#divErrorMessage").slideDown(200)}async function I(){try{let O=await o("png"),G=new ClipboardItem(Object.defineProperty({},O.type,{value:O,enumerable:!0}));await navigator.clipboard.write([G]),$("#divDownloadedInfo").slideUp(10),$("#divClipboardMessage").slideDown(200),setTimeout(()=>$("#divClipboardMessage").slideUp(100),2e3),re(H.N)==="true"&&setTimeout(_,500)}catch(O){te()(O),$("#modalCopyToClipboard").modal()}}async function T(O){let G=null,ee=q=>new Promise(Y=>{let le=new FileReader;le.onloadend=()=>{Y(le.result)},le.readAsDataURL(q)});switch(O){case"png":case"jpg":G=await ee(await o(O));break;default:{if(tt()){let q=await A();if(!q||q.size===0){S();return}G=await ee(q)}else G=(await c()).toDataURL();O="pdf"}}let F=qn+"."+O,K={to:"",subject:"Screenshots from FireShot",files:[{inline:"no",name:encodeURIComponent(F),data:G}]};setTimeout(()=>kc(JSON.stringify(K)),200)}function P(O,G,ee){}var C;function k(O,G,ee){let F=/^\/*(.*?)\/*$/g.exec(re(H.ce,H.ue))[1];F!==""&&(F+="/"),it&&Co&&(F+=decodeURI(Co)+"/"),dt()?void 0:ks(()=>{xc||(xc=!0,chrome.downloads.onChanged.addListener(K=>{!C||!K.state||K.state.current!="complete"||C!=K.id||(it?Si().onFileSavedEvent(Cc,C):re(H.le)==="true"&&chrome.downloads.show(C),_())})),O().then(async K=>{if(!K||K.size===0){S();return}await Si().addOnDeterminingFilenameHandler(ee?G:F+G);let Y=URL.createObjectURL(K);chrome.downloads.download({url:Y,saveAs:!it&&re(H.fe)!=="true",filename:ht()?F+G:void 0,conflictAction:"overwrite"},le=>{URL.revokeObjectURL(Y),chrome.runtime.lastError?!ee&&!ht()&&k(O,G,!0):C=le})})})}function D(){On("https://getfireshot.com/like.php?browser="+Nt()+"&ver="+Xe().extVersion)}function M(){$("#btnLike #btnDislike").unbind(),$("#btnLike").click(function(){we(H.b,"true"),$("#divLikeMessage").hide(),ie()}),$("#btnDislike").click(function(){we(H.b,"false"),$("#divLikeMessage").slideUp(100)}),setTimeout(function(){$("#divLikeMessage").slideDown(300)},2e3)}function N(){return parseInt(re(H.L,"0"))<=new Date().getTime()?(setTimeout(()=>$("#divCanBeBetterPromo").slideDown(300),fe?0:2e3),!0):!1}function z(){return setTimeout(()=>$("#divLimitedSavingFunctionality").slideDown(300),fe?0:2e3),!0}function L(){setTimeout(()=>$("#divAdvertising").slideDown(700),2e3)}function V(){if(fe)return;new Date().getTime()>re(H.K,0)&&(tt()||v())&&(document.getElementById("iframeAdv").src="https://ssl.getfireshot.com/carbon/index.html",window.addEventListener("message",G=>{switch(G.data.msg){case"loaded":wt("UA-1025658-9","Ads","AdLoaded"),$("#divAdv,#divAdvHelper").removeClass("hiddenInitially"),$("#pageHeader").addClass("hiddenWhenAdShown");break;case"logAction":we(H.K,new Date().getTime()+G.data.id);break;case"logClicked":wt("UA-1025658-9","Ads","AdClicked");break}},!1))}function B(){document.getElementById("framePromo").src="fsPromoDialog.html?context=ads",setTimeout(()=>{document.getElementById("modalPromo").showModal(),document.getElementById("modalPromo").addEventListener("click",O=>O.target.close())},100)}function Q(){document.getElementById("framePromo").src="fsPromoDialog.html?context=history&persistent=true",document.addEventListener("keydown",O=>O.preventDefault()),setTimeout(()=>{document.getElementById("modalPromo").showModal()},100)}function ie(){$("#btnRate #btnRateLater").unbind(),$("#btnRate").click(function(){we(H.U,"true"),$("#divSendReview").slideUp(100),D()}),$("#btnRateLater").click(function(){$("#divSendReview").slideUp(100)}),setTimeout(function(){$("#divSendReview").slideDown(300)},200)}function J(){if(Qe()&&re(H.e,"")!==""&&!Di()&&re(e,"")==="")setTimeout(function(){$("#divAlert1").fadeIn(700)},1e3);else{var O=re(H.b,"")==="true",G=re(H.b,"")!=="",ee=re(H.U,"false")==="true",F=parseInt(re(H.T,0));!G&&F>10?M():O&&!ee&&F%50===0&&ie()}}function he(){function O(){let Y=document.getElementById("divImgResult"),le=20,Ee=Y.getClientRects()[0],me=document.getElementById("divPanel").getClientRects()[0];Ee&&(Ee.y+Ee.height<me.y?($("#divImgResult").height($("#divPanel").height()),$("#divImgResult").css("overflow-y",Y.clientHeight<Y.scrollHeight?"scroll":"hidden"),$("#divPanel").width($("#divImgResult").width())):($("#divImgResult").height("auto"),$("#divPanel").width($("#divContainer").width()-$("#divImgResult").width()-40)),Yt<$(Y).width()-le?($("canvas.canvasCell").css("width","auto"),$("#divImgResult").css("overflow-y",Y.clientHeight<Y.scrollHeight?"scroll":"hidden"),Y.style.zoom=1.0000001,setTimeout(function(){Y.style.zoom=1},50)):Y.clientHeight>=Y.scrollHeight&&($(Y).css("overflow-y","hidden"),$("canvas.canvasCell").css("width",""),Y.style.zoom=1.0000001,setTimeout(function(){Y.style.zoom=1},50)))}function G(){$("#divLeftCol").offset().top-15<window.scrollY&&$("#divImgResult").height()>$("#divPanel").height()&&$("#divPanel").height()<window.innerHeight?($("#divPanel").addClass("fixed"),$("#divPanel").css({top:"15px"})):$("#divPanel").removeClass("fixed")}let ee=re(H.i,1),F=!1,K=!F&&ee%5===0;F?$("#lnkSiteIndex").css("opacity","1"):setTimeout(function(){$("#lnkSiteIndex").addClass("splashIn")},K?1800:1e3),tt()||(Pc?z():(!Rc||!N())&&(Qe()?F?L():K?setTimeout(()=>$("#divPromo").slideDown(300),1e3):$("#divPromo").show():$("#divBetaPromo").removeClass("hiddenInitially"))),document.title=qn,window.addEventListener("resize",Oi(O)),window.addEventListener("scroll",Oi(G));let q=(Y,le)=>new Promise(Ee=>{let me=new Image;me.className="canvasCell",document.getElementById("divImgResult").appendChild(me);let Ze=URL.createObjectURL(Y);me.src=Ze,me.onload=function(){le&&(me.onload=null,setTimeout(()=>{let Se=new FileReader;Se.readAsDataURL(Y),Se.onloadend=function(){let ye=Se.result;me.src=ye}},100)),te()(`Loaded image tile [${this.width}, ${this.height}]`),Ee()}});fe&&Er("pageInit"),Promise.all(Ye.map(Y=>q(Y,Ye[0]===Y))).then(()=>{let Y=document.getElementById("divImgResult");Y.childNodes.length>0&&(Y.childNodes[0].id="imgResult"),fe&&Sr("pageInit"),setTimeout(O,10),$("#divPreload").hide(),$("#divContainer").show(),$("#divPreviewWarningContainer").show();})}function ke(O){function G(ee){ProgressBar.percentage=ee,it&&(document.title=`[${Math.round(ee)}%] ${chrome.i18n.getMessage("label_processing")}`)}return new Promise(ee=>{let q=vn,Y=Yt;q/1500>2&&(G(0),ProgressBar.visible=!0);let le=re("pdfSettings"+(O?"multi":"")),Ee=re("header"),me=re("footer"),Ze=re("watermark");G(5);let Se=0,ye=0,We=null,qt=null;async function*_n(Ne){Ne.postMessage({message:"init",width:Y,height:q,URL:Xn,title:Jn,created:ei,pdfSettings:le,headerSettings:Ee,footerSettings:me,wmSettings:Ze});let Dt=0;for(let Zn of Ye){let Rt=await createImageBitmap(Zn),ot=new OffscreenCanvas(Rt.width,Rt.height),Le=ot.getContext("2d",{alpha:!1,willReadFrequently:!0});Le.drawImage(Rt,0,0),Rt.close();let at=0;for(;at<ot.height;){let Xt=Math.min(1500,ot.height-at),er=Le.getImageData(0,at,ot.width,Xt);Ne.postMessage({message:"blit",dstX:0,dstY:Dt+at,dstW:ot.width,dstH:Xt,imageData:er.data,bufWidth:ot.width,bufHeight:Xt,srcX:0,srcY:0}),at+=Xt,++Se%5===0&&(yield)}Dt+=ot.height}Ne.postMessage({message:"addExtras",metadata:JSON.stringify({links:Ao,words:Dc})}),Ne.postMessage({message:"finalize"})}Tc(`scripts/enc/fsWorker.js?ratio=${window.devicePixelRatio}`,Ne=>{switch(Ne.data.message){case"blitDone":{let Dt=Ne.data.totalHeight;G(Math.round(5+95*Dt/q)),++ye+Math.floor(5/2)>Se&&qt.next();break}case"completed":{ProgressBar.visible=!1,fe&&Sr("pdf"),Ne.data.result&&!Ne.data.result.size&&wt("UA-1025658-9","fireshot.com","PDF-Pro-Wrong-Size"),ee(Ne.data.result),We.postMessage({message:"terminate"});break}case"dumpBitmap":{ee(Ne.data.result);break}}}).then(Ne=>{fe&&Er("pdf"),We=Ne,qt=_n(We),qt.next()})})}function je(){switch(te()(`Performing automatic action: ${it}`),it){case H.t:l();break;case H.f:h();break}}function Oe(){try{Es()}catch(ee){Fn(ee.message)}let G=new URLSearchParams(window.location.search).get("params");G&&({action:it,folder:Co,context:Cc}=JSON.parse(atob(G))),we(H.T,parseInt(re(H.T,0))+1),qn=Ss(Xn,Jn,Ac),it?($("#divPreload").hide(),document.title=chrome.i18n.getMessage("label_processing"),je()):(Pc=Ye.length>1,i(),p(),he(),J(),V())}for(await bt.ensureLoaded();!Ye;)await xs(200);let be=new Date;be.setHours(24,0,0,0),be.setDate(be.getDate()-7)>ei&&!await Ri()?($("#divPreload").hide(),Q()):Oe()});function _p(e){let t=new URLSearchParams(window.location.search),i=parseInt(t.get("id"));_c.getCapture(i).then(o=>{o?.tiles?({url:Xn,title:Jn,cbb:Rc,metadata:{n:Ac,width:Yt,height:vn,links:Ao,words:Dc,debug:Qn}}=o,ei=new Date(o.time),e(o.tiles)):fe||window.close()})}Er("preload");_p(e=>{Rn("savedCapParamsForDebugging: "+JSON.stringify(Qn)),Ye=e,Sr("preload"),Ye&&(te()(`capHeight: ${vn}`),te()(`data preloaded successfully (${Ye.length} blobs)`))});})();
//# sourceMappingURL=fsCaptured.js.map

//# debugId=00fd3e4f-3b12-5703-b025-8eb70d3d9521
